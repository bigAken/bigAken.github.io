(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(s,t,a){s.exports=a("56d7")},"000c":function(s,t,a){},"0012":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-41-58.7684b24b.png"},"0500":function(s,t,a){s.exports=a.p+"img/c5b765119.309329cc.png"},"0529":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-06_09-55-42.16bb25eb.png"},"06d2":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("JavaScript 设计模式之发布订阅模式")]),r("h2",[s._v("定义")]),r("p",[s._v("发布-订阅模式其实是一种对象间一对多的依赖关系，当一个对象的状态发送改变时，所有依赖于它的对象都将得到状态改变的通知。 订阅者（Subscriber）把自己想订阅的事件注册（Subscribe）到调度中心（Event Channel），当发布者（Publisher）发布该事件（Publish Event）到调度中心，也就是该事件触发时，由调度中心统一调度（Fire Event）订阅者注册到调度中心的处理代码。")]),r("h3",[s._v("例子")]),r("p",[s._v("比如我们很喜欢看某个公众号号的文章，但是我们不知道什么时候发布新文章，要不定时的去翻阅；这时候，我们可以关注该公众号，当有文章推送时，会有消息及时通知我们文章更新了。 上面一个看似简单的操作，其实是一个典型的发布订阅模式，公众号属于发布者，用户属于订阅者；用户将订阅公众号的事件注册到调度中心，公众号作为发布者，当有新文章发布时，公众号发布该事件到调度中心，调度中心会及时发消息告知用户。")]),r("h2",[s._v("实现发布订阅模式的事件处理中心")]),r("h3",[s._v("实现思路")]),r("ul",[r("li",[s._v("创建一个 EventEmitter 类")]),r("li",[s._v("在该类上创建一个事件中心（Map）")]),r("li",[s._v("on 方法用来把函数 fn 都加到事件中心中（订阅者注册事件到调度中心）")]),r("li",[s._v("emit 方法取到 arguments 里第一个当做 event，根据 event 值去执行对应事件中心中的函数（发布者发布事件到调度中心，调度中心处理代码）")]),r("li",[s._v("off 方法可以根据 event 值取消订阅（取消订阅）")]),r("li",[s._v("once 方法只监听一次，调用完毕后删除缓存函数（订阅一次）")]),r("li",[s._v("注册一个 newListener 用于监听新的事件订阅")])]),r("h3",[s._v("第一步，创建一个类，并初始化一个事件存储中心")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 用来存放注册的事件与回调")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n}\n")])]),r("h3",[s._v("第二步，实现事件的订阅方法 on")]),r("p",[s._v("将事件回调函数存储到对应的事件上")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 用来存放注册的事件与回调")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 由于一个事件可能注册多个回调函数，所以使用数组来存储事件队列")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\t\tcallbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("(callback)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] = callbacks\n\t}\n}\n")])]),r("h3",[s._v("第三步，实现事件的发布方法 emit")]),r("p",[s._v("获取到事件对应的回调函数依次执行")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 用来存放注册的事件与回调")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// args 用于收集发布事件时传递的参数")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("emit")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, ...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\t\tcallbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("cb")]),s._v(" =>")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cb")]),s._v("(...args))\n\t}\n}\n")])]),r("h3",[s._v("第四步，实现事件的取消订阅方法 off")]),r("p",[s._v("找到事件对应的回调函数，删除对应的回调函数")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 用来存放注册的事件与回调")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("off")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" newCallbacks = callbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("filter")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fn")]),s._v(" =>")]),s._v(" fn != callback && fn."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initialCallback")]),s._v(" != callback "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* 用于once的取消订阅 */")]),s._v(")\n\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] = newCallbacks\n\t}\n}\n")])]),r("h3",[s._v("第五步，实现事件的单次订阅方法 once")]),r("p",[s._v("1.先注册 2.事件执行后取消订阅")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 用来存放注册的事件与回调")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("once")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 由于需要在回调函数执行后，取消订阅当前事件，所以需要对传入的回调函数做一层包装,然后绑定包装后的函数")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("one")]),s._v(" = ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") => {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 执行回调函数")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("callback")]),s._v("(...args)\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 取消订阅当前事件")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("off")]),s._v("(eventName, one)\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 考虑：如果当前事件在未执行，被用户取消订阅，能否取消？")]),s._v("\n\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 由于：我们订阅事件的时候，修改了原回调函数的引用，所以，用户触发 off 的时候不能找到对应的回调函数")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 所以，我们需要在当前函数与用户传入的回调函数做一个绑定，我们通过自定义属性来实现")]),s._v("\n\t\tone."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initialCallback")]),s._v(" = callback\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("(eventName, one)\n\t}\n}\n")])]),r("h3",[s._v("第六步，注册一个 newListener 用于监听新的事件订阅")]),r("p",[s._v("在用户注册的事件的时候，发布一下 newListener 事件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 用来存放注册的事件与回调")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 如果绑定的事件不是newListener 就触发改回调")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (eventName !== "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'newListener'")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("emit")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'newListener'")]),s._v(", eventName)\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 由于一个事件可能注册多个回调函数，所以使用数组来存储事件队列")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\t\tcallbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("(callback)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] = callbacks\n\t}\n}\n")])]),r("h3",[s._v("完整代码")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = {}\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("eventName")]),s._v(" !== "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'newListener'")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("emit")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'newListener'")]),s._v(", eventName)\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\t\tcallbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("(callback)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] = callbacks\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("emit")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, ...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\t\tcallbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("cb")]),s._v(" =>")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cb")]),s._v("(...args))\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("once")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("one")]),s._v(" = ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") => {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("callback")]),s._v("(...args)\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("off")]),s._v("(eventName, one)\n\t\t}\n\t\tone."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initialCallback")]),s._v(" = callback\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("(eventName, one)\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("off")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName, callback")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" callbacks = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] || []\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" newCallbacks = callbacks."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("filter")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fn")]),s._v(" =>")]),s._v(" fn != callback && fn."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initialCallback")]),s._v(" != callback "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* 用于once的取消订阅 */")]),s._v(")\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[eventName] = newCallbacks\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" events = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EventEmitter")]),s._v("()\n\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'newListener'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("eventName")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`eventName`")]),s._v(", eventName)\n})\n\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(")\n})\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cb = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'cb'")]),s._v(")\n}\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(", cb)\n\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("off")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(", cb)\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("once")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'once'")]),s._v(")\n}\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("once")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(", once)\n\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("off")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(", once)\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("emit")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(")\nevents."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("emit")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(")\n")])]),r("h2",[s._v("Vue 中的实现发布订阅者模式")]),r("p",[s._v("有了发布-订阅模式的知识后，我们来看下 Vue 中怎么实现 $on 和 $emit 的方法，直接看源码：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("eventsMixin")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("Vue")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" hookRE = "),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/^hook:/")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$on")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event, fn")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" this$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" vm = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// event 为数组时，循环执行 $on")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("isArray")]),s._v("(event)) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", l = event."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < l; i++) {\n\t\t\t\tthis$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1.")]),s._v("$on(event[i], fn)\n\t\t\t}\n\t\t} "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t;(vm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[event] || (vm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[event] = []))."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("(fn)\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// optimize hook:event cost by using a boolean flag marked at registration")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// instead of a hash lookup")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (hookRE."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("(event)) {\n\t\t\t\tvm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_hasHookEvent")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t\t\t}\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$once")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event, fn")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" vm = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 先绑定，后删除")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\tvm.$off(event, on)\n\t\t\tfn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(vm, "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t}\n\t\ton."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" = fn\n\t\tvm.$on(event, on)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$off")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event, fn")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" this$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" vm = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// all，若没有传参数，清空所有订阅")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v(") {\n\t\t\tvm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("create")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(")\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// array of events，events 为数组时，循环执行 $off")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("isArray")]),s._v("(event)) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", l = event."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < l; i++) {\n\t\t\t\tthis$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1.")]),s._v("$off(event[i], fn)\n\t\t\t}\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// specific event")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" cbs = vm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[event]\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!cbs) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 没有 cbs 直接 return this")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!fn) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 若没有 handler，清空 event 对应的缓存列表")]),s._v("\n\t\t\tvm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[event] = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (fn) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// specific handler，删除相应的 handler")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" cb\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" = cbs."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("while")]),s._v(" (i$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("--) {\n\t\t\t\tcb = cbs[i$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("]\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (cb === fn || cb."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fn")]),s._v(" === fn) {\n\t\t\t\t\tcbs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("splice")]),s._v("(i$"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("break")]),s._v("\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$emit")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("event")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" vm = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t{\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 传入的 event 区分大小写，若不一致，有提示")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" lowerCaseEvent = event."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toLowerCase")]),s._v("()\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (lowerCaseEvent !== event && vm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[lowerCaseEvent]) {\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("tip")]),s._v("(\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Event \"'")]),s._v(" +\n\t\t\t\t\t\tlowerCaseEvent +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'\" is emitted in component '")]),s._v(" +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("formatComponentName")]),s._v("(vm) +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' but the handler is registered for \"'")]),s._v(" +\n\t\t\t\t\t\tevent +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'\". '")]),s._v(" +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Note that HTML attributes are case-insensitive and you cannot use '")]),s._v(" +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'v-on to listen to camelCase events when using in-DOM templates. '")]),s._v(" +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'You should probably use \"'")]),s._v(" +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hyphenate")]),s._v("(event) +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'\" instead of \"'")]),s._v(" +\n\t\t\t\t\t\tevent +\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'\".'")]),s._v("\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" cbs = vm."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_events")]),s._v("[event]\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (cbs) {\n\t\t\tcbs = cbs."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v(" > "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" ? "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toArray")]),s._v("(cbs) : cbs\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 只取回调函数，不取 event")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" args = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toArray")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", l = cbs."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < l; i++) {\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n\t\t\t\t\tcbs[i]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(vm, args)\n\t\t\t\t} "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (e) {\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handleError")]),s._v("(e, vm, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'event handler for \"'")]),s._v(" + event + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'\"'")]),s._v(")\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vm\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/***\n * Convert an Array-like object to a real Array.\n */")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toArray")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("list, start")]),s._v(") {\n\tstart = start || "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = list."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v(" - start\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ret = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("(i)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("while")]),s._v(" (i--) {\n\t\tret[i] = list[i + start]\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ret\n}\n")])]),r("h2",[s._v("总结")]),r("h3",[s._v("优点")]),r("ul",[r("li",[s._v("对象之间解耦")]),r("li",[s._v("异步编程中，可以更松耦合的代码编写")])]),r("h3",[s._v("缺点")]),r("ul",[r("li",[s._v("创建订阅者本身要消耗一定的时间和内存")]),r("li",[s._v("虽然可以弱化对象之间的联系，多个发布者和订阅者嵌套一起的时候，程序难以跟踪维护")])]),r("h3",[s._v("扩展（发布-订阅模式与观察者模式的区别）")]),r("p",[s._v("很多地方都说发布-订阅模式是观察者模式的别名，但是他们真的一样吗？是不一样的。 "),r("img",{attrs:{src:a("72e3"),alt:""}})]),r("p",[s._v("观察者模式：观察者（Observer）直接订阅（Subscribe）主题（Subject），而当主题被激活的时候，会触发（Fire Event）观察者里的事件。")]),r("p",[s._v("发布订阅模式：订阅者（Subscriber）把自己想订阅的事件注册（Subscribe）到调度中心（Event Channel），当发布者（Publisher）发布该事件（Publish Event）到调度中心，也就是该事件触发时，由调度中心统一调度（Fire Event）订阅者注册到调度中心的处理代码。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"07b4":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("hosts 文件详解")]),a("h2",[s._v("什么是 hosts")]),a("p",[s._v("hosts —— the static table lookup for host name（主机名查询静态表）。")]),a("p",[s._v("hosts 文件是一个用于储存计算机网络中各节点信息的计算机文件。这个文件负责将主机名映射到相应的 IP 地址。hosts 文件通常用于补充或取代网络中 DNS 的功能。和 DNS 不同的是，计算机的用户可以直接对 hosts 文件进行控制。")]),a("p",[s._v("Hosts 是一个没有扩展名的系统文件，其作用就是将一些常用的网址域名与其对应的 IP 地址建立一个关联“数据库”，当用户在浏览器中输入一个需要登录的网址时，系统会首先自动从 Hosts 文件中寻找对应的 IP 地址，一旦找到，系统会立即打开对应网页，如果没有找到，则系统会再将网址提交 DNS 域名解析服务器进行 IP 地址的解析。")]),a("p",[s._v("优先级 ： dns 缓存 > hosts > dns 服务")]),a("h2",[s._v("hosts 的位置")]),a("p",[s._v("hosts 在各个系统中所在的文件夹：")]),a("ul",[a("li",[s._v("Windows 系统 hosts 位于 C:\\Windows\\System32\\drivers\\etc\\hosts")]),a("li",[s._v("Android（安卓）系统 hosts 位于 /etc/hosts")]),a("li",[s._v("Mac（苹果电脑）系统 hosts 位于 /etc/hosts")]),a("li",[s._v("iPhone（iOS）系统 hosts 位于 /etc/hosts")]),a("li",[s._v("Linux 系统 hosts 位于 /etc/hosts")]),a("li",[s._v("绝大多数 Unix 系统都是在 /etc/hosts")])]),a("h2",[s._v("hosts 的内容")]),a("p",[s._v("Windows 版本的 hosts 文件内容如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("# Copyright (c) 1993-2009 Microsoft Corp.\n# # This is a sample HOSTS file used by Microsoft TCP/IP for Windows.\n#\n # This file contains the mappings of IP addresses to host names. Each\n# entry should be kept on an individual line. The IP address should\n# be placed in the first column followed by the corresponding host name.\n# The IP address and the host name should be separated by at least one\n# space.\n#\n# Additionally, comments (such as these) may be inserted on individual\n# lines or following the machine name denoted by a '#' symbol.\n#\n# For example:\n#\n # 102.54.94.97 rhino.acme.com # source server\n # 38.25.63.10 x.acme.com # x client host\n# localhost name resolution is handled within DNS itself.\n # 127.0.0.1 localhost\n# ::1 localhost\n\n")])]),a("p",[s._v("#后都是注释，所以清空 hosts 文件对系统正常运行并没有什么影响。")]),a("p",[s._v("在一个局域网中，每台机器都有一个主机名，用于区分主机，便于相互访问。 一般/etc/hosts 的内容一般有如下类似内容： 127.0.0.1 localhost.localdomain localhost 192.168.1.100 linumu100.com linumu100 192.168.1.120 ftpserver ftp120")]),a("p",[s._v("一般情况下 hosts 文件的每行尾一个主机，每行由三部分组成，每个部分由空格隔开")]),a("p",[s._v("第一部分：网络 IP 地址； 第二部分：主机名或域名； 第三部分：主机名别名； 当然每行也可以是两部分，即主机 IP 地址和主机名。")]),a("p",[s._v("主机名（hostname)和域名（domain)的区别：主机名通常在局域网内使用，通过 hosts 文件，主机名就被解析到对应 IP;域名通常在 INTERNET 上使用，但如果本机不想使用 internet 上的域名解析，这时就可以更改 hosts 文件，加入自己的域名解析。")]),a("h2",[s._v("hosts 的作用")]),a("h3",[s._v("加快域名解析")]),a("p",[s._v("对于要经常访问的网站，我们可以通过在 Hosts 中配置域名和 IP 的映射关系，提高域名解析速度。由于有了映射关系，当我们输入域名计算机就能很快解析出 IP，而不用请求网络上的 DNS 服务器。")]),a("h3",[s._v("方便局域网用户")]),a("p",[s._v("在很多单位的局域网中，会有服务器提供给用户使用。但由于局域网中一般很少架设 DNS 服务器，访问这些服务器时，要输入难记的 IP 地址。这对不少人来说相当麻烦。可以分别给这些服务器取个容易记住的名字，然后在 Hosts 中建立 IP 映射，这样以后访问的时候，只要输入这个服务器的名字就行了。")]),a("h3",[s._v("屏蔽网站（域名重定向）")]),a("p",[s._v("有很多网站不经过用户同意就将各种各样的插件安装到你的计算机中，其中有些说不定就是木马或病毒。对于这些网站我们可以利用 Hosts 把该网站的域名映射到错误的 IP 或本地计算机的 IP，这样就不用访问了。")]),a("h3",[s._v("顺利连接系统")]),a("p",[s._v("对于 Lotus 的服务器和一些数据库服务器，在访问时如果直接输入 IP 地址那是不能访问的，只能输入服务器名才能访问。那么我们配置好 Hosts 文件，这样输入服务器名就能顺利连接了。")]),a("h3",[s._v("虚拟域名")]),a("p",[s._v("很多时候，网站建设者需要把”软环境“搭建好，再进行上传调试。但类似于邮件服务，则需要使用域名来辅助调试，这时就可以将本地 IP 地址与一个”虚拟域名“做地址指向，就可以达到要求的效果，且无需花费。如： "),a("strong",[s._v("127.0.0.1 网站域名")]),s._v(" 之后在浏览器地址栏中输入对应的网站域名即可。")]),a("h2",[s._v("如何修改 hosts")]),a("h3",[s._v("屏蔽网站（域名重定向）")]),a("p",[s._v("在 WINDOWS 系统中，约定 127.0.0.1 为本地计算机的 IP 地址, 0.0.0.0 是错误的 IP 地址。 如果，我们在 hosts 中，写入以下内容：")]),a("p",[s._v("127.0.0.1 要屏蔽的网站 A 的域名 0.0.0.0 要屏蔽的网站 B 的域名")]),a("p",[s._v("这样，计算机解析域名 A 和 B 时，就解析到本机 IP 或错误的 IP，达到了屏蔽网站 A 和 B 的目的。")]),a("p",[s._v("在修改 hosts 文件时候，还常常遇到修改保存后无效的情况，这里要提醒大家注意的一点：很多人是写在最后行，写完最后一行后在没有回车的情况下，这一行是不生效的。一定要记得回车。建议大家遵循这样的习惯：“ip 地址+Tab+域名+换行” 添加记录。")]),a("h3",[s._v("局域网用户访问")]),a("p",[s._v("如果，我们在 A 主机的 hosts 中，写入以下内容：")]),a("p",[a("strong",[s._v("B 主机的 ip")]),s._v(" "),a("strong",[s._v("B 主机名")])]),a("p",[s._v("这样我们就可以通过 B 主机名找到 B 主机及其服务。")]),a("h3",[s._v("通过修改 hosts 上 google")]),a("p",[s._v("第一步：下载可以正常使用的 hosts 文件 可以在百度搜索类似“Google hosts”等相关关键词或者老 D，找到最新可用的 host 文件。")]),a("p",[s._v("第二步：修改本地 hosts 文件 在电脑系统中找到 hosts，路径基本上是 C:\\Windows\\System32\\drivers\\etc，然后将下载的 hosts 文件将本地 hosts 文件替换，或者在本地 hosts 文件中直接在地址栏修改即可！")]),a("p",[s._v("第三步：刷新本地 dns")]),a("p",[s._v("第二步完成本地 hosts 文件的修改之后，可以使用 dos 命令完成最后的操作。")]),a("p",[s._v("（1）使用 WIN+R 键，启动运行，键入 cmd （2）在 dos 界面输入“ipcong /flushdns” （3）dos 命令窗提示“已成功刷新 DNS 解析缓存”，就完成了。")]),a("h2",[s._v("其他")]),a("h3",[s._v("怎么获取域名所对应的 IP 地址")]),a("p",[s._v("打开“开始――运行”，输入“cmd”，在命令行界面输入“ping www.baidu.com”，回车。显示结果类似：Reply from 220.181.6.18:bytes=32 time=24msTTL=55。其中的 220.181.6.18 就是域名所对应 IP 地址（百度的）。呵呵！")]),a("h3",[s._v("修改 hosts 后生效方法")]),a("h4",[s._v("Windows")]),a("p",[s._v("开始 -> 运行 -> 输入 cmd -> 在 CMD 窗口输入 ipconfig /flushdns")]),a("h4",[s._v("Linux")]),a("p",[s._v("打开终端 重启网络： sudo /etc/init.d/networking restart")]),a("p",[s._v("desktop 版可以这样重启： sudo service network-manager restart")]),a("p",[s._v("如果只是修改了某个网卡(例如 eth0)的信息，也可以通过重启网卡的方式使其修改生效。 sudo ifdown eth0 sudo ifup eth0")]),a("p",[s._v("如果不懂请都尝试下")]),a("h4",[s._v("Mac OS X 终端输入")]),a("p",[s._v("sudo killall -HUP mDNSResponder")]),a("h4",[s._v("Android")]),a("p",[s._v("开启飞行模式 -> 关闭飞行模式")]),a("h4",[s._v("通用方法")]),a("p",[s._v("拔网线(断网) -> 插网线(重新连接网络) 如不行请清空浏览器缓存（建议不要使用国产浏览器，请使用谷歌 Chrome 浏览器）")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"0b13":function(s,t,a){s.exports=a.p+"img/56b8cd2c5739.d4b863d3.png"},"0f9a":function(s,t,a){"use strict";a.r(t);var r={namespaced:!0,state:{random:""},mutations:{increment:function(s){s.random=parseInt(1e3*Math.random())}},getters:{doubleRadom:function(s){return 2*s.random}}};t["default"]=r},"107d":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h2",[s._v("利用 GitHub 持续集成")]),a("h3",[s._v("文档")]),a("p",[a("a",{attrs:{href:"https://docs.github.com/cn/actions/learn-github-actions"}},[s._v("官方文档")])]),a("p",[a("a",{attrs:{href:"https://docs.github.com/cn/actions/creating-actions/metadata-syntax-for-github-actions"}},[s._v("GitHub Actions 的元数据语法")])]),a("p",[a("a",{attrs:{href:"https://docs.github.com/cn/actions/guides/about-continuous-integration"}},[s._v("关于持续集成")])]),a("p",[a("a",{attrs:{href:"https://docs.github.com/cn/actions/learn-github-actions/workflow-syntax-for-github-actions"}},[s._v("GitHubAction")])]),a("p",[a("a",{attrs:{href:"https://docs.github.com/cn/actions/automating-builds-and-tests/building-and-testing-nodejs"}},[s._v("Node 使用 GitHubAction")])]),a("p",[a("a",{attrs:{href:"https://docs.github.com/cn/actions/creating-actions/creating-a-javascript-action"}},[s._v("Javascript 配置 GitHubAction")])]),a("blockquote",[a("p",[s._v("在根目录创建.github 文件夹然后在创建 workflows 文件夹然后在创建 action.yml 文件")])]),a("h3",[s._v("方法一 使用社区 vue 的 GitHub action")]),a("p",[a("a",{attrs:{href:"https://github.com/xRealNeon/VuePagesAction/blob/main/action.yml"}},[s._v("参考 action")]),a("a",{attrs:{href:"https://github.com/marketplace/actions/vue-to-github-pages"}},[s._v("Vue to Github Pages")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-yml"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("CI")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("on:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("push:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("branches:")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("master")]),s._v("]\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("pull_request:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("branches:")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("master")]),s._v("]\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jobs:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("build_vue:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("runs-on:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("ubuntu-latest")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Build")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Vue")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("steps:")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-bullet"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("uses:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("actions/checkout@v2")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-bullet"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Build-Vue")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("uses:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("xRealNeon/VuePagesAction@1.0.1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("with:")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("username:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bigAken'")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("reponame:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bigAken.github.io'")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("token:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("${{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("secrets.GITHUB_TOKEN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("}}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# Leave this line unchanged")]),s._v("\n")])]),a("h3",[s._v("方法二 个人自定义配置")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-yml"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("CI")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("on:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("push:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("branches:")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("master")]),s._v("]\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jobs:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("build_vue:")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("runs-on:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("ubuntu-latest")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Build")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Vue")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("steps:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-bullet"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("uses:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("actions/checkout@v2")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-bullet"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Build")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("Vue")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("run:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('|\n        npm ci; \n        npm run build; \n        cd dist\n        ln -s index.html 404.html\n        git config --global user.email "827094438@qq.com"\n        git config --global user.name "bigAken"\n        git init\n        git add -A\n        git commit -m \'发版\'\n        git push -f https://bigAken:${{ secrets.GITHUB_TOKEN }}@github.com/bigAken/bigAken.github.io.git master:gh-pages\n')]),s._v("      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("shell:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("bash")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("env:")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("CI:")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},1130:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("JavaScript 对象属性描述符")]),a("p",[s._v("参考"),a("a",{attrs:{href:"http://c.biancheng.net/view/5775.html"}},[s._v("JS 对象属性描述符详解")]),s._v(" 参考"),a("a",{attrs:{href:"https://www.cnblogs.com/shiningly/p/9482283.html"}},[s._v("深入理解对象的数据属性与访问器属性")]),s._v(" 在 JavaScript 中，对象的属性也可以用一些关键字来修饰，用以表示当前属性是否可写、是否有默认值、是否可枚举等，这些关键字就是属性描述符。属性描述符是 ECMAScript 5 新增的语法，它其实就是一个内部对象，用来描述对象的属性的特性。")]),a("h2",[s._v("操作属性描述符")]),a("ul",[a("li",[a("code",{pre:!0},[s._v("Object.getOwnPropertyDescriptor()")]),s._v("：可以读出指定对象私有属性的属性描述符。")]),a("li",[a("code",{pre:!0},[s._v("Object.defineProperty()")]),s._v("：通过定义属性描述符来定义或修改一个属性，然后返回修改后的描述符。")]),a("li",[a("code",{pre:!0},[s._v("Object.defineProperties()")]),s._v("：可以同时定义多个属性描述符。")]),a("li",[a("code",{pre:!0},[s._v("Object.getOwnPropertyNames()")]),s._v("：获取对象的所有私有属性。")]),a("li",[a("code",{pre:!0},[s._v("Object.keys()")]),s._v("：获取对象的所有本地可枚举的属性。")]),a("li",[a("code",{pre:!0},[s._v("propertyIsEnumerable()")]),s._v("：对象实例方法，直接调用，判断指定的属性是否可枚举。*")])]),a("h2",[s._v("属性描述符的结构")]),a("p",[s._v("属性描述符一共有 6 个:")]),a("ul",[a("li",[s._v("value：设置属性值，默认值为 undefined")]),a("li",[s._v("writable：设置属性值是否可写，默认值为 true")]),a("li",[s._v("enumerable：设置属性是否可枚举，即是否允许使用 for/in 语句或 Object.keys() 函数遍历访问，默认为 true")]),a("li",[s._v("configurable：设置是否可设置属性特性，默认为 true。如果为 false，将无法删除该属性，不能够修改属性值，也不能修改属性的属性描述符")]),a("li",[s._v("get：取值函数，默认为 undefined")]),a("li",[s._v("set：存值函数，默认为 undefined")])]),a("h2",[s._v("数据属性")]),a("p",[s._v("数据属性包含下面四个属性描述符：")]),a("ul",[a("li",[s._v("Configurable: 表示能否通过 delete 删除属性从而重新定义属性，能否修改属性特性，能否把属性修改为访问器属性。通过以上方式添加的对象属性，默认为 true")]),a("li",[s._v("Enumerable: 表示能否通过 for-in 循环访问属性。通过以上方式添加的对象属性，默认为 true")]),a("li",[s._v("Writable: 表示能否修改属性的值。通过以上方式添加的对象属性，默认为 true")]),a("li",[s._v("Value: 包含这个属性的数据值，可读取写入。通过以上方式添加的对象属性，默认为 undefined")])]),a("h2",[s._v("访问器属性")]),a("p",[s._v("访问器属性包含四个属性描述符：")]),a("ul",[a("li",[s._v("Configurable : 表示能否通过 delete 删除属性从而重新定义属性，能否修改属性特性，能否把属性修改为数据属性。直接在对象上定义的属性，默认为 true")]),a("li",[s._v("Enumerable : 表示能否通过 for-in 循环访问属性。直接在对象上定义的属性，默认为 true")]),a("li",[s._v("Get : 读取属性时调用的函数，默认为 undefined")]),a("li",[s._v("Set : 写入属性时调用的函数，默认为 undefined")])]),a("blockquote",[a("p",[s._v("注：在访问器属性的 get 和 set 中，不可以使用 this 访问属性本身，否则会无限递归而导致内存泄漏 注意；定义属性时访问器属性和数据属性只能存在一个，否则会报错，但是两者可以相互转化 Vue 底层是使用该特性")])]),a("h2",[s._v("数据属性与访问器属性的相互转换")]),a("h3",[s._v("数据属性 -> 访问器属性")]),a("p",[s._v("属性的特性只能是访问器描述符和数据描述符中的一种，给已有的数据属性加 get 或 set 转换为访问器属性时，其属性的 value、writable 就会被废弃。")]),a("h3",[s._v("访问器属性 -> 数据属性")]),a("p",[s._v("将访问器属性转换为数据属性，只需要给现有访问器属性设置 value 或 writable 这两个属性描述符中的任意一个即可，其原有的 get 和 set 就会被废弃，从而转换为数据属性")]),a("h2",[s._v("控制对象状态")]),a("p",[s._v("JavaScript 提供了 3 种方法，用来精确控制一个对象的读写状态，防止对象被改变")]),a("ul",[a("li",[s._v("Object.preventExtensions：阻止为对象添加新的属性。")]),a("li",[s._v("Object.seal：阻止为对象添加新的属性，同时也无法删除旧属性。等价于属性描述符的 configurable 属性设为 false。注意，该方法不影响修改某个属性的值。")]),a("li",[s._v("Object.freeze：阻止为一个对象添加新属性、删除旧属性、修改属性值。")])]),a("p",[s._v("同时提供了 3 个对应的辅助检查函数")]),a("ul",[a("li",[s._v("Object.isExtensible；检查一个对象是否允许添加新的属性。")]),a("li",[s._v("Object.isSealed：检查一个对象是否使用了 Object.seal 方法。")]),a("li",[s._v("Object.isFrozen：检查一个对象是否使用了 Object.freeze 方法。")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"13db":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-16_22-23-14.670de643.png"},"147e":function(s,t,a){s.exports=a.p+"img/16531214dde78290.28a80897.webp"},"14f4":function(s,t,a){s.exports=a.p+"img/c28a44.b856844c.png"},1531:function(s,t,a){"use strict";a.r(t),t["default"]=[]},"18ac":function(s,t){s.exports="data:image/webp;base64,UklGRrQHAABXRUJQVlA4IKgHAACQKQCdASq4AHEAPpFGnkslo6KhpbHpULASCWVu4XSg67IcKXHB59B0+gD/2+n/6cvQBzw3oU/yvSr/6b2AP5l/k/YA/TP1q/U7/0npi+gB///UA6k/pB/Jezr+2+Fvij8gP8vMb6K/ofJzvB9+WoF61/z/mV+if4DtCsV/vH+q9QL19+ldyV/UegH1X9EH81/33o5/UPAG8R/Tn4APy5/zv717pP8R/5/9L5uPoj9kvgH/m39w6vH7q+y0P4VINKKII9o7Dju8896fLiqYi5CbLpHzaDu2cB8UlsP4zLMDNNa0km61X70hRNSHKKkHIQ38WL1hIIHpTIK5tVTqQTAePVg3uClMr0HfXiEOcWJymxCW1ZfM3GJLbr7GptBcLC+5wn2IisY+jkPq8ncqwvE0licqyRyAbtMwwg88cEfD5242d5wFVkyRJMgDT5GLOoXNCd3cwAD+/yslOV122Y3vtPY+k7iWBpa5cZVTTwQ/n92R4wVOgovu4HfBU5nvlc0dcvBx1+GcTsUPq3XxW1mnkWLlB9qdAa7O662FLXNGQ+Drk99GZbDu8l6uuJpOa035aheafb8u10EgEPIk3p3lXd0ujv0wnkiujras1mBO0Em0ILAOjWj45HwmblEsC86IPZ+FdvjF53HTkg8vK8N5RefIqqSbiqw1k4dVniIqnSx3YpuhtPtQb3Qcb26HSRb4x7VVpwzqm7Ylvwfp7FE0QKAVuYH9z7k6Due3yKek1fPj6WI8ePetkv4Yl/1gkQOha76dzQa1MEiP6tTtwu5GBjDQJ5R2kEal1YhFUOsvYekbd/SsE96hqqe6SKAQsUt0IHOHBxMR639zyRInfcYxnohI+wtNHamWSQowiymY5ygXvB24xsPkInvIQAjxgFWaalbENanBGhq9JOiOD0u5O6B60Mq3B8t43jUbyr4rKRElbUgvj3gEDSu1o5UPnZFkjwqR2jz26PAC6HjlYJvLnVtYyAhir4cRcSRbOAlDtmfKRx4fEALAgcQ+6+c6OEdSq9ZE/iQmCWfpDhlmjR4Tgu2HOcuiSMG7acGgCvdIloo0IYHbSaB29wXuucfHyA3HVw2xprQBBq7gRkhwyV4m4B+me8RvDJzeSfVHZG85P0ZbjDo1zDBePRzEukDSw6bQm41anqvxDQajtk6OOACUvEK9l2TXHMG0hTzC+jCSaVCiUoAPF0CkQ/B0oDbwoXODQLa/ohkq4iBSUAipTBhaRBUdAmOzjUJXJm0wLsGjTNmHG/UvGeZmYGEEG5MtHXETq2/XeQkiMnSWc0Dm73zXqZ74i0KyUeeCX303IZd4yGMa2pJ9CqBzwTGm0X0mB4iFMO4yDKEJkt7EL8ChMzZvi9zKWOhTRaDJVYk+FTMaxXWGJNJpY5PI5m5WF/fyCCCAQxiJ4o0GxQBSIwdIng6PkbG9mUApXhs7URwT0LR+PbPNjJDQTIpTjlWj3G9P7hPp+i/ivV4jWPjpkVX//5lq0oKemW1klAnLMxMvMC29bRnyvEDi2FtNOrZRx2Sm2PqfOBXirp/0OO5GumUaS6k4ulZlf5zaVt9R/yvQ2fFJEIGCFEx6/nJZ3cbYjMITnM5YKwPCo6EtnsBgltblrUs43nbvLWzok8kcHxwmER9FwjJ4fJdX4tW3uuAE/QWU79nRYYgpmK8ciYW6cYRcl5VnAiqCH3oZhMT7sfGKLWjGZOvIieEPyC5MtvVMugXKwXkhvsESYrdzI8D+5xme8WMCuOngQ2peF6JGnFWvvdaF0ZpCnfOtwBAzlON4EUXjMdhfZIindEM97WDjlAzUr0cgddQp5gjb9hRO2iklNwQsyETK4O60HYW66zNn179fLnzuEqMdS5gjoIlZoysaPzSkyew8NBSE4aiaqBZFed9Nv4TaHD5haVA+H4jLq7VSiyzJvVYcOmkw+M4LthztTekbdljz4MAexCt6Cx1QnExcKzwUxxL2l4vTKvCC8md6U6k5CLtqqgQwqxiap2NyPJHxrrjOwCWqjm5556RekDhUgF5qo5DGX3Ss8oaxsjcRoR/yLxXbgy21bK6QJzMg0gT/9g8wIbQF7lMmXv7GU7hsSfJUONpzEgb0/AoQRccG3xHqAk8R44PN762fTv8x1SYxL9OIXDeTHu+fEar3E2c+oqwxPadZ5I8YK/KfN6E7hPIJTT1GCLt/QMl8YDwP4LISZfiEfIlujR03ACef7Vx3nWbX65FqHmyfdpGITkXwZBpL+cXh20ifukW+/C16TW4Yef11PDhp29o+yXzxxUJutUPx3641rHVGbmXoLdkoaOo+jgESlGuicauJNrx9gROYCXB2qHEyG3F8NdkJMLdOHauN/An8XmDzBByqPx/SSx/vXZdCPEr+6DI3hjp929X+FmBNs5Cr4nB7kw48mfflD/inwabp1dM8/KLLqhkKDAATpHNydvRd2FYHFQwHMGsEjzklXtZ7wv50uHpsP0i/yhiVNm3zPNDPR/AE149+6aafHnb5auqM+RFeVCrDQ13ZnC9MWhjOu3pH2XvyN9uqE9qyKwBekfcD/b0+yExQr9meaU/WNpA3EtZm4nT48DZgTspNiFnJPm2TS5cSK4nIWm+lPu8IAAAA"},"192b":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("Javascript 面向对象七大原则")]),a("p",[s._v("七大原则： 1：单一责任原则：一个类只对一个功能负责")]),a("p",[s._v("2：里氏代换原则(LSP)： 子类型必须能够替换掉它们的父类型。")]),a("p",[s._v("3：开闭原则：对扩展开放，对修改封闭。")]),a("p",[s._v("4：接口隔离原则：客户端不应该依赖它不需要的接口，一个类对另一个类的依赖应该建立在最小的接口上")]),a("p",[s._v("5：依赖倒转原则：高层模块不应该依赖低层模块，二者都应该依赖其抽象；")]),a("p",[s._v("6：迪米特原则：最少知道原则")]),a("p",[s._v("7: 组合聚合复用原则:在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。")]),a("h2",[s._v("单一责任原则")]),a("p",[s._v("含义：对于一个类，只有一个引起该类变化的原因；该类的职责是唯一的，所谓职责是指类变化的原因。如果一个类有多于一个的动机被改变，那么这个类就具有多于一个的职责。而单一职责原则就是指一个类或者模块应该有且只有一个改变的原因。（来自百度百科）")]),a("p",[s._v("通俗一点来说，一个类应该只做一类事情；一个类应该只负责一个功能。")]),a("p",[s._v("目的：降低代码复杂度、系统解耦合、提高可读性")]),a("p",[s._v("举个例子：")]),a("p",[s._v("单一原则就记住一句话就好了，就是'一个类只对一个功能负责'。比如说现在有拍照和播放音乐两个功能要实现。错误的做法就是把这两个功能都封装到一个类里面，正确的做法是，封装两个类，一个实现拍照功能，一个实现播放音乐的功能。")]),a("p",[s._v("代码如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义拍照类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Photograph")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("photograph")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`给"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("拍照`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义播放音乐类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("PlayMusic")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("musicName")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("musicName")]),s._v(" = musicName\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outMusicName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`播放音乐"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".musicName}")]),s._v("`")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" photograph1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Photograph")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" playMusic1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("PlayMusic")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'爱我中华'")]),s._v(")\nphotograph1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("photograph")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 给小明拍照")]),s._v("\nplayMusic1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outMusicName")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 播放音乐爱我中华")]),s._v("\n")])]),a("h2",[s._v("开闭原则")]),a("p",[s._v("含义：在面向对象编程领域中，开闭原则规定“软件中的对象（类，模块，函数等等）应该对于扩展是开放的，但是对于修改是封闭的”，这意味着一个实体是允许在不改变它的源代码的前提下变更它的行为。（来自百度百科）")]),a("p",[s._v("解释：白话意思就是我们改变一个软件时（比如扩展其他功能），应该通过扩展的方式来达到软件的改变，而不应该修改原有代码来实现变化。坚持开闭原则有利于用最少的代码进行项目维护。我觉得开闭原则就是对多态的一种体现。（个人理解，不对可喷。）")]),a("p",[s._v("举个栗子：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义大鱼类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("BigFish")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("eat")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是大鱼我吃小鱼`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义小鱼类继承大鱼类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SmallFish")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("BigFish")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 重写吃方法，小鱼类只能吃虾米")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("eat")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是小鱼我吃虾米`")]),s._v(")\n\t}\n}\n")])]),a("h2",[s._v("里氏代换原则(LSP)")]),a("p",[s._v("定义：里氏代换原则(Liskov Substitution Principle LSP)面向对象设计的基本原则之一。 里氏代换原则中说，任何基类(父类)可以出现的地方，子类一定可以出现。 LSP 是继承复用的基石，只有当衍生类可以替换掉基类（父类），软件单位的功能不受到影响时，基类（父类）才能真正被复用，而衍生类也能够在基类的基础上增加新的行为。里氏代换原则是对“开-闭”原则的补充。（来自百度百科） 这个原则就是说你实例化了一个父类的实例，通过这个实例实现了一个功能，要保证这个功能，通过继承过这个父类的子类所实例化的实例，同样能实现这个功能。")]),a("p",[s._v("举个例子：")]),a("p",[s._v("已经定义鸟类具有一个飞的方法，现在通过鸟类实例化了一个小鸟 1 实例，调用飞方法，实现了让小鸟 1 飞（这是一个功能）。")]),a("p",[s._v("定义一个鸵鸟类，和一个老鹰类都继承自鸟类。这样的写法就违反了我们的里氏替换原则。因为此时你通过鸵鸟类来例化一个鸵鸟 1 的实例，是不能用鸵鸟 1 实例去替换掉，上面通过鸟类实例化的小鸟 1 实例的，因为鸵鸟 1 实例并没有办法实现飞的功能，这就违背了里氏替换功能。")]),a("p",[s._v("正确的做法是，应该创建并列的两种鸟的父类，会飞与不会飞的，会飞的鸟类继承会飞的鸟的父类，不会飞的鸟类继承不会飞的鸟的父类。 通过例子我们可以看出，老鹰 1 和老鹰 2 并不是通过一个类实例出来的，而是通过一个父类实例化和一个子类实例化出来的，但是都可以实现飞的功能，这个就是里氏替换原则。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义会飞的鸟类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("CanFly")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("canFly")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v(" I can fly`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义不会飞的鸟类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("NotCanFly")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("notCanFly")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v(" I not can fly`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义老鹰类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("LaoYing")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("CanFly")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, color")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("color")]),s._v(" = color\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("color")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("color")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义鸵鸟类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("TuoNiao")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("NotCanFly")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name, color")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("color")]),s._v(" = color\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("color")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("color")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" laoYing1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("LaoYing")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'老鹰一'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'白色'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 通过LaoYing类实例化老鹰1实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" laoYing2 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("CanFly")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'老鹰二'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 通过会飞的鸟类实例化老鹰2实例")]),s._v("\n\nlaoYing1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("canFly")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 我是老鹰一 I can fly")]),s._v("\nlaoYing2."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("canFly")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 我是老鹰二 I can fly")]),s._v("\n")])]),a("h2",[s._v("接口隔离原则")]),a("p",[s._v("含义：客户端不应该依赖它不需要的接口，一个类对另一个类的依赖应该建立在最小的接口上。（来自百度百科）")]),a("p",[s._v("举个栗子：")]),a("p",[s._v("现在有一个考试类，上面有考试接口，分别是考语数外、理化生、政史地等接口。现在有文科学生类和理科学生类分别继承考试类，实现考试类的接口进行考试。这里就有些违反接口隔离原则了，因为文科学生并不需要考物理化，理科学生也并不需要考政史地。")]),a("p",[s._v("解决：")]),a("p",[s._v("对考试接口进行细化，文科考试接口和理科考试接口；文科生、理科生另外各自实现文科考试接口、理科考试接口。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 文科考试接口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ArtsExam")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("exam")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("我要参加考语数外历史地理政治`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 理科考试接口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ScienceExam")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("exam")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("我要参加考语数外物理化学生物`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 文科学生")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Arts")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("ArtsExam")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 理科学生")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Science")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("ScienceExam")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t}\n}\n\nstudent1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Arts")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'文科生小红'")]),s._v(")\nstudent1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("exam")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 我是文科生小红我要参加考语数外历史地理政治")]),s._v("\n\nstudent2 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Science")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'理科生小明'")]),s._v(")\nstudent2."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("exam")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 我是理科生小明我要参加考语数外物理化学生物")]),s._v("\n")])]),a("h2",[s._v("依赖倒转原则")]),a("p",[s._v("含义：依赖倒置原则（Dependence Inversion Principle）是程序要依赖于抽象接口，不要依赖于具体实现。简单的说就是要求对抽象进行编程，不要对实现进行编程，这样就降低了客户与实现模块间的耦合。（来自百度百科） 关键：")]),a("p",[s._v("高层模块不应该依赖低层模块，两者都应该依赖其抽象 抽象不应该依赖细节 细节应该依赖抽象 目的：避免需求变化导致过多的维护工作")]),a("p",[s._v("解释：简单来说就是程序要依赖于抽象接口，不要依赖于具体实现。要求对抽象进行编程，不要对实现进行编程。")]),a("p",[s._v("举个栗子： 现有一个人类，人类有一个读书的接口，因为是读书，所以要定义一个 Person 的类和要定义一个读书类。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Book")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("content")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("content")]),s._v(" = content\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutContent")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`书的内容是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".content}")]),s._v("`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 人类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("People")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 读抽象方法的具体实现")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reader")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("what")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("读的`")]),s._v(", what."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutContent")]),s._v("())\n\t}\n}\n")])]),a("p",[s._v("这就违反了依赖倒置原则，因为你此时人类是高层模块，书是低层模块，高层模块人类依赖了低层模块书类。因为写死了读书类，此时如果要让人类去读报纸，原有的读书方法很难做到。应该把阅读类抽出来，交由子类（书类 报纸类）去实现")]),a("p",[s._v("解决：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 阅读类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reader")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("content")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("content")]),s._v(" = content\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取内容的抽象方法")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutContent")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Abstract methods require concrete implementation'")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 书类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Book")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("Reader")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("content")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(content)\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取内容的抽象方法的实现")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutContent")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`书的内容是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".content}")]),s._v("`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 报纸类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("NewsPaper")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("Reader")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("content")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(content)\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取内容的抽象方法的实现")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutContent")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`报纸的内容是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".content}")]),s._v("`")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 人类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("People")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 读抽象方法的具体实现")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reader")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("what")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("读的`")]),s._v(", what."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutContent")]),s._v("())\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" xiaoMing = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("People")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" xiaoHong = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("People")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小红'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" anTuSheng = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Book")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'安徒生故事'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" wanBao = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("NewsPaper")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'今日晚报'")]),s._v(")\n\nxiaoMing."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reader")]),s._v("(anTuSheng) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 书的内容是安徒生故事 小明读的")]),s._v("\nxiaoMing."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reader")]),s._v("(wanBao) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 报纸的内容是今日晚报 小明读的")]),s._v("\n\nxiaoHong."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reader")]),s._v("(anTuSheng) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 书的内容是安徒生故事 小红读的")]),s._v("\nxiaoHong."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reader")]),s._v("(wanBao) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 报纸的内容是今日晚报 小红读的")]),s._v("\n")])]),a("h2",[s._v("迪米特原则")]),a("p",[s._v("含义：迪米特法则（Law of Demeter）又叫作最少知识原则（Least Knowledge Principle 简写 LKP），就是说一个对象应当对其他对象有尽可能少的了解,不和陌生人说话。英文简写为: LoD.（来自百度百科）")]),a("p",[s._v("迪米特法则的做法观念就是类间解耦，弱耦合。如果类与类之间的耦合度太高，当一个类发生改变时，和他有关系的类也会发生变化。这样很不利于扩展和维护，当我们后期加需求或者改需求的时候，代码很难进行编写。")]),a("p",[s._v("举个栗子： 现在又一个客人的类，客人点了一道西红柿炒鸡蛋。这个西红柿炒鸡蛋需要厨师类去做。比如厨师类要切西红柿，打鸡蛋，炒，放盐好几个方法完成这道菜，然后把菜给客人。迪米特原则在这里的体现就是，客人点了菜，然后初厨师给客人菜，期间厨师咋做的这道菜客人完全不需要知道。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 客人类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Guest")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 点菜方法")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("orderDishes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("val")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(val."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutDishes")]),s._v("())\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 厨师类")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Chef")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 切西红柿")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cutTomatoes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'切西红柿'")]),s._v(")\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 打鸡蛋")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hitEgg")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'打鸡蛋'")]),s._v(")\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 放盐")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("putSalt")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'放盐'")]),s._v(")\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 给客人菜方法")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("outPutDishes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cutTomatoes")]),s._v("()\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hitEgg")]),s._v("()\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("putSalt")]),s._v("()\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("()\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'西红柿炒鸡蛋'")]),s._v("\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" xiaoMing = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Guest")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" chef1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Chef")]),s._v("()\nxiaoMing."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("orderDishes")]),s._v("(chef1)\n")])]),a("h2",[s._v("组合聚合复用原则")]),a("p",[s._v("聚合（Aggregation）表示一种弱的‘拥有’关系，是整体和个体之间的关系,即 has-a 的关系，此时整体与部分之间是可分离的，他们可以具有各自的生命周期。")]),a("p",[s._v("合成（Composition）则是一种强的'拥有'关系，他体现的是一种 contains-a 的关系，这种关系比聚合更强，也称为强聚合。体现了严格的部分和整体关系，部分和整体的生命周期一样。")]),a("p",[s._v("组合聚合复用原则又叫合成复用原则，就是在一个新的对象里通过关联关系（组合关系、聚合关系）来使用一些已有的对象，使之成为新对象的一部分；新对象通过委派调用已有对象的方法达到复用功能的目的。简而言之，尽量使用 组合/聚合 的方式，而不是使用继承。")]),a("p",[s._v("来源"),a("a",{attrs:{href:"https://www.cnblogs.com/zhengyufeng/p/11058046.html"}},[s._v("js 面向对象七大原则")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"1ef9":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_15-46-37.e2a668a5.png"},"22d4":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_22-02-46.33128f6c.png"},"234e":function(s,t,a){"use strict";a.r(t);var r={product:{hello:"hello中文"}};t["default"]=r},2534:function(s,t,a){},2667:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("事件冒泡、事件捕获、事件委托、事件绑定")]),r("h2",[s._v("DOM 事件流")]),r("p",[s._v("事件流描述的是从页面中接收事件的顺序")]),r("p",[r("strong",[s._v("事件发生时会在元素节点之间按照特定的顺序传播，这个传播过程即 DOM 事件流")])]),r("p",[s._v("包括三个阶段："),r("code",{pre:!0},[s._v("事件捕获阶段")]),s._v("、"),r("code",{pre:!0},[s._v("处于目标阶段")]),s._v("、"),r("code",{pre:!0},[s._v("事件冒泡阶段")])]),r("p",[r("img",{attrs:{src:a("5d19"),alt:"事件阶段"}})]),r("p",[s._v("在 dom 模型中，html 是多层次的，当一个 html 元素上产生事件时，该事件会在 dom 树元素节点之间按照特定的顺序去传播。传播路径的每一个节点，都会收到这个事件，这就是 dom 事件流。")]),r("p",[r("code",{pre:!0},[s._v("事件捕获")]),s._v("：事件从最不精确的对象(document 对象)开始触发，直到事件目标。")]),r("p",[r("code",{pre:!0},[s._v("事件目标")]),s._v("：当到达目标元素之后，执行目标元素该事件相应的处理函数。如果没有绑定监听函数，那就不执行。")]),r("p",[r("code",{pre:!0},[s._v("事件冒泡")]),s._v("：事件从事件目标到最不特定的事件目标(document 对象)的顺序触发。")]),r("h3",[s._v("注意：")]),r("ul",[r("li",[s._v("代码只能执行捕获或者冒泡其中的一个阶段")]),r("li",[r("code",{pre:!0},[s._v("onclick")]),s._v(" 和 "),r("code",{pre:!0},[s._v("attachEvent")]),s._v(" 只能得到冒泡阶段")]),r("li",[r("code",{pre:!0},[s._v("addEventListener (type, listener[, useCapture])")]),s._v(" 第三个参数如果是 "),r("code",{pre:!0},[s._v("true")]),s._v("，表示在事件捕获阶段调用事件处理程序；如果是 "),r("code",{pre:!0},[s._v("false")]),s._v("（不写默认就是 "),r("code",{pre:!0},[s._v("false")]),s._v("），表示在事件冒泡阶段处理程序。")]),r("li",[s._v("在实际开发中，我们很少使用事件捕获(低版本 ie 不兼容)，我们更关注事件冒泡")]),r("li",[s._v("有些事件是没有冒泡的，比如 "),r("code",{pre:!0},[s._v("onblur")]),s._v("、"),r("code",{pre:!0},[s._v("onfocus")]),s._v("、"),r("code",{pre:!0},[s._v("onmouseover")]),s._v("、"),r("code",{pre:!0},[s._v("onmouseleave")])]),r("li",[s._v("虽然事件冒泡有时候会带来麻烦，但是有时候又会巧妙的做某些事情，我们后面讲解")])]),r("h2",[s._v("事件对象")]),r("ul",[r("li",[s._v("event 就是一个事件对象，写道我们的侦听函数的小括号里面，当形参来看")]),r("li",[s._v("事件对象只有有了事件才会存在，他是系统给我们自动创建的，不需要我们传递参数")]),r("li",[s._v("事件对象是我们的事件的一系列相关数据的集合，比如鼠标点击里面就包含了鼠标的相关信息")]),r("li",[s._v("这个事件对象我们可以自己命名，比如 event、evt 、e 等")]),r("li",[s._v("事件对象也有兼容性问题。 IE 6、7、8 通过 window.event 实现")])]),r("p",[s._v("兼容性写法：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" event = event || windoe."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("event")]),s._v("\n")])]),r("h3",[s._v("事件对象常见额属性和方法")]),r("table",[r("thead",[r("tr",[r("th",[s._v("事件对象属性方法")]),r("th",[s._v("说明")])])]),r("tbody",[r("tr",[r("td",[r("code",{pre:!0},[s._v("e.target")])]),r("td",[s._v("返回触发事件的对象 标准")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("e.scrElement")])]),r("td",[s._v("返回触发事件的对象 非标准 IE 6 7 8 使用")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("e.type")])]),r("td",[s._v("返回事件的类型，比如 "),r("code",{pre:!0},[s._v("click")]),s._v("、"),r("code",{pre:!0},[s._v("mouseover")]),s._v(" 等，不带 on")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("e.cancelBubble")])]),r("td",[s._v("该属性阻止冒泡，非标准，IE 6 7 8 使用")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("e.returnValue")])]),r("td",[s._v("该属性阻止默认事件（默认行为）非标准 ，IE 6 7 8 使用，比如不让链接跳转")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("e.preventDefaule()")])]),r("td",[s._v("该方法阻止默认事件（默认行为）标准 ，比如不让链接跳转")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("e.stopPropagation()")])]),r("td",[s._v("阻止冒泡，标准")])])])]),r("h3",[s._v("e.target 和 this 的区别")]),r("p",[s._v("this 返回的是绑定事件的对象（元素） e.target 返回的是点击的那个对象，就是谁触发了这个事件,如点击事件->谁被点了")]),r("h3",[s._v("阻止对象默认行为")]),r("ul",[r("li",[r("code",{pre:!0},[s._v("e.preventDefaule()")]),s._v("; 是一个方法，适合普通浏览器")]),r("li",[r("code",{pre:!0},[s._v("e.returnValue")]),s._v("; 是一个属性，适用于 IE 6 7 8")]),r("li",[r("code",{pre:!0},[s._v("return false")]),s._v("; 没有兼容性问题，但是需要注意后面的语句就不执行了，直接跳出")])]),r("h3",[s._v("阻止冒泡")]),r("ul",[r("li",[r("code",{pre:!0},[s._v("event.stopPropagation()")]),s._v("; // 一般浏览器停止冒泡")]),r("li",[r("code",{pre:!0},[s._v("event.cancelBubble")]),s._v("; // IE 6 7 8 的停止冒泡")])]),r("h2",[s._v("事件委托（事件代理）")]),r("p",[s._v("事件委托的原理：不给每个子节点单独设置事件监听器，而是在其父节点上设置事件监听，利用的是冒泡原理，通过事件对象中"),r("code",{pre:!0},[s._v("e.target")]),s._v("事件目标进行操作。")]),r("p",[s._v("优点：只操作了一次 DOM ，提高了程序的性能")]),r("p",[s._v("例如：鼠标放到 li 上，对应的 li 背景颜色变为灰色")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("111"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("222"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("333"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("444"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("li")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("ul")]),s._v(">")]),s._v("\n")])]),r("p",[r("strong",[s._v("普通实现")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 给每个 li 都绑定一个事件让其变灰")]),s._v("\n$("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'li'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mouseover'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t$("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("css")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'background-color'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'gray'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("siblings")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("css")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'background-color'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'white'")]),s._v(")\n})\n")])]),r("p",[s._v("上面这种普通实现看似没有什么问题，但是如果在这段代码结束以后，我们动态的给 "),r("code",{pre:!0},[s._v("ul")]),s._v(" 又增加了一个 "),r("code",{pre:!0},[s._v("li")]),s._v("，那么新增的这个 "),r("code",{pre:!0},[s._v("li")]),s._v(" 是不带有事件的，如果有无数个 "),r("code",{pre:!0},[s._v("li")]),s._v(" 结点，"),r("code",{pre:!0},[s._v("dom")]),s._v(" 是吃不消的。")]),r("p",[r("strong",[s._v("事件委托实现")])]),r("p",[s._v("js 中事件是会冒泡的，所以"),r("code",{pre:!0},[s._v("this")]),s._v("是可以变化的，但"),r("code",{pre:!0},[s._v("event.target")]),s._v("不会变化，它永远是直接接受事件的目标"),r("code",{pre:!0},[s._v("DOM")]),s._v("元素 利用事件冒泡 只指定 "),r("code",{pre:!0},[s._v("ul")]),s._v(" 的事件处理 就可以控制 "),r("code",{pre:!0},[s._v("ul")]),s._v(" 下的所有的 "),r("code",{pre:!0},[s._v("li")]),s._v(" 的事件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("$("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ul'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("on")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'mouseover'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\t$(e."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("target")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("css")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'background-color'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'gray'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("siblings")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("css")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'background-color'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'white'")]),s._v(")\n})\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},2680:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("Javascript 设计模式概览")]),r("p",[r("img",{attrs:{src:a("dd71"),alt:"设计模式"}})]),r("h2",[s._v("创建型模式")]),r("ul",[r("li",[s._v("单例模式（Singleton Pattern）")]),r("li",[s._v("工厂方法（Factory Method Pattern）")]),r("li",[s._v("抽象工厂（Abstract Factory）")]),r("li",[s._v("建造者模式（Builder Pattern）")])]),r("h2",[s._v("结构性模式")]),r("ul",[r("li",[s._v("适配器模式（Adapter Pattern）")]),r("li",[s._v("桥接模式（Bridge Pattern）")]),r("li",[s._v("装饰者模式（Decorator Pattern）")]),r("li",[s._v("组合模式（Componsite Pattern）")]),r("li",[s._v("外观模式（Facade Pattern）")]),r("li",[s._v("享元模式（Flyweight Pattern）")]),r("li",[s._v("代理模式（Proxy Pattern）")])]),r("h2",[s._v("行为模式")]),r("ul",[r("li",[s._v("模板方式模式（Template Method Pattern）")]),r("li",[s._v("命令模式（Command Pattern）")]),r("li",[s._v("迭代器模式（Iterator Pattern）")]),r("li",[s._v("发布-订阅模式（Public-Subscribe Pattern）")]),r("li",[s._v("中介者模式（Mediator Pattern）")]),r("li",[s._v("状态者模式（State Pattern）")]),r("li",[s._v("策略模式（Stragety Pattern）")]),r("li",[s._v("责任链模式（Chain of Responsibility Pattern）")]),r("li",[s._v("访问者模式（Visitor Pattern）")]),r("li",[s._v("备忘录模式（Memento Pattern）")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"2a3c":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("sso 单点登录之跨域 cookie 共享 （跨域缓存共享）")]),a("p",[s._v("使用 cookie 的两个属性")]),a("h4",[s._v("domain-域")]),a("p",[s._v("通过设置这个属性可以使多个 web 服务器共享 cookie。domain 属性的默认值是创建 cookie 的服务器的主机名。不能将一个 cookie 的域设置成服务器所在的域 之外的域。 举个例子: 让位于 a.taotao.com 的服务器能够读取 b.taotao.com 设置的 cookie 值。如果 b.taotao.com 的页面创建的 cookie 把 它的 path 属性设置为”/”，把 domain 属性设置成”.taotao.com”，那么所有位于 b.taotao.com 的网页和所有位于 a.taotao.com 的网页，以及位于 taotao.com 域的其他服务器上的网页都可以访问(或者说是得到)这个 cookie。")]),a("h4",[s._v("path-路径")]),a("p",[s._v("表示创建该 cookie 的服务器的 哪些路径下的 文件有权限读取该 cookie,默认为/，就是创建该 cookie 的服务器的根目录 具体实现 A 机 host 设置如下: 127.0.0.1 sso.taotao.com 172.16.30.123 portal.taotao.com B 机 host 设置如下: 127.0.0.1 portal.taotao.com 172.16.30.123 sso.taotao.com 同时开启两台服务器，sso 为单点登录系统，portal 为门户系统，portal 首页点击登录按钮，可连接到 sso 系统的登录模块，登录成功后，sso 系统设置 cookie 属性如下:")]),a("p",[s._v('token=“0821A9439FE4466395A2F4086538AEB4” Cookie cookie = newCookie(“TT_TOKEN”, token); cookie.setPath("/"); cookie.setDomain(“.taotao.com”); response.addCookie(cookie);')]),a("p",[s._v("此时 portal 服务器所在机器的浏览器得到响应信息如下 : "),a("img",{attrs:{src:"image/javascriptCookieShare/1635925627049.png",alt:""}}),s._v(" 浏览器会根据 cookie 的 domain 属性进行判断访问哪个域会携带这个 cookie,因为 com.taotao.portal 属于.taotao.com 的子域,所以在这个浏览器上访问 portal.taotao.com 服务器下的所有路径都会携带这个 cookie 。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"2af9":function(s,t,a){"use strict";a.d(t,"a",(function(){return j}));a("d3b7"),a("159b"),a("ddb0"),a("ac1f"),a("5319"),a("1276"),a("00b4"),a("b0c0");var r=a("2b0e"),e=a("5530"),n={reflowRepaint:"如何减少Dom操作中的回流和重绘问题",PostCss:"PostCss是什么鬼"},l={"babel-preset-env":"preset-env与plugin-transform-runtime使用及场景区别","Property-Descriptor":"JavaScript对象属性描述符",decorators:"JavaScript装饰器","aop-decorator":"JavaScript 设计模式之装饰者模式",heapAndStack:"JavaScript栈堆",oop:"Javascript 面向对象七大原则",reflect:"ES6 Reflect",event:"事件冒泡、事件捕获、事件委托、事件绑定",designPatterns:"Javascript 设计模式概览",singletonPattern:"JavaScript 设计模式之单例模式",statePattern:"JavaScript 设计模式之状态模式",proxyPattern:"JavaScript 设计模式之代理模式",publicSubscribePattern:"JavaScript 设计模式之发布订阅模式",hosts:"hosts文件详解",dns:"DNS 协议解析"},p={useFile:"在web应用程序中使用文件",httpCache:"浏览器缓存",config:"前端各种配置",eslint:"配置eslint",gitHooks:"使用gitHooks提交前校验代码",stylelint:"使用stylelint 校验css代码","tc39-ecma":"关于 TC39 与 ECMAScript 提案",gitssh:"github ssh-keygen ed25519"},_={},v={},c={newVue:"new Vue()初始化过程"},o=Object(e["a"])(Object(e["a"])(Object(e["a"])(Object(e["a"])(Object(e["a"])(Object(e["a"])({},n),l),p),_),v),c),i=a("e955"),h=[];i.keys().forEach((function(s){var t=i(s).default||i(s),a=s.replace(/(.*\/)*([^.]+).*/gi,"$2"),e=a.split("_");/\.md$/.test(s)&&(t.data=function(){return{}},h.push({component:t,name:e[1]||e[0],title:o[e[1]]||e[2]||e[0],fileName:a,path:e[1]||e[0]}),t.name=e[1],t.path=e[1]),r["default"].component(e[1]||e[0],t)}));var j=h},"2d12":function(s,t,a){"use strict";a("70be")},"2db3":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-28_15-23-43.63a3d56b.png"},3056:function(s,t){s.exports="data:image/webp;base64,UklGRqgNAABXRUJQVlA4IJwNAACwQACdASrKAMkAPpFGnUqlo6KhprQpQLASCWNu4XKQ+fQVd/qCfv+9R7rPnwCDh6AP/f6f/p19AHPT/7z1Af5npT/93///cF/m/+X/////+AD9gPWw9Tn/J9IB///UA///Wv9Ev6Z/AO4H+0fkT5x99jzh+m/uB6ueT+0T+R/cL8t/dPMD/CeA/vm+XfYC9df6fwodgVjn94/4vqBeqH0vuof730D/Gf697AH8l/qH+l9G/8J/pPEb+1/4f2AP53/Tf+R/lfdH/jv/Z/mfNx+c/4r/3f574B/5//cv+x62/sM/df2hP3UIyZgIB+tm4rcJN4es7vnYSXfW8mKvY0Y2nVVTXgogdm/EC/qProX9L5ZqA6F5ERC99+tS1VQHtBRnBdT/sOWREREPKsYcObwGZjLLB3oKt5RZ/ACNPNXfIrOQANt3d3e5BfKlX05d81AUvrv31d+nxlVVVVD4OjwJrsve2b8caNtd3d3dg5c5EnK83TAzuAZxzTF1qBPuGrs1h4LBv6UvoWCjNry9zWYQW24zKS1/lSY4rq2tMBSbw23d3d2hisP6VSZRZU4CdfUq5vLeZmZlsaV0klB39D/LP7WJ7FJxyQzswuYXa5mZmZUY6GZc/paporCXh+IWYVjz4rWB4latSijUGzMaVQilxQjnAy1oYuaon3KqqqqnSJIXxRmB59Pi2W+/jKAAAP7+w4yxAUEJJ+gYxiQ1blcPs3M6DgLW1nw8vWPlIeFBnyn6G1WtyLfmS2kUoykZCCFV3MZOCWclnJ/ou8ETC6FEWPp/lM/OQK6iDZorDXS5d3j4nS7acKgFJ0x0vU02nz1tkKjkQ3WyjAfEdufa2b4S2cPmrbAPSm8bEIX2x8RTDURXgh07LdOZqDWPzlaTpAvmivyQLnolLOJEAjcFG0MpR4oasxX/t/n25/zCahzjzwFExd5dzllCWYsRR4JPN9GbiEr+G9Fen/E16tqBn2Oq36CvnNVtg4tpD5lPc7cwS1ns3Y8jNUjze/eb9rz3IBllQnvUU+Rj2q5gVzSuRyqInwPwLRCIqdx3qxSR5EPHheHNFFELGM+yxjuJgSckCTPsIICP9NREfuSWGWSwMVLEVG4g3C9siXStiviBbiLQvswPT6YSPWPBlw+Xod7HOW6kb7jY19Q0EstgNrIpwZsfUudJLup1cc0VDT/GbQjAl7aX6aYM8HkF26gb/Lz5yhaWh7bY5E4c+TjvZc4JddrFp/cSmIcIVAOsbbkdMEae0oXTQmkVOGOW+u5ju56h6vKeoU0/OYH2P0+oMcuwc4YI3Tm091qayWvdT8YXDcKjkj8RXIs12F/FW5AyWptSa8Hx4jg/d7R1e5yupJ3YLxK8jHwZ8a3SLTAq4uAqRyP7RO7oQn0ctOEVM8alAa82iyUdIKbmBeAdHL21hLR8UZzvFOgdq9hSIkoUbWNQwZ3gPHs3W9DjJZlDckxnNtbMf4liZneNofFwd1MA6LDTCz4p2uejfT7oMTlJGl2kN1KXepN9XwOQ6W5dvOB2/st3QNV7y7nP4Xa8cR+PRPYeNGGcvIOblrY0xZOKSlJeEPPH7u6nL6RJLw10ReJZ448qucRuJiDU+2NbtxkVypRk7qe49IKWS5WowAO5yOW8YaCupRXDV257ym7+3dOAqkttES1DQaDuITnoOm9M0Kp2qSYx4hd6Mk7P7p/L4SjIi5l2qbhGmCHfRdY8Uz7Z+Pm/NlM7C/MUm6BSmS8i0rFxswNqBf1SXb2O8XSd8Jv6T20YgbUm5zHEtg0m0J8bJtGQx7t68CahM+ZkZs9tGlDei9fqD3khpcXGVWyDT6dGl1zTU2RE8+nB4TBXnkHrRlzsd41dWxbci/OTh5m26xDHlAIwRiuuviabAA8PW0+0DvG4ZXv1ucxmHXGtgkfSCV0PwvfizBvT0ASPimsaItJ4EyQqmDAB9Gu55XPQT3fCgkatJAD8aIT+NOhd2TrIDo4bYTdfJ+EvQgm7Mx9+VdO9NrXPdIo96x18rP4neJn1VZ3Om17Le0++LUT7+hjc6X/X6Vx/qB/O4Erg8gpafIQSk8iEXb+v9+A97Z5RM10PWY23khBmBzTR85BxTaGfpsQVnK1BKhbEtzNOA2JW8vgssdEK4fKha7zTcwj03EcIt5vU+tSOJfUmnn6M8HXePHiqa1BcFXM4AJxQEmXF/dwJvO+hYenaXIAkA+X2ARsSB6EIGGep2ooamoS5bqexJFjDsyGJOCSx09RwDNrUW/akLCeN45ORqIGDqhpM+UciioCcwDnj2GK9F14M97BgslcrnkPvGaUqV80y4S0Fv9yE00jWIZmzYBJeDiGfwXqyetAKl+fAaySiFRsv6b71KimtLcX8/yWp59gqdD9y1EqgFBiAgagL9i3NFMx0Zebnhz/MMYnQE8p+Z6R598Y+5pbdj7MWGw8YGriilCUXY2I/Py+QTFyi/p/N8J/Po9Ug82XpM3hS0BoQEbyOOYcGbuYbCTp69yYM6NH7NrnyODCQwHj9pxQBqohY2MryU3owQEs1VyWvXJAPeGi6CbPTmKAB750iWuQgFzrBeJJUDUHKz4a7iLF4vtLELJcWRVOKIEZTVUslZlc6MMWT2dJm7kfDA8QsjLZHpXCWe6T3M3T0dEMxSDxsySYJuOGkaJRfoT16KQWq2OyW+kPG/LiM+1EO+XbIDVbPlovvixjGQrDtm8HxlTC5Udlq3Z6O1EYGX2zIKN/x0V2cFD9zPfNs0j+Z9SE4WziR2pgVBJXcz7V6yjwkfO65B49Rlf4+O5LlqR093FQaW/RUZbqZh4WBzApNfxlVcI2NlF2RA7c04p/iNNNtdq82w2BuHAnGa9r0p5rGANzVNHTRY5Z3EIgLkbOx4s/JQV5V9igOEB8iSTcvVAme88T/y71x4ENDeVWlRcn/oOKBm9EHhrdbQYCDjGzbQZcQINlSc7xHKThMN/UJdsJNeJOf/iQ/3jf88IiHYy3+lxrAQ1bjCejtOATD2YhSS8gwNGpiyz/3/v4I1DeKR3JQjhO8fvjZ7yoXXvJNkZihlgb6AXks14VNF40K8xAdgit0Idy9JFmSdy8dHx6vomuPuKMJRexOvJcSgkrqL9goO+haMvXRjvVNVf2Q5sxLGg7P5ymeWGg/ak4AB+mpieoWCg6Qiu3clY80qBUYzVKT8cHAi7/qdE2eELvn7WuZWOMP/BKg7uzOe4xtCB3+z69PEDdnC/s+UNaaDZ6PHrlMx8qsMUpGHK1a5QpyZk9LKzSOTra/i99v7uvZWn4tLxF2+dhC76QbYeMYRvAXikMlkV+vxwK6n7PPNKjLNFWyf8W+InAsjumwYqWERQdwx/9G5fWP2DWQOvTqCUmrntRPDZR+PRPYeQwukR3PZN3R87ApPzSqcHeXUi/8kcbaEzM9BKdGm7u8DDrM0cjaQFns3t1PcekFKkfxVFWkzFGm2LS2SaV+1p5vNuB5ATzWxDBx6w2xnFel4cfP/ejM9IN5A9lOi38WElv/TtOTF2OR4/wexTKHJXHz0L0rPnMQtZAxMLCTRUh5+0212TK6vRu9/nAIIVK+JJ/phcxP2TFmdjvEyOCxPXrjeCjN7C+cJs1Czn1wbwfkeBca2dcOdEB7JVsHM9DsynExzH+SEJFKLo+BGtvOSPFaBLFYqpaD7zvr2jeQiFa9uO+Ihr82A+jw4HdV8SsYyGj7afpohPXjSHJtPJMAT1M8+7DCPCs2ZiZclR4KPrGI5AJVxBcFBOPke0Wji7kvIh+0vH31yJpHB/c8UzOw3kp5WTqI8EjKmcB48Rb7fUOeCI+G8gCkc3Yk3MvjicGB2Zbv7SsOMTUcwpT1cuTazFT2QfACh5OhroWMiJSCJlkko6u+QUBBPkbiljWrGtnivt0lzSnuoHBlNYWjsizzFddK2aKNOXXOcfHA6808Qv9mA4/24CLUJu7wj3Gz6LWNwMZjvpaQtUqAq++/ed10SO8Tt2zV+GA7l829acfpIJ+hukS8ntTCCf1QwAK7intTtbT8s3GRKGSRAQaGWr1dYwIGYgMsiWBj2UGuTTHU5Eb5I/uAcWcUvc62396jEfNUCMI4E/pAVNevgIy2v/QKipaXd4SouRCf6fTy2/5rLEmMmOZErocOhOMiIQg5bFN7hU6ELNJffOv8WSKarg/T9GkK1+bWAEXLGgAFxuw9zxUM9blq9FVPLA2IpTNTZ1iuL35NW8NWcA3Np8UmQEWcO3PmlcTBUbRntlv7sq3k67bX/rfUr2EDyLtvHROXqMAx6INVENf11Qz2Vnj4YLwlRbFS+HS6wr3ngWSRMrU7p116EgVkPpquLFJ1GK+JezjvGl4IOe8pMnmg6gEEPvnBzQe3ZtmHdlMjenUB7ihIOC0SQem4KSCisKTaApklksXX4AoPwpHwRNOT+3sElB0lAs8p14eW9cJIpoejA+E8k+1ITAtXC8whD5hFChE/b7cmB2oZJwLYHnpEV+Oiwha6RU5PBvlRZBwkT6ZWSuZbo3AJCfA4AgRKxrKQEZs6KhQQ7A/GLdW/CHvevsWUw3vfRtZilywpQleaRnCs+i81DdqIrV6Y1DpSqkBI8wyhdgJ+qepYCb0O7CrWv9KDgi1WALKNUR4NpcM3qk3QI7wmZ7kIGSIQtAAA"},"306e":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-06_23-43-04.027f99a7.png"},"30b2":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h3",[s._v("EventLoop")]),r("h4",[s._v("JavaScript 代码执行机制 异步单线程非阻塞")]),r("p",[s._v("1、遇到同步代码直接执行 2、遇到异步代码先放一边，并且将他回调函数存起来，存的地方叫事件队列 3、等所有同步代码都执行完，再从事件队列中把存起来的所有异步回调函数拿出来按顺序执行")]),r("p",[r("img",{attrs:{src:a("14f4"),alt:""}})]),r("h4",[s._v("宏任务 && 微任务")]),r("h5",[s._v("宏任务")]),r("blockquote",[r("p",[s._v("执行宏任务按照任务时间执行，时间相同则按照对列的先后")])]),r("table",[r("thead",[r("tr",[r("th",[s._v("#")]),r("th",[s._v("浏览器")]),r("th",[s._v("Node")])])]),r("tbody",[r("tr",[r("td",[s._v("I/O")]),r("td",[s._v("✅")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("setTimeout")]),r("td",[s._v("✅")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("setTimeout")]),r("td",[s._v("✅")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("setInterval")]),r("td",[s._v("✅")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("setImmediate")]),r("td",[s._v("❌")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("requestAnimationFrame")]),r("td",[s._v("✅")]),r("td",[s._v("❌")])])])]),r("h5",[s._v("微任务")]),r("blockquote",[r("p",[r("strong",[s._v("注意：")]),s._v(" 微任务值得是 promise.then catch finally(请求回来的时候) 而不是发请求的出去的时候")])]),r("table",[r("thead",[r("tr",[r("th",[s._v("#")]),r("th",[s._v("浏览器")]),r("th",[s._v("node")])])]),r("tbody",[r("tr",[r("td",[s._v("Promise.prototype.then catch finally")]),r("td",[s._v("✅")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("process.nextTick")]),r("td",[s._v("❌")]),r("td",[s._v("✅")])]),r("tr",[r("td",[s._v("MutationObserver")]),r("td",[s._v("❌")]),r("td",[s._v("✅")])])])]),r("h5",[s._v("执行流程")]),r("p",[r("img",{attrs:{src:a("3718"),alt:""}})])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"32aa":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-47-32.de40dd71.png"},"32e0":function(s,t,a){var r={"./home.svg":"68cb"};function e(s){var t=n(s);return a(t)}function n(s){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return r[s]}e.keys=function(){return Object.keys(r)},e.resolve=n,s.exports=e,e.id="32e0"},3718:function(s,t,a){s.exports=a.p+"img/df0c1091.8fbff738.png"},"394a":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h2",[s._v("Vue Router相关")]),a("h3",[s._v("介绍一下 keep-alive")]),a("p",[s._v("keep-alive 是 Vue 内置的一个组件，可以缓存组件的状态，避免重复渲染，提高性能。 keep-alive 内置组件有 3 个属性")]),a("p",[s._v("include：字符串或正则表达式，名称匹配的组件会被缓存。 exclude：字符串或正则表达式，名称匹配的组件不会被缓存。 max：缓存组件数量阈值")]),a("p",[s._v("设置 keep-alive 的组件，会增加两个生命钩子（activated / deactivated）。 首次进入组件：beforeCreate -> created -> beforeMount -> mounted -> activated 离开组件触发 deactivated，因为组件缓存不销毁，所以不会触发 beforeDestroy 和 destroyed 生命钩子。再次进入组件后直接从 activated 生命钩子开始。")]),a("p",[s._v("常见业务场景：在列表页的第 2 页进入详情页，详情页返回，依然停留在第 2 页，不重新渲染。但从其他页面进入列表页，还是需要重新渲染。")]),a("p",[s._v("思路：vuex 使用数组存储列表页名字，列表页离开结合 beforeRouteLeave 钩子判断是否需要缓存，对全局数组进行更改。 在 router-view 标签位置如下使用")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("keep-alive")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":include")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"cacheRouting"')]),s._v(">")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-view")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("router-view")]),s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("keep-alive")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("computed")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cacheRouting")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$store")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("cacheRouting")]),s._v("\n\t\t}\n\t}\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n")])]),a("p",[s._v("列表页如下使用")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeRouteLeave")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") {\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v("(to."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'详情页'")]),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ... 向全局缓存路由数组添加列表页")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("next")]),s._v("()\n    } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n      "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ... 向全局缓存路由数组删除列表页")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("next")]),s._v("()\n    }\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n\n")])]),a("h3",[s._v("Vue-Router 配置 404 页面")]),a("p",[s._v("* 代表通配符，若放在任意路由前，会被先匹配，导致跳转到 404 页面，所以需将如下配置置于最后。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("{\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'*'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'404'")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./404.vue'")]),s._v(")\n}\n")])]),a("h3",[s._v("Vue-Router 有哪几种导航守卫")]),a("h4",[s._v("全局前置守卫 router.beforeEach")]),a("p",[s._v("在路由跳转前触发，可在执行 next 方法前做一些身份登录验证的逻辑。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("VueRouter")]),s._v("({})\n\nrouter."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") =>")]),s._v(" {\n ...\n "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 必须执行 next 方法来触发路由跳转")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("next")]),s._v("()\n})\n")])]),a("h4",[s._v("全局解析守卫 router.beforeResolve")]),a("p",[s._v("与 beforeEach 类似，也是路由跳转前触发，区别是还需在所有组件内守卫和异步路由组件被解析之后，也就是在组件内 beforeRouteEnter 之后被调用。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("VueRouter")]),s._v("({})\n\nrouter."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeResolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") =>")]),s._v(" {\n  ...\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 必须执行 next 方法来触发路由跳转")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("next")]),s._v("()\n})\n")])]),a("h4",[s._v("全局后置钩子 router.afterEach")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("router."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("afterEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")])]),s._v(") =>")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n})\n")])]),a("h4",[s._v("路由独享守卫")]),a("p",[s._v("可在路由配置上直接定义 beforeEnter")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("VueRouter")]),s._v("({\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("routes")]),s._v(": [\n\t\t{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/home'")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Home")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("beforeEnter")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") =>")]),s._v(" {}\n\t\t}\n\t]\n})\n")])]),a("h4",[s._v("组件内的守卫")]),a("p",[s._v("组件内可直接定义如下路由导航守卫")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Foo")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`...`")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeRouteEnter")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 不能获取组件实例 this")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 当守卫执行前，组件实例还没被创建")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeRouteUpdate")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 当前路由改变，但是组件被复用时调用")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 可访问实例 this")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeRouteLeave")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("to, "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(", next")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 导航离开组件时被调用")]),s._v("\n\t}\n}\n")])]),a("h3",[s._v("Vue-Router 完整的导航解析流程")]),a("ol",[a("li",[s._v("导航被触发")]),a("li",[s._v("在失活的组件里调用 beforeRouteLeave 守卫")]),a("li",[s._v("调用全局 beforeEach 前置守卫")]),a("li",[s._v("重用的组件调用 beforeRouteUpdate 守卫（2.2+）")]),a("li",[s._v("路由配置调用 beforeEnter")]),a("li",[s._v("解析异步路由组件")]),a("li",[s._v("在被激活的组件里调用 beforeRouteEnter 守卫")]),a("li",[s._v("调用全局的 beforeResolve 守卫（2.5+）")]),a("li",[s._v("导航被确认")]),a("li",[s._v("调用全局的 afterEach")]),a("li",[s._v("触发 DOM 更新")]),a("li",[s._v("调用   beforeRouteEnter  守卫中传给  next  的回调函数，创建好的组件实例会作为回调函数的参数传入")])]),a("h3",[s._v("Vue-Router 路由有几种模式？说说他们的区别？")]),a("p",[s._v("Vue-Router 有 3 种路由模式：hash、history、abstract。")]),a("h4",[s._v("hash 模式")]),a("p",[s._v("Vue-Router 默认为 hash 模式，基于浏览器的 onhashchange 事件，地址变化时，通过 window.location.hash 获取地址上的 hash 值；根据 hash 值匹配 routes 对象对应的组件内容。 特点")]),a("ul",[a("li",[s._v("hash 值存在 URL 中，携带#，hash 值改变不会重载页面。")]),a("li",[s._v("hash 改变会触发 onhashchange 事件，可被浏览器记录，从而实现浏览器的前进后退。")]),a("li",[s._v("hash 传参基于 url，传递复杂参数会有体积限制。")]),a("li",[s._v("兼容性好，支持低版本浏览器和 IE 浏览器。")])]),a("p",[s._v("案例代码，需在本地启用服务（http-server）访问, 已测试过，可直接 cv 体验。 实现原理")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"main"')]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#/home"')]),s._v(">")]),s._v("home"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#/detail"')]),s._v(">")]),s._v("detail"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"content"')]),s._v(">")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("暂无内容"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" routers = [{\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/'")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<span>暂无内容</span>`")]),s._v("\n  },\n  {\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/home'")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<span>我是Home页面</span>`")]),s._v("\n  }, {\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/detail'")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<span>我是Detail页面</span>`")]),s._v("\n  }]\n\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Router")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("routers")]),s._v(") {\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'执行'")]),s._v(")\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v(" = {}\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 初始化生成 routers")]),s._v("\n    routers."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("router")]),s._v(") =>")]),s._v(" {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[router."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("path")]),s._v("] = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n        "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"content"')]),s._v(")."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = router."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("component")]),s._v(";\n      }\n    })\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("updateView")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" hash = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("location")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("hash")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("slice")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/'")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hash更新'")]),s._v(", hash, "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[hash])\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[hash] && "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[hash]()\n    }\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由加载触发视图更新")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'load'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("updateView")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("))\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由改变触发视图更新")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hashchange'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("updateView")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("))\n  }\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 实例化 hash 模式的 Router")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Router")]),s._v("(routers)\n</scrip\n\n")])])]),a("h3",[s._v("history 模式")]),a("p",[s._v("基于 HTML5 新增的 pushState 和 replaceState 实现在不刷新的情况下，操作浏览器的历史纪录。前者是新增历史记录，后者是直接替换历史记录。 特点")]),a("ul",[a("li",[s._v("URL 不携带#，利用 pushState 和 replaceState 完成 URL 跳转而无须重新加载页面。")]),a("li",[s._v("URL 更改会触发 http 请求。所以在服务端需增加一个覆盖所有情况的候选资源：若 URL-匹配不到任何静态资源，则应该返回同一个 index.html。这个页面就是 app 依赖的页面。")]),a("li",[s._v("兼容性 IE10+")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-nginx"}},[s._v("// "),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("nginx")]),s._v(" 服务端配置\nlocation / {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("try_files")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable"}},[s._v("$uri")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable"}},[s._v("$uri")]),s._v("/ /index.html;\n}\n")])]),a("p",[s._v("实现原理")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"main"')]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"javascript:;"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/home"')]),s._v(">")]),s._v("home"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"javascript:;"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/detail"')]),s._v(">")]),s._v("detail"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"content"')]),s._v(">")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("暂无内容"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" routers = [{\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/home'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<span>我是Home页面</span>`")]),s._v("\n}, {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/detail'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`<span>我是Detail页面</span>`")]),s._v("\n}, {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'<span>暂无内容</span>'")]),s._v("\n}]\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Router")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("routers")]),s._v(") {\n  "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v(" = {}\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 初始化生成 routers")]),s._v("\n  routers."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("router")]),s._v(") =>")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[router."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("path")]),s._v("] = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"content"')]),s._v(")."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = router."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("component")]),s._v(";\n    }\n  })\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" links = [..."),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementsByTagName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v(")]\n  links."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("link")]),s._v(" =>")]),s._v(" {\n    link."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'click'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("history")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("pushState")]),s._v("({}, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", link."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getAttribute")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'path'")]),s._v("))\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("updateView")]),s._v("()\n    })\n  })\n  "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("updateView")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" url = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("location")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("pathname")]),s._v(" || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[url] && "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("routers")]),s._v("[url]()\n  }\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由加载触发视图更新")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'load'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("updateView")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("))\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由改变触发视图更新")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'popstate'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("updateView")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("))\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 实例化 history 模式的 Router")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Router")]),s._v("(routers)\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n\n")])]),a("h4",[s._v("abstract 模式")]),a("p",[s._v("支持所有 JS 运行模式，Vue-Router 自身会对环境做校验，如果发现没有浏览器 API，路由会自动强制进入 abstract 模式。在移动端原生环境也是使用 abstract 模式。")]),a("h3",[s._v("Vue 路由传参方式")]),a("h4",[s._v("方案一")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由配置")]),s._v("\n{\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/detail/:id'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Detail'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./Detail.vue'")]),s._v(")\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由跳转")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" id = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$router")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/detail/${id}'")]),s._v("})\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$route")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("params")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v("\n\n")])]),a("h4",[s._v("方案二")]),a("p",[s._v("方案二，URL 虽然不显示我们的传参，但是是可以在子组件获取参数的。当然也有问题：会存在刷新丢失参数。")]),a("p",[s._v("若想不丢失，需和方案一路由配置一样。原因是第二种方式传参是上一个页面 push 函数中携带的，刷新没有 push 的动作。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由配置")]),s._v("\n{\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/detail'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Detail'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./Detail.vue'")]),s._v(")\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由跳转")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" id = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$router")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Detail'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("params")]),s._v(": { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": id } })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$route")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("params")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v("\n\n")])]),a("h4",[s._v("方案三")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由配置")]),s._v("\n{\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/detail'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Detail'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./Detail.vue'")]),s._v(")\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 路由跳转")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" id = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$router")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Detail'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("query")]),s._v(": { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": id } })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$route")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("query")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v("\n\n\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"3a03":function(s,t,a){"use strict";a.r(t);var r=a("2909"),e=a("5530"),n=(a("d3b7"),a("3ca3"),a("ddb0"),a("d81d"),a("b0c0"),a("4de4"),a("ac1f"),a("00b4"),a("2af9")),l=function(){return a.e("JavaScriptRoute").then(a.bind(null,"5e18"))},p=n["a"].map((function(s){return Object(e["a"])(Object(e["a"])({},s),{},{path:s.name,label:s.title,meta:{title:s.title}})})),_=p.filter((function(s){return/^(vue)/i.test(s.fileName)})),v=p.filter((function(s){return/^(javascript)/i.test(s.fileName)})),c=p.filter((function(s){return/^(css)/i.test(s.fileName)})),o=p.filter((function(s){return/^(react)/i.test(s.fileName)}));console.log("reactMdRoutes",o);var i=p.filter((function(s){return/^(other)/i.test(s.fileName)})),h=p.filter((function(s){return/^(typescript)/i.test(s.fileName)}));t["default"]=[{path:"vueMd",name:"vueMd",component:l,meta:{title:"vue相关Md文件"},children:Object(r["a"])(_)},{path:"jsMd",name:"jsMd",component:l,meta:{title:"js相关md文件"},children:Object(r["a"])(v)},{path:"tsMd",name:"tsMd",component:l,meta:{title:"ts相关md文件"},children:Object(r["a"])(h)},{path:"cssMd",name:"cssMd",component:l,meta:{title:"css相关md文件"},children:Object(r["a"])(c)},{path:"reactMd",name:"reactMd",component:l,meta:{title:"react相关md文件"},children:Object(r["a"])(o)},{path:"otherMd",name:"otherMd",component:l,meta:{title:"其他md"},children:Object(r["a"])(i)}]},"3cd6":function(s,t,a){},"3da9":function(s,t,a){"use strict";a("5310")},"3e8e":function(s,t,a){},"3fab":function(s,t,a){"use strict";a.r(t);var r=a("5530"),e=(a("d3b7"),a("ddb0"),a("caad"),a("2532"),a("b2d6")),n=a.n(e),l=a("ba25"),p=l.keys().reduce((function(s,t){return t.includes("en")&&(s=Object.assign({},s,l(t).default)),s}),{});t["default"]={en:Object(r["a"])(Object(r["a"])({},p),n.a)}},"400e":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_16-05-41.f0d62499.png"},4050:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("在 web 应用程序中使用文件")]),a("p",[s._v("通过使用在 HTML5 中加入到 DOM 的 File API，使在 web 内容中让用户选择本地文件然后读取这些文件的内容成为可能。用户可以通过 HTML 中的 "),a("code",{pre:!0},[s._v('<input type="file">')]),s._v(" 元素或者是通过拖拽来选择本地文件 "),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/File/Using_files_from_web_applications#%E8%8E%B7%E5%8F%96%E8%A2%AB%E9%80%89%E6%8B%A9%E6%96%87%E4%BB%B6%E7%9A%84%E4%BF%A1%E6%81%AF"}},[s._v("参考")])]),a("p",[s._v("如果你想通过扩展或者其它的 chrome 源码浏览器（browser chrome code）使用 DOM File API，是可行的；然而，需要注意有一些附加特性。")]),a("h2",[s._v("访问被选择的文件")]),a("p",[s._v("考虑这段 HTML:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"file"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input"')]),s._v(" />")]),s._v("\n")])]),a("p",[s._v("通过 File API，我们可以访问 FileList，它包含了表示用户所选文件的 File 对象")]),a("p",[s._v("如果用户只选择了一个文件，那么只需要考虑列表中的第一个文件。")]),a("p",[s._v("使用传统的 DOM 选择器访问一个被选择的文件：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" selectedFile = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input'")]),s._v(")."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("files")]),s._v("["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("]\n")])]),a("h3",[s._v("通过 change 事件访问被选择的文件")]),a("p",[s._v("可以（但不是强制的）通过 change 事件访问 FileList：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"file"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("onchange")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"handleFiles(this.files)"')]),s._v(" />")]),s._v("\n")])]),a("p",[s._v("当用户选择一个文件时，handleFiles() 方法会用一个 FileList 对象作为参数被调用，FileList 对象包含表示用户选择的文件的 File 对象。")]),a("p",[s._v("如果你想让用户选择多个文件，只需在 input 元素上使用 multiple 属性：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"file"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"input"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("multiple")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("onchange")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"handleFiles(this.files)"')]),s._v(" />")]),s._v("\n")])]),a("p",[s._v("在这个例子中，对于每个用户选择的文件，传递给 handleFiles()方法的文件列表都包含一个对应的 File 对象")]),a("h3",[s._v("动态添加 change 监听器")]),a("p",[s._v("你需要使用 EventTarget.addEventListener() 去添加 change 事件监听器，像这样：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" inputElement = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input'")]),s._v(")\ninputElement."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'change'")]),s._v(", handleFiles, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handleFiles")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fileList = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("files")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* now you can work with the file list */")]),s._v("\n}\n")])]),a("blockquote",[a("p",[s._v("注意在这个例子里，handleFiles() 方法本身是一个事件处理器，不像之前的例子中，它被事件处理器调用然后传递给它一个参数。")])]),a("h2",[s._v("获取被选择文件的信息")]),a("p",[s._v("DOM 提供 FileList 对象列出了用户选择的所有文件，每一个文件被指定为一个 File 对象。你可以通过检查文件列表 FileList 的 length 属性来确定用户选择了多少个文件：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" numFiles = files."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("\n")])]),a("p",[s._v("可以像数组一样简单地访问文件列表来检索各个 File 对象：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", numFiles = files."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < numFiles; i++) {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" file = files[i]\n}\n")])]),a("p",[s._v("这个循环遍历了文件列表里的所有文件")]),a("p",[s._v("File 对象提供了三个属性，包含了文件的有用信息")]),a("ul",[a("li",[a("strong",[s._v("name")]),s._v(" 文件名称，只读字符串。只包含文件名，不包含任何路径信息。")]),a("li",[a("strong",[s._v("size")]),s._v(" 以字节数为单位的文件大小，只读的 64 位整数。")]),a("li",[a("strong",[s._v("type")]),s._v(' 文件的 MIME 类型，只读字符串，当类型不能确定时为 ""')])]),a("h3",[s._v("示例：显示文件大小")]),a("p",[s._v("下面的例子展示了 size 属性的一种可能用法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta charset=\"UTF-8\" />\n\t\t<title>File(s) size</title>\n\t\t<script>\n\t\t\tfunction updateSize() {\n\t\t\t\tlet nBytes = 0,\n\t\t\t\t\toFiles = document.getElementById('uploadInput').files,\n\t\t\t\t\tnFiles = oFiles.length\n\t\t\t\tfor (let nFileId = 0; nFileId < nFiles; nFileId++) {\n\t\t\t\t\tnBytes += oFiles[nFileId].size\n\t\t\t\t}\n\t\t\t\tlet sOutput = nBytes + ' bytes'\n\t\t\t\t// optional code for multiples approximation\n\t\t\t\tconst aMultiples = ['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB']\n\t\t\t\tfor (nMultiple = 0, nApprox = nBytes / 1024; nApprox > 1; nApprox /= 1024, nMultiple++) {\n\t\t\t\t\tsOutput = nApprox.toFixed(3) + ' ' + aMultiples[nMultiple] + ' (' + nBytes + ' bytes)'\n\t\t\t\t}\n\t\t\t\t// end of optional code\n\t\t\t\tdocument.getElementById('fileNum').innerHTML = nFiles\n\t\t\t\tdocument.getElementById('fileSize').innerHTML = sOutput\n\t\t\t}\n\t\t<\/script>\n\t</head>\n\n\t<body onload=\"updateSize()\">\n\t\t<form name=\"uploadForm\">\n\t\t\t<div>\n\t\t\t\t<input id=\"uploadInput\" type=\"file\" name=\"myFiles\" onchange=\"updateSize();\" multiple />\n\t\t\t\tselected files:\n\t\t\t\t<span id=\"fileNum\">0</span>\n\t\t\t\t; total size:\n\t\t\t\t<span id=\"fileSize\">0</span>\n\t\t\t</div>\n\t\t\t<div><input type=\"submit\" value=\"Send file\" /></div>\n\t\t</form>\n\t</body>\n</html>\n")])]),a("h2",[s._v("通过 click() 方法使用隐藏的 file input 元素")]),a("p",[s._v("你可以隐藏公认难看的 file "),a("code",{pre:!0},[s._v("<input>")]),s._v(" 元素并显示你自己的界面来打开文件选择器，然后显示哪个或哪些文件被用户选中了。你可以通过给 input 元素添加 display:none 的样式，再调用 "),a("code",{pre:!0},[s._v("<input>")]),s._v(" 元素的 click() 方法来实现")]),a("p",[s._v("考虑这段 HTML：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"file"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileElem"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("multiple")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("accept")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"image/*"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("style")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"display:none"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("onchange")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"handleFiles(this.files)"')]),s._v(" />")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileSelect"')]),s._v(">")]),s._v("Select some files"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n")])]),a("p",[s._v("处理 click 事件的代码类似于这样：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fileSelect = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fileSelect'")]),s._v("),\n\tfileElem = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fileElem'")]),s._v(")\n\nfileSelect."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("(\n\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'click'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (fileElem) {\n\t\t\tfileElem."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("click")]),s._v("()\n\t\t}\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n)\n")])]),a("p",[s._v("你可以给这个用来打开文件选择器的新按钮添加任何你想要的样式。")]),a("h2",[s._v("使用 label 元素来触发一个隐藏的 file input 元素")]),a("p",[s._v("允许在不使用 JavaScript（click() 方法）来打开文件选择器，可以使用 "),a("code",{pre:!0},[s._v("<label>")]),s._v(" 元素。注意在这种情况下，input 元素不能使用 display: none（或 visibility: hidden）隐藏，否则 label 将无法通过键盘访问。使用 visually-hidden technique 作为替代。")]),a("p",[s._v("考虑这段 HTML：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"file"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileElem"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("multiple")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("accept")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"image/*"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"visually-hidden"')]),s._v(" />")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("label")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("for")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileElem"')]),s._v(">")]),s._v("Select some files"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("label")]),s._v(">")]),s._v("\n")])]),a("p",[s._v("和这段 CSS：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-css"}},[a("span",{pre:!0,attrs:{class:"hljs-selector-class"}},[s._v(".visually-hidden")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("position")]),s._v(": absolute "),a("span",{pre:!0,attrs:{class:"hljs-meta"}},[s._v("!important")]),s._v(";\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("height")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1px")]),s._v(";\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("width")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1px")]),s._v(";\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("overflow")]),s._v(": hidden;\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("clip")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("rect")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1px")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1px")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1px")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1px")]),s._v(");\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* Separate rule for compatibility, :focus-within is required on modern Firefox and Chrome */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-selector-tag"}},[s._v("input")]),a("span",{pre:!0,attrs:{class:"hljs-selector-class"}},[s._v(".visually-hidden")]),a("span",{pre:!0,attrs:{class:"hljs-selector-pseudo"}},[s._v(":focus")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-selector-tag"}},[s._v("label")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("outline")]),s._v(": thin dotted;\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-selector-tag"}},[s._v("input")]),a("span",{pre:!0,attrs:{class:"hljs-selector-class"}},[s._v(".visually-hidden")]),a("span",{pre:!0,attrs:{class:"hljs-selector-pseudo"}},[s._v(":focus")]),s._v("-within + "),a("span",{pre:!0,attrs:{class:"hljs-selector-tag"}},[s._v("label")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("outline")]),s._v(": thin dotted;\n}\n")])]),a("p",[s._v("这里不需要添加任何 JavaScript 代码来调用 fileElem.click()，另外，这时你也可以给 label 元素添加你想要的样式。您需要在其 label 上提供隐藏 input 字段的焦点状态的视觉提示，比如上面用的轮廓，或者背景颜色或边框阴影。（截至编写时为止，Firefox 不显示 "),a("code",{pre:!0},[s._v('<input type="file">')]),s._v(" 元素的视觉提示。）")]),a("h2",[s._v("使用拖放来选择文件")]),a("p",[s._v("你还可以让用户将文件拖拽到你的网页应用中。")]),a("p",[s._v("第一步是创建一个 drop 区域。虽然你网页内容的哪部分接受拖放取决于你的应用设计，但是使一个元素接收 drop 事件是很容易的。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" dropbox\n\ndropbox = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'dropbox'")]),s._v(")\ndropbox."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'dragenter'")]),s._v(", dragenter, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(")\ndropbox."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'dragover'")]),s._v(", dragover, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(")\ndropbox."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'drop'")]),s._v(", drop, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(")\n")])]),a("p",[s._v("在这个例子中，我们将 ID 为 dropbox 的元素变为了我们的 drop 区域。这是通过给元素添加 dragenter (en-US), dragover (en-US), 和 drop (en-US) 事件监听器实现的。")]),a("p",[s._v("我们其实并不需要对 dragenter and dragover 事件进行处理，所以这些函数都很简单。他们只需要包括禁止事件传播和阻止默认事件：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("dragenter")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stopPropagation")]),s._v("()\n\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("preventDefault")]),s._v("()\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("dragover")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stopPropagation")]),s._v("()\n\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("preventDefault")]),s._v("()\n}\n")])]),a("p",[s._v("真正的奥妙在 drop()这个函数中：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("drop")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stopPropagation")]),s._v("()\n\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("preventDefault")]),s._v("()\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" dt = e."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("dataTransfer")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" files = dt."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("files")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handleFiles")]),s._v("(files)\n}\n")])]),a("p",[s._v("这里，我们从事件中获取到了 dataTransfer 这个域，然后从中得到文件列表，再将它们传递给 handleFiles()函数。在这之后，处理文件的方法和用 input 元素或者用拖拽就是一样的了。")]),a("h2",[s._v("例子：显示用户选择的图片的缩略图")]),a("p",[s._v("比方说，你正在开发一个炫酷的下一代图片分享网站，并且想使用 HTML5 来展示用户在实际上传之前的图片的缩略图。你可以像我们之前讨论的那样创建自己的 input 元素或者 drop 区域，然后对他们使用一个回调函数，比如下面的 handleFiles()。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handleFiles")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("files")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < files."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i++) {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" file = files[i]\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" imageType = "),a("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/^image\\//")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!imageType."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("(file."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("type")]),s._v(")) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("continue")]),s._v("\n\t\t}\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" img = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'img'")]),s._v(")\n\t\timg."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("classList")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("add")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'obj'")]),s._v(")\n\t\timg."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("file")]),s._v(" = file\n\t\tpreview."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(img) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 假设"preview"就是用来显示内容的div')]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" reader = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FileReader")]),s._v("()\n\t\treader."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("aImg")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\t\t\t\taImg."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = e."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("target")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("result")]),s._v("\n\t\t\t}\n\t\t})(img)\n\t\treader."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readAsDataURL")]),s._v("(file)\n\t}\n}\n")])]),a("p",[s._v('这里我们循环处理用户选择的文件，看每个文件的 type 属性是不是 image（通过正则表达式来匹配 MIME 类型字符串模式"image/*"）。 对每个文件而言，如果它是 image，我们就创建一个新的 img 元素。可以使用 css 来创建一个漂亮的边框或阴影来显示图片的具体大小，在这儿就不具体做了。')]),a("p",[s._v("为了在 DOM 树中更容易地找到他们，每个图片元素都被添加了一个名为 obj 的 CSS 类。我们还给每个图片添加了 file 属性使它具有 File；这样做可以让我们拿到稍后需要实际上传的图片。我们在预览页中使用 Node.appendChild()来添加新的缩略图。")]),a("p",[s._v("接下来，我们创建了 FileReader 来处理异步的图片加载并把他赋给 img 元素。在创建一个新的 FileReader 对象后，我们新建了它的 onload 函数，然后调用 readAsDataURL()函数开始后台读取文件。当整个图片文件的内容都被全部加载完后，它们被转换成了一个被传递到 onload 回调函数的 data:URL。我们再执行常规操作将 img 元素的 src 属性设置为刚刚加载完毕的 URL，使得图像可以显示在用户屏幕上的缩略图中。")]),a("h2",[s._v("使用对象 URL")]),a("p",[s._v("Gecko 2.0 (Firefox 4 / Thunderbird 3.3 / SeaMonkey 2.1)引入了对 DOM window.URL.createObjectURL() (en-US) 和 window.URL.revokeObjectURL() (en-US) 方法的支持。这使得你可以创建用于引用任何数据的简单 URL 字符串，也可以引用一个包括用户电脑上的本地文件的 DOM File 对象。")]),a("p",[s._v("当你需要在 HTML 中通过 URL 来引用一个 File 对象时，你可以创建一个对象 URL，就像这样：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" objectURL = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createObjectURL")]),s._v("(fileObj)\n")])]),a("p",[s._v("这个对象 URL 是一个标识 File 对象的字符串。每次你调用 window.URL.createObjectURL() (en-US)，就会产生一个唯一的对象 URL，即使是你对一个已创建了对象 URL 的文件再次创建一个对象 URL。每个创建了的对象 URL 必须要释放。当文档关闭时，它们会自动被释放。如果你的网页要动态使用它们，你需要显式调用 window.URL.revokeObjectURL() (en-US)来释放它们：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("revokeObjectURL")]),s._v("(objectURL)\n")])]),a("h3",[s._v("示例：使用对象 URL 来显示图片")]),a("p",[s._v("这个例子使用对象 URL 来显示图片缩略图。另外，示例也会显示文件名和文件大小等其他文件信息。")]),a("p",[s._v("显示接口的 HTML 类似于这样：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"file"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileElem"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("multiple")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("accept")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"image/*"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("style")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"display:none"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("onchange")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"handleFiles(this.files)"')]),s._v(" />")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("href")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"#"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileSelect"')]),s._v(">")]),s._v("Select some files"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("a")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"fileList"')]),s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("p")]),s._v(">")]),s._v("No files selected!"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("p")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n")])]),a("p",[s._v("这确定我们的文件 "),a("code",{pre:!0},[s._v("<input>")]),s._v(" 元素显示为一个可以调用文件选择器的链接（我们隐藏了文件输入元素来阻止显示用户不友好的界面）。这个在 Using hidden file input elements using the click() method 节已经说明了这种调用文件选择器的方法。")]),a("p",[s._v("handleFiles() 方法如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v(" || "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("webkitURL")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fileSelect = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fileSelect'")]),s._v("),\n\tfileElem = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fileElem'")]),s._v("),\n\tfileList = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fileList'")]),s._v(")\n\nfileSelect."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("(\n\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'click'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (fileElem) {\n\t\t\tfileElem."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("click")]),s._v("()\n\t\t}\n\t\te."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("preventDefault")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// prevent navigation to "#"')]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handleFiles")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("files")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!files."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v(") {\n\t\tfileList."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'<p>No files selected!</p>'")]),s._v("\n\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\tfileList."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" list = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ul'")]),s._v(")\n\t\tfileList."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(list)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < files."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i++) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" li = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'li'")]),s._v(")\n\t\t\tlist."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(li)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" img = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'img'")]),s._v(")\n\t\t\timg."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createObjectURL")]),s._v("(files[i])\n\t\t\timg."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("height")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("60")]),s._v("\n\t\t\timg."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("revokeObjectURL")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(")\n\t\t\t}\n\t\t\tli."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(img)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" info = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'span'")]),s._v(")\n\t\t\tinfo."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = files[i]."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("': '")]),s._v(" + files[i]."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("size")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' bytes'")]),s._v("\n\t\t\tli."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(info)\n\t\t}\n\t}\n}\n")])]),a("p",[s._v("首先，获取 ID 为 fileList 的 "),a("code",{pre:!0},[s._v("<div>")]),s._v(" 。这个区块里我们会插入我们的文件列表，包括缩略图。")]),a("p",[s._v("如果传入 handleFiles() 的 FileList 对象值为 null 时，我们只要简单将这块的内部 HTML 为显示“No files selected!”。否则，我们就需要像下面这样编写我们的文件列表：")]),a("ol",[a("li",[s._v("创建一个无序列表 ("),a("code",{pre:!0},[s._v("<ul>")]),s._v(") 元素。")]),a("li",[s._v("通过调用列表的 Node.appendChild()方法来将新的列表元素插入到 "),a("code",{pre:!0},[s._v("<div>")]),s._v("块。")]),a("li",[s._v("遍历文件集合 FileList（即 files）中的每个 File：")]),a("li",[s._v("创建一个新的列表项（"),a("code",{pre:!0},[s._v("<li>")]),s._v("）元素并插入到列表中。")]),a("li",[s._v("创建一个新的图片（"),a("code",{pre:!0},[s._v("<img>")]),s._v("）元素")]),a("li",[s._v("设置图片的源为一个新的指代文件的对象 URL，使用 window.URL.createObjectURL() (en-US)来创建 blob URL")]),a("li",[s._v("设置图片的高度为 60 像素")]),a("li",[s._v("设置图片的 load 事件处理器来释放对象 URL，当图片加载完成之后对象 URL 就不再需要了。这个可以通过调用 window.URL.revokeObjectURL() (en-US)方法并且传递 img.src 中的对象 URL 字符串来实现。")]),a("li",[s._v("将新的列表项添加到列表中")])]),a("h2",[s._v("例子：上传一个用户选择的文件")]),a("p",[s._v("另一件您可能想要做的事是让用户将选定的一个或多个文件（例如前一个示例中选择的图像）上传到服务器。这用异步可以很容易地完成")]),a("h3",[s._v("创建上传任务")]),a("p",[s._v("继续前面示例中构建缩略图的代码，回想一下每个缩略图图像都在 CSS 类 obj 中，并且 file 属性中附加了相应的 File 。这允许我们使用 Document.querySelectorAll() 选择用户决定上传的所有图像，如下所示：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sendFiles")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" imgs = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("querySelectorAll")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'.obj'")]),s._v(")\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < imgs."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i++) {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FileUpload")]),s._v("(imgs[i], imgs[i]."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("file")]),s._v(")\n\t}\n}\n")])]),a("p",[s._v("第 2 行获取了文档中所有 CSS 类为 obj 的元素的 NodeList，命名为 imgs。在我们的例子中，这些是包含所有图像缩略图的列表。有了这个列表，遍历并为每一项创建一个新的 FileUpload 实例就很简单了。每个实例都可以处理相应文件的上传")]),a("h3",[s._v("处理文件的上传过程")]),a("p",[s._v("FileUpload 函数接受两个输入：一个 image 元素和一个包含图像数据的文件。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("FileUpload")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("img, file")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" reader = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FileReader")]),s._v("()\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("ctrl")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createThrobber")]),s._v("(img)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" xhr = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("XMLHttpRequest")]),s._v("()\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("xhr")]),s._v(" = xhr\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" self = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("xhr")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("upload")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("(\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'progress'")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (e."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("lengthComputable")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" percentage = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("round")]),s._v("((e."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("loaded")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(") / e."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("total")]),s._v(")\n\t\t\t\tself."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("ctrl")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("update")]),s._v("(percentage)\n\t\t\t}\n\t\t},\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n\t)\n\n\txhr."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("upload")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("addEventListener")]),s._v("(\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'load'")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("e")]),s._v(") {\n\t\t\tself."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("ctrl")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("update")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" canvas = self."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("ctrl")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("ctx")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("canvas")]),s._v("\n\t\t\tcanvas."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("parentNode")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("removeChild")]),s._v("(canvas)\n\t\t},\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n\t)\n\txhr."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("open")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'POST'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'http://demos.hacks.mozilla.org/paul/demos/resources/webservices/devnull.php'")]),s._v(")\n\txhr."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("overrideMimeType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'text/plain; charset=x-user-defined-binary'")]),s._v(")\n\treader."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("evt")]),s._v(") {\n\t\txhr."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("send")]),s._v("(evt."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("target")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("result")]),s._v(")\n\t}\n\treader."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readAsBinaryString")]),s._v("(file)\n}\n")])]),a("p",[s._v("上面的 FileUpload() 函数创建了一个“加载中”指示器，用于显示进度信息，然后创建了一个 XMLHttpRequest 来处理上传数据。")]),a("p",[s._v("实际传输数据前，采取了几道准备步骤：")]),a("ol",[a("li",[a("p",[s._v("XMLHttpRequest 的 progress 监听器被设为将加载指示器更新为新的百分比信息，这样随着上传进行，指示器会显示最新的信息。")])]),a("li",[a("p",[s._v("XMLHttpRequest 的 load 事件监听器被设为将加载指示器的进度信息更新为 100%，以保证进度显示确实达到了 100%（以防在上传过程中出现粒度误差）。然后它移除了已经不再需要的加载指示器。这样上传一完成指示器就会消失。")])]),a("li",[a("p",[s._v("上传图像文件的请求，是由调用 XMLHttpRequest 的 open()函数发送 POST 请求完成的")])]),a("li",[a("p",[s._v("上传的 MIME 类型是通过调用 XMLHttpRequest 的 overrideMimeType()函数来设置的。这个例子中，我们使用通用 MIME 类型。是否需要设置 MIME 类型取决于你的具体使用情况")])]),a("li",[a("p",[s._v("FileReader 对象用于将文件转换为二进制字符串")])]),a("li",[a("p",[s._v("最后，当内容被加载时，会调用 XMLHttpRequest 的 send()函数来上传文件内容。")]),a("blockquote",[a("p",[s._v("提示：上面例子中使用的非标准的 sendAsBinary 方法在 Gecko 31 (Firefox 31 / Thunderbird 31 / SeaMonkey 2.28) 中已废弃。请使用标准的 send(Blob data)方法代替。")])])])]),a("h3",[s._v("异步处理文件上传")]),a("p",[s._v("这个例子演示了如何异步上传文件，在服务器端使用了 php、在客户端使用了 JavaScript。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("<?php\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("isset")]),s._v("($_FILES["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'myFile'")]),s._v("])) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Example:")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("move_uploaded_file")]),s._v("($_FILES["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'myFile'")]),s._v("]["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'tmp_name'")]),s._v("], "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"uploads/"')]),s._v(" . $_FILES["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'myFile'")]),s._v("]["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'name'")]),s._v("]);\n    exit;\n}\n?><!"),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("DOCTYPE")]),s._v(' html>\n<html>\n<head>\n    <title>dnd binary upload</title>\n    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\n    <script type="application/javascript">\n        function sendFile(file) {\n            const uri = "/index.php";\n            const xhr = new XMLHttpRequest();\n            const fd = new FormData();\n\n            xhr.open("POST", uri, true);\n            xhr.onreadystatechange = function() {\n                if (xhr.readyState == 4 && xhr.status == 200) {\n                    alert(xhr.responseText); // handle response.\n                }\n            };\n            fd.append(\'myFile\', file);\n            // Initiate a multipart/form-data upload\n            xhr.send(fd);\n        }\n\n        window.onload = function() {\n            const dropzone = document.getElementById("dropzone");\n            dropzone.ondragover = dropzone.ondragenter = function(event) {\n                event.stopPropagation();\n                event.preventDefault();\n            }\n\n            dropzone.ondrop = function(event) {\n                event.stopPropagation();\n                event.preventDefault();\n\n                const filesArray = event.dataTransfer.files;\n                for (let i=0; i<filesArray.length; i++) {\n                    sendFile(filesArray[i]);\n                }\n            }\n        }\n    <\/script>\n</head>\n<body>\n    <div>\n        <div id="dropzone" style="margin:30px; width:500px; height:300px; border:1px dotted grey;">Drag & drop your file here...</div>\n    </div>\n</body>\n</html>\n\n')])]),a("h3",[s._v("例子：用对象 URL 显示 PDF")]),a("p",[s._v("对象 URL 可以用于 image 之外的其它东西！它可以用于显示嵌入的 PDF 文件或任何其它浏览器能显示的资源。")]),a("p",[s._v("在 Firefox 中，要让 PDF 嵌入式地显示在 iframe 中（而不是作为下载的文件弹出），必须将 pdfjs.disabled 设为 false")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("iframe")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"viewer\n')])])])]),a("p",[s._v("这是 src 属性的改动：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj_url = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createObjectURL")]),s._v("(blob)\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" iframe = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'viewer'")]),s._v(")\niframe."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setAttribute")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'src'")]),s._v(", obj_url)\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("revokeObjectURL")]),s._v("(obj_url)\n")])]),a("h2",[s._v("例子：将对象 URL 用于其它文件类型")]),a("p",[s._v("你可以用同样方式操作其它格式的文件。这是预览上传的视频的方法：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" video = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'video'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj_url = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createObjectURL")]),s._v("(blob)\nvideo."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = obj_url\nvideo."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("play")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("revokeObjectURL")]),s._v("(obj_url)\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"40cc":function(s,t,a){"use strict";a("2534")},"41f9":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("关于 css 的相关知识")]),a("p",[s._v("收集一些 css 相关的东西")]),a("h4",[s._v("css flex: 1; 是哪几个属性的组合写法")]),a("p",[s._v("flex 属性是 flex-grow, flex-shrink 和 flex-basis 的简写，默认值为 0 1 auto。 该属性有两个快捷值：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-css"}},[a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("flex")]),s._v(": auto; //"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("flex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" auto;\n"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("flex")]),s._v(": none; //"),a("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("flex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(" auto;\n")])]),a("h4",[s._v("Element.getBoundingClientRect()")]),a("p",[s._v("Element.getBoundingClientRect() 方法返回元素的大小及其相对于视口的位置。")]),a("p",[s._v("如果是标准盒子模型，元素的尺寸等于 width/height + padding + border-width 的总和。如果 box-sizing: border-box，元素的的尺寸等于 width/height")]),a("p",[s._v("domRect = element.getBoundingClientRect()")]),a("h4",[s._v("页面导入样式时，使用l ink 和 @import 有什么区别？")]),a("ul",[a("li",[a("p",[s._v("link是属于html的标签，除了加载css外，还能够用于定义rss，定义rel连接属性等作用；")])]),a("li",[a("p",[s._v("@import是css提供的，只能用于加载css； 页面被加载的时候，link会同时被加载，而@import应用的css会等到页面完全被加载后再去加载；")])])]),a("p",[s._v("import是css2.1提出的，只会在ie5以上才能够被识别，而link是XHTML的标签，没有任何兼容问题；")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},4368:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_21-27-17.15f89e2e.png"},"440a":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("JavaScript 设计模式之状态模式")]),a("h2",[s._v("定义")]),a("p",[s._v("允许一个对象在其内部状态改变时来改变它的行为，对象看起来似乎修改了它的类。在状态模式中，我们把状态封装成独立的类，并将请求委托给当前的状态对象，所以当对象内部的状态改变时，对象会有不同的行为。状态模式的关键就是区分对象的内部状态。")]),a("h2",[s._v("电灯程序")]),a("p",[s._v("我们来想象这样一个场景:有一个电灯，电灯上面只有一个开关。当电灯开着的时候，此时按下开关，电灯会切换到关闭状态;再按一次开关，电灯又将被打开。同一个开关按钮，在不同的状态下，表现出来的行为是不一样的。")]),a("h3",[s._v("先实现一个不用状态模式的电灯程序")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("construct")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'off'")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个button负责控制电灯的开关")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("init")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" button = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(button)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开关'")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("()\n\t\t}\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'off'")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开灯'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'on'")]),s._v("\n\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'on'")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关灯'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'off'")]),s._v("\n\t\t}\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" light = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v("()\nlight."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("init")]),s._v("()\n")])]),a("p",[s._v("上面代码实现了一个强壮的状态机，看起来这段代码设计得无懈可击了，这个程序没有任何 Bug。")]),a("p",[s._v("比较可惜的是，世界上的电灯并非都只有开关两种状态，一些酒店里的电灯只有一个开关，但是它的表现是：第一次按下打开弱光，第二次按下打开强光，第三次才是关闭电灯。于是，我们需要修改前面的代码：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("buttonWasPressed () {\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'off'")]),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'弱光'")]),s._v(")\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'weakLight'")]),s._v("\n    } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'weakLight'")]),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'强光'")]),s._v(")\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'strongLight'")]),s._v("\n    } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'strongLight'")]),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关灯'")]),s._v(")\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'off'")]),s._v("\n  }\n")])]),a("p",[s._v("现在我们来总结下上面的程序的缺点：")]),a("ul",[a("li",[s._v("首先，buttonWasPressed 方法违反开放-封闭原则，每次新增或者修改 light 的状态就需要修改该方法中的代码。")]),a("li",[s._v("所有跟状态相关的代码都封装在 buttonWasPressed 方法，导致这个方法会因为持续的加需求而膨胀到难以维护的地步。特别是在实际的开发中，每个状态可能要处理的逻辑比例子中的多很多。")]),a("li",[s._v("状态切换不明显，仅仅只是一句 this.state = 'off'的赋值，这样的代码很容易被遗漏掉，要想了解电灯的所有状态，我们必须深入到代码内部，耐心读完 buttonWasPressed 方法。")]),a("li",[s._v("状态之间切换，是通过 if-else 语句来实现，增加或者修改一个状态可能需要改变若干个操作，这将使得 buttonWasPressed 方法更加难以维护。")])]),a("h3",[s._v("使用状态模式来改进电灯程序")]),a("p",[s._v("首先我们先确定电灯的状态种类，然后把它们封装成单独的类，封装一般是封装对象的行为，而不是对象的状态。但是在状态模式中，关键的就是把每种状态封装成单独的类，跟状态相关的行为都封装在类的内部。从之前的代码得知，电灯有三种状态： OffLightState、WeakLightState、StrongLightState。首先编写状态类：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("OffLightState")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("construct")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("light")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v(" = light\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'弱光'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("weakLightState")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("WeakLightState")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("construct")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("light")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v(" = light\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'强光'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strongLightState")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("StrongLightState")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("construct")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("light")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v(" = light\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关灯'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offLightState")]),s._v(")\n\t}\n}\n")])]),a("p",[s._v("接下来编写 Light 类，我们不再需要一个字符串来记录当前的状态，而是使用更加立体化的状态对象，在初始化 Light 类的时候就为每一个 state 类创建一个状态对象：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("construct")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offLightState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("OffLightState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("weakLightState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("WeakLightState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("strongLightState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("StrongLightState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offLightState")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 初始化电灯状态")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("init")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" button = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(button)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开关'")]),s._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("()\n\t\t}\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("newState")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = newState\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" light = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v("()\nlight."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("init")]),s._v("()\n")])]),a("p",[s._v("通过使用状态模式重构之后，我们看到程序有很多优点：")]),a("ul",[a("li",[s._v("每种状态和它对应的行为之间的关系局部化，这些行为被分散在各个对象的状态类之中，便于阅读和管理。")]),a("li",[s._v("状态之间的切换逻辑分布在状态类内部，这使得我们无需编写 if-else 语句来控制状态直接的切换。")]),a("li",[s._v("当我们需要为 Light 类增加一种新的状态时，只需要增加一个新的状态类，再稍微改变一下现有的代码。")])]),a("h3",[s._v("缺少抽象类的变通方式")]),a("p",[s._v("在状态模式中，Light 类被称为上下文（Context）。Context 持有所有状态对象的引用 ，以便把请求委托给状态对象。在上面的例子中，请求最后委托到的是状态类的 buttonWasPressed 方法，所以所有的状态类都必须实现 buttonWasPressed 方法。")]),a("p",[s._v("在 Java 中，所有的状态类必须继承自一个 State 抽象类，从而保证所有的状态子类都实现 buttonWasPressed 方法。遗憾的是，在 JavaScript 中没有抽象类，也没有接口的概念。我们可以编写一个状态类，然后实现 buttonWasPressed 方法，在函数体中抛出错误，如果继承它的子类没有实现 buttonWasPressed 方法就会在状态切换时抛出异常，这样至少在程序运行期间就可以发现错误，下面优化上面的代码：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("State")]),s._v(" {\n  buttonWasPressed () {\n    "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'父类的buttonWasPressed必须被重写'")]),s._v(")\n  }\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("OffLightState")]),s._v(" extend "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("State")]),s._v(" {\n  construct (light) {\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v(" = light\n  }\n\n  buttonWasPressed () {\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'弱光'")]),s._v(")\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setState")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("weakLightState")]),s._v(")\n  }\n}\n\n")])]),a("h3",[s._v("状态模式中的性能优化点")]),a("p",[s._v("在上面的例子，从性能方面考虑，还有一些可以优化的点：")]),a("ul",[a("li",[a("p",[s._v("有两种方式可以选择来管理 state 对象的创建和销毁。第一种是当 state 对象被需要的时候才创建并随后销毁；另一种是一开始就创建好所有的状态对象，并且始终不销毁它们。如果 state 对象比较大，可以用第一种方式来节省内存。如果状态改变很频繁，则最好是将 state 对象都创建出来，也没有必要销毁它们。")])]),a("li",[a("p",[s._v("我们为每个 Context 对象都创建了一组 state 对象，实际上这些 state 对象之间是可以共享的，各个 Context 对象可以共享一个 state 对象，这也是享元模式的应用场景之一。")])])]),a("h2",[s._v("状态模式 VS 策略模式")]),a("p",[s._v("状态模式和策略模式像一对双胞胎，它们都封装了一系列的算法或者行为，他们的类图看起来几乎一模一样，但是从意图上看它们有很大不同。")]),a("p",[s._v("它们的相同点是，都有一个上下文、一些策略类或者状态类，上下文把请求委托给这些类来执行。它们之间的区别是策略模式中的各个策略类之间是平等又平行的，它们之间没有任何关系，所以客户必须熟知这些策略类的作用，以便客户自己可以随时主动切换算法。但是在状态模式中，状态和状态对应的行为早已被封装好，状态之间的切换也早就被规定，“改变行为”这件事发生在状态模式的内部，对于客户来说，不需要了解这些细节。")]),a("h2",[s._v("JavaScript 版本的状态机")]),a("p",[s._v("上面我们使用的是传统的面向对象的方式实现状态模式，在 JavaScript 中，没有规定状态对象一定要从类中创建而来。另外，JavaScript 可以非常方便利用委托技术，不需要事先让一个对象持有另一个对象，我们可以通过 Function.prototype.call 方法直接把请求委托给某个对象字面来执行。下面看下实现的代码：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("off")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("buttonWasPressed")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关灯'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("on")]),s._v("\n\t\t}\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("on")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("buttonWasPressed")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开灯'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("off")]),s._v("\n\t\t}\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("off")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 设置初始状态")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("init")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" self = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(button)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开关'")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tself."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("buttonWasPressed")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(self) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 把请求委托给状态机FSM")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" light = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v("()\nlight."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("init")]),s._v("()\n")])]),a("p",[s._v("我们还可以使用闭包来编写这个例子，我们需要实现一个 delegate 函数：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" delegate = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("client, delegation")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("buttonWasPressed")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将客户的请求委托给delegation对象")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" delegation."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("buttonWasPressed")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("(client, "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t}\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("off")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("buttonWasPressed")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'关灯'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("on")]),s._v("\n\t\t}\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("on")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("buttonWasPressed")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开灯'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("off")]),s._v("\n\t\t}\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("delegate")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("off")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("delegate")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-variable constant_"}},[s._v("FSM")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("on")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offState")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 设置初始状态")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Light")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("init")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" self = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(button)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("innerHTML")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'开关'")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("button")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tself."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("currentState")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("buttonWasPressed")]),s._v("()\n\t}\n}\n")])]),a("h2",[s._v("总结")]),a("p",[s._v("在文章中，我们通过各种方式来实现状态模式，并且对比了使用状态模式前后程序的优缺点，从中我们也可以得出状态模式的优点和缺点。它的优点如下：")]),a("ul",[a("li",[s._v("状态模式定义了状态和行为之间的关系，并它们封装在一个类里，使得添加新的状态和状态间的切换更容易。")]),a("li",[s._v("避免了 Context 无限膨胀，状态切换的逻辑分布在状态类中，也避免了大量的 if-else 语句。")]),a("li",[s._v("用对象代替字符串来记录当前状态，使得状态的切换更加一目了然。")]),a("li",[s._v("Context 中的请求动作和状态类中封装的行为相互独立切互不影响，也使得修改更加容易。")])]),a("p",[s._v("状态模式的缺点：第一，我们需要在系统中定义许多状态类，编写很多的状态类是一项枯燥泛味的工作，这样也会导致系统中增加很多对象。第二，因为逻辑分散中状态类中，虽然避开了不受欢迎的条件语句，但也造成了逻辑分散的问题，我们无法在一个地方就看清整个状态机的逻辑。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},4446:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h2",[s._v("浏览器缓存")]),r("p",[r("a",{attrs:{href:"https://juejin.cn/post/6844903655619969038#heading-0"}},[s._v("参考 稀土掘金 谢小飞")])]),r("p",[s._v("Http 缓存可以分为两大类，强制缓存（也称强缓存）和协商缓存。两类缓存规则不同，强制缓存在缓存数据未失效的情况下，不需要再和服务器发生交互；而协商缓存，顾名思义，需要进行比较判断是否可以使用缓存。    两类缓存规则可以同时存在，强制缓存优先级高于协商缓存，也就是说，当执行强制缓存的规则时，如果缓存生效，直接使用缓存，不再执行协商缓存规则。")]),r("h2",[s._v("Http 简介")]),r("p",[s._v("浏览器和服务器之间通信是通过 HTTP 协议，HTTP 协议永远都是客户端发起请求，服务器回送响应。模型如下：")]),r("p",[r("img",{attrs:{src:a("147e"),alt:"浏览器请求"}})]),r("p",[s._v("HTTP 报文就是浏览器和服务器间通信时发送及响应的数据块。浏览器向服务器请求数据，发送请求(request)报文；服务器向浏览器返回数据，返回响应(response)报文。报文信息主要分为两部分：")]),r("ul",[r("li",[s._v("报文头部：一些附加信息（cookie，缓存信息等），与缓存相关的规则信息，均包含在头部中")]),r("li",[s._v("数据主体部分：HTTP 请求真正想要传输的数据内容")])]),r("p",[s._v("本文用到的一些报文头如下：")]),r("table",[r("thead",[r("tr",[r("th",[s._v("字段名称")]),r("th",[s._v("字段所属")])])]),r("tbody",[r("tr",[r("td",[s._v("Pragma")]),r("td",[s._v("通用头")])]),r("tr",[r("td",[s._v("Expires")]),r("td",[s._v("响应头")])]),r("tr",[r("td",[s._v("Cache-Control")]),r("td",[s._v("通用头")])]),r("tr",[r("td",[s._v("Last-Modified")]),r("td",[s._v("响应头")])]),r("tr",[r("td",[s._v("If-Modified-Sice")]),r("td",[s._v("请求头")])]),r("tr",[r("td",[s._v("ETag")]),r("td",[s._v("响应头")])]),r("tr",[r("td",[s._v("If-None-Match")]),r("td",[s._v("请求头")])])])]),r("h2",[s._v("准备工作")]),r("p",[s._v("本地搭建一个 express 服务 目录如下")]),r("p",[r("img",{attrs:{src:a("4ea6"),alt:"目录"}})]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//demo.js")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'demo'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3333")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("321321")]),s._v(")\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// index.jd")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" express = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'express'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" app = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("express")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" port = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3000")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fs = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fs'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" path = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'path'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" moment = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'moment'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" md5 = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'md5'")]),s._v(")\n\napp."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") =>")]),s._v(" {\n\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("send")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('`<!DOCTYPE html>\n    <html lang="en">\n    <head>\n        <title>Document</title>\n    </head>\n    <body>\n        Http Cache Demo\n        <script src="/demo.js"><\/script>\n    </body>\n    </html>`')]),s._v(")\n})\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" time = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\napp."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/demo.js'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" jsPath = path."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("(__dirname, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'../src/demo.js'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cont = fs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readFileSync")]),s._v("(jsPath)\n\ttime = time + "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'---------------'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`请求第"),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${time}")]),s._v("次`")]),s._v(")\n\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("(cont)\n})\n\napp."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("listen")]),s._v("(port, "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`listen on "),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${port}")]),s._v("`")]),s._v(")\n})\n")])]),r("p",[s._v("浏览器输入"),r("code",{pre:!0},[s._v("http://localhost:3000/")]),s._v(" 请求 demo.js 过程如下：")]),r("ul",[r("li",[r("p",[s._v("浏览器发起请求静态资源 demo.js")])]),r("li",[r("p",[s._v("服务器读取磁盘文件 demo.js，返给浏览器")])]),r("li",[r("p",[s._v("浏览器再次请求，服务器又重新读取磁盘文件 a.js，返给浏览器。")])]),r("li",[r("p",[s._v("循环请求。。 看得出来这种请求方式的流量与请求次数有关，同时，缺点也很明显：")])]),r("li",[r("p",[s._v("浪费用户流量")])]),r("li",[r("p",[s._v("浪费服务器资源，服务器要读磁盘文件，然后发送文件到浏览器")])]),r("li",[r("p",[s._v("浏览器要等待 js 下载并且执行后才能渲染页面，影响用户体验")])])]),r("h2",[s._v("Http 缓存的分类")]),r("p",[s._v("Http 缓存可以分为两大类，强制缓存（也称强缓存）和协商缓存。两类缓存规则不同，强制缓存在缓存数据未失效的情况下，不需要再和服务器发生交互；而协商缓存，顾名思义，需要进行比较判断是否可以使用缓存。")]),r("p",[s._v("两类缓存规则可以同时存在，强制缓存优先级高于协商缓存，也就是说，当执行强制缓存的规则时，如果缓存生效，直接使用缓存，不再执行协商缓存规则。")]),r("h3",[s._v("强制缓存")]),r("p",[s._v("强制缓存分为两种情况，Expires 和 Cache-Control")]),r("h4",[s._v("Expires")]),r("p",[s._v("Expires 的值是服务器告诉浏览器的缓存过期时间（值为 GMT 时间，即格林尼治时间），即下一次请求时，如果浏览器端的当前时间还没有到达过期时间，则直接使用缓存数据。下面通过我们的 Express 服务器来设置一下 Expires 响应头信息")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//其他代码...")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" moment = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'moment'")]),s._v(")\n\napp."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/demo.js'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" jsPath = path."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("(__dirname, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'../src/demo.js'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cont = fs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readFileSync")]),s._v("(jsPath)\n\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setHeader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Expires'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getGLNZ")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//2分钟")]),s._v("\n\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("(cont)\n})\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getGLNZ")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("moment")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("utc")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("add")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'m'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("format")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ddd, DD MMM YYYY HH:mm:ss'")]),s._v(") + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' GMT'")]),s._v("\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//其他代码...")]),s._v("\n")])]),r("p",[s._v("我们在 demo.js 中添加了一个 Expires 响应头，不过由于是格林尼治时间，所以通过 momentjs 转换一下。第一次请求的时候还是会向服务器发起请求，同时会把过期时间和文件一起返回给我们；但是当我们刷新的时候，才是见证奇迹的时刻： "),r("img",{attrs:{src:a("7e98"),alt:"缓存"}}),r("img",{attrs:{src:a("5369"),alt:"缓存"}})]),r("p",[s._v("可以看出文件是直接从缓存（memory cache）中读取的，并没有发起请求。我们在这边设置过期时间为两分钟，两分钟过后可以刷新一下页面看到浏览器再次发送请求了")]),r("p",[s._v("虽然这种方式添加了缓存控制，节省流量，但是还是有以下几个问题的：")]),r("ul",[r("li",[s._v("由于浏览器时间和服务器时间不同步，如果浏览器设置了一个很后的时间，过期时间一直没有用")]),r("li",[s._v("缓存过期后，不管文件有没有发生变化，服务器都会再次读取文件返回给浏览器")])]),r("blockquote",[r("p",[s._v("不过 Expires 是 HTTP 1.0 的东西，现在默认浏览器均默认使用 HTTP 1.1，所以它的作用基本忽略。")])]),r("h4",[s._v("Cache-Control")]),r("p",[s._v("针对浏览器和服务器时间不同步，加入了新的缓存方案；这次服务器不是直接告诉浏览器过期时间，而是告诉一个相对时间 Cache-Control=10 秒，意思是 10 秒内，直接使用浏览器缓存。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("app."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/demo.js'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" jsPath = path."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("(__dirname, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'../src/demo.js'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cont = fs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readFileSync")]),s._v("(jsPath)\n\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setHeader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Cache-Control'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'public,max-age=120'")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//2分钟")]),s._v("\n\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("(cont)\n})\n")])]),r("p",[s._v("在这 120 内请求 demo.js 都是缓存 "),r("img",{attrs:{src:a("1ef9"),alt:"Cache-Control"}}),r("img",{attrs:{src:a("7e98"),alt:"缓存"}})]),r("h3",[s._v("协商缓存")]),r("p",[s._v("强制缓存的弊端很明显，即每次都是根据时间来判断缓存是否过期；但是当到达过期时间后，如果文件没有改动，再次去获取文件就有点浪费服务器的资源了。协商缓存有两组报文结合使用：")]),r("ul",[r("li",[s._v("Last-Modified 和 If-Modified-Since")]),r("li",[s._v("ETag 和 If-None-Match")])]),r("h4",[s._v("Last-Modified")]),r("p",[s._v("为了节省服务器的资源，再次改进方案。浏览器和服务器协商，服务器每次返回文件的同时，告诉浏览器文件在服务器上最近的修改时间。请求过程如下：")]),r("ul",[r("li",[r("p",[s._v("浏览器请求静态资源 demo.js")])]),r("li",[r("p",[s._v("服务器读取磁盘文件 demo.js，返给浏览器，同时带上文件上次修改时间 Last-Modified（GMT 标准格式）")])]),r("li",[r("p",[s._v("当浏览器上的缓存文件过期时，浏览器带上请求头 If-Modified-Since（等于上一次请求的 Last-Modified）请求服务器")])]),r("li",[r("p",[s._v("服务器比较请求头里的 If-Modified-Since 和文件的上次修改时间。如果果一致就继续使用本地缓存（304），如果不一致就再次返回文件内容和 Last-Modified。")])]),r("li",[r("p",[s._v("循环请求。。")]),r("blockquote",[r("p",[s._v("a.浏览器第一次请求一个资源，服务器返回了该资源时，会在 response headers 中加上 Last-Modified，这个 response headers 表示这个资源在服务器上的最后一次修改时间； b.当浏览器再次请求该资源时，会在 request headers 中加上 If-Modified-Since，这个值即为上一次服务器返回的 Last-Modified 时间；服务器再次收到资源请求时，将 If-Modified-Since 时间和资源在服务器上的最后修改时间与对比，如果 If-Modifid-Since 与最后修改时间一致，则命中缓存，服务器返回 304，浏览器从缓存中获取资源； c.若未命中缓存，服务器返回资源同时，浏览器缓存资源的 Last-Modified 会被更新。")])])])]),r("p",[s._v("代码实现过程如下：console.log(111) 第一次请求之后再刷新发现都是 304 因为文件没有改动，如果改动 demo.js 比如添加一段新的"),r("code",{pre:!0},[s._v("console.log(111)")]),s._v(" 再次请求就会发现不是 304 而是 200")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("app."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/demo.js'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" jsPath = path."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("(__dirname, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'../src/demo.js'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cont = fs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readFileSync")]),s._v("(jsPath)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" status = fs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("statSync")]),s._v("(jsPath)\n\ttime = time + "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" lastModified = status."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("mtime")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toUTCString")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'---------------'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`请求第"),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${time}")]),s._v("次`")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'lastModified'")]),s._v(", lastModified)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'if-modified-since'")]),s._v(", req."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("headers")]),s._v("["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'if-modified-since'")]),s._v("])\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'---'")]),s._v(", lastModified === req."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("headers")]),s._v("["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'if-modified-since'")]),s._v("])\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (lastModified === req."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("headers")]),s._v("["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'if-modified-since'")]),s._v("]) {\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("writeHead")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Not Modified'")]),s._v(")\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("()\n\t} "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setHeader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Last-Modified'")]),s._v(", lastModified)\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("writeHead")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'OK'")]),s._v(")\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("(cont)\n\t}\n})\n")])]),r("p",[r("img",{attrs:{src:a("efaa"),alt:"lastModified"}}),r("img",{attrs:{src:a("7149"),alt:"If-Modified-Since"}}),r("img",{attrs:{src:a("7e98"),alt:"缓存"}})]),r("p",[s._v("虽然这个方案比前面三个方案有了进一步的优化，"),r("strong",[s._v("浏览器检测文件是否有修改")]),s._v("，如果没有变化就不再发送文件；但是还是有以下缺点：")]),r("ul",[r("li",[s._v("由于 Last-Modified 修改时间是 GMT 时间，只能精确到秒，如果文件在 1 秒内有多次改动，服务器并不知道文件有改动，浏览器拿不到最新的文件")]),r("li",[s._v("如果服务器上文件被多次修改了但是内容却没有发生改变，服务器需要再次重新返回文件")])]),r("h4",[s._v("ETag")]),r("p",[s._v("为了解决文件修改时间不精确带来的问题，服务器和浏览器再次协商，这次不返回时间，返回文件的唯一标识 ETag。只有当文件内容改变时，ETag 才改变。请求过程如下：")]),r("ul",[r("li",[s._v("浏览器请求静态资源 demo.js")]),r("li",[s._v("服务器读取磁盘文件 demo.js，返给浏览器，同时带上文件的唯一标识 ETag")]),r("li",[s._v("当浏览器上的缓存文件过期时，浏览器带上请求头 If-None-Match（等于上一次请求的 ETag）请求服务器")]),r("li",[s._v("服务器比较请求头里的 If-None-Match 和文件的 ETag。如果一致就继续使用本地缓存（304），如果不一致就再次返回文件内容和 ETag。")]),r("li",[s._v("循环请求。。")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("app."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/demo.js'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("req, res")]),s._v(") =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" jsPath = path."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("(__dirname, "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'../src/demo.js'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cont = fs."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readFileSync")]),s._v("(jsPath)\n\ttime = time + "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'---------------'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`请求第"),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${time}")]),s._v("次`")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" etag = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("md5")]),s._v("(cont)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'是否相等'")]),s._v(", req."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("headers")]),s._v("["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'if-none-match'")]),s._v("] === etag)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (req."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("headers")]),s._v("["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'if-none-match'")]),s._v("] === etag) {\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("writeHead")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("304")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Not Modified'")]),s._v(")\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("()\n\t} "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setHeader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ETag'")]),s._v(", etag)\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("writeHead")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'OK'")]),s._v(")\n\t\tres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("(cont)\n\t}\n})\n")])]),r("p",[r("img",{attrs:{src:a("7bb4"),alt:"ETag"}}),r("img",{attrs:{src:a("400e"),alt:"If-None-Match"}}),r("img",{attrs:{src:a("7e98"),alt:"缓存"}})]),r("h3",[s._v("一些额外的东西")]),r("p",[s._v("在报文头的表格中我们可以看到有一个字段叫 Pragma，这是一段尘封的历史....")]),r("p",[s._v("在“遥远的”http1.0 时代，给客户端设定缓存方式可通过两个字段--Pragma 和 Expires。虽然这两个字段早可抛弃，但为了做 http 协议的向下兼容，你还是可以看到很多网站依旧会带上这两个字段。")]),r("h4",[s._v("关于 Pragma")]),r("p",[s._v("当该字段值为 no-cache 的时候，会告诉浏览器不要对该资源缓存，即每次都得向服务器发一次请求才行。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("res."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setHeader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Pragma'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'no-cache'")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//禁止缓存")]),s._v("\nres."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setHeader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Cache-Control'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'public,max-age=120'")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//2分钟")]),s._v("\n")])]),r("p",[s._v("通过 Pragma 来禁止缓存，通过 Cache-Control 设置两分钟缓存，但是重新访问我们会发现浏览器会再次发起一次请求，说明了 Pragma 的优先级高于 Cache-Control")]),r("h4",[s._v("关于 Cache-Control")]),r("p",[s._v("我们看到 Cache-Control 中有一个属性是 public，那么这代表了什么意思呢？其实 Cache-Control 不光有 max-age，它常见的取值 private、public、no-cache、max-age，no-store，默认值为 private，各个取值的含义如下：")]),r("ul",[r("li",[s._v("private: 客户端可以缓存")]),r("li",[s._v("public: 客户端和代理服务器都可缓存")]),r("li",[s._v("max-age=xxx: 缓存的内容将在 xxx 秒后失效")]),r("li",[s._v("no-cache: 需要使用对比缓存来验证缓存数据")]),r("li",[s._v("no-store: 所有内容都不会缓存，强制缓存，对比缓存都不会触发")])]),r("p",[s._v("所以我们在刷新页面的时候，如果只按 F5 只是单纯的发送请求，按 Ctrl+F5 会发现请求头上多了两个字段 Pragma: no-cache 和 Cache-Control: no-cache。")]),r("h4",[s._v("缓存的优先级")]),r("p",[s._v("上面我们说过强制缓存的优先级高于协商缓存，Pragma 的优先级高于 Cache-Control，那么其他缓存的优先级顺序怎么样呢？网上查阅了资料得出以下顺序（PS：有兴趣的童鞋可以验证一下正确性告诉我）：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("Pragma > Cache-Control > Expires > ETag > Last-Modified\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"45c1":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("JavaScript 栈堆")]),r("h2",[s._v("栈")]),r("p",[s._v("栈是限定仅在表尾进行插入和删除操作的线性表，")]),r("p",[s._v("栈的概念是弹压,就像子弹壳装弹,一粒一粒压进去,但是打出来的时候是从上面打出来的,最先压进去的最后弹出来,如果进去顺序是 123,打出来顺序是 321,这就是后进先出")]),r("p",[s._v("栈作为一种数据结构，是一种只能在一端进行插入和删除操作的特殊线性表。它按照后进先出的原则存储数据，先进入的数据被压入栈底，最后的数据在栈顶，需要读数据的时候从栈顶开始弹出数据（最后一个数据被第一个读出来）。")]),r("p",[s._v("栈是允许在同一端进行插入和删除操作的特殊线性表。允许进行插入和删除操作的一端称为栈顶(top)，另一端为栈底(bottom)；栈底固定，而栈顶浮动；栈中元素个数为零时称为空栈。插入一般称为进栈（PUSH），删除则称为退栈（POP），栈也称为后进先出表。")]),r("p",[r("img",{attrs:{src:a("5376"),alt:"栈示意图"}})]),r("h3",[s._v("基本数据结构的存储（存储栈）")]),r("p",[s._v("javaScript 中，数据类型分为基本数据类型和引用数据类型，基本数据类型包含：string、number、boolean、undefined、null、symbol、bigint 这几种。在内存中这几种数据类型存储在栈空间，我们按值访问。原型类型都存储在栈内存中，是大小固定并且有序的。")]),r("p",[r("img",{attrs:{src:a("4368"),alt:"存储栈"}})]),r("h3",[s._v("执行栈（函数调用栈）")]),r("p",[s._v("JavaScript 中如何通过栈来管理多个执行上下文")]),r("ul",[r("li",[s._v("程序执行进入一个执行环境时，它的执行上下文就会被创建，并被推入执行栈中(入栈)。")]),r("li",[s._v("程序执行完成时，它的执行上下文就会被销毁，并从栈顶被推出(出栈)，控制权交由下一个执行上下文。")])]),r("p",[s._v("JavaScript 中每一个可执行代码，在解释执行前，都会创建一个可执行上下文。按照可执行代码块可分为三种可执行上下文。")]),r("ul",[r("li",[s._v("全局可执行上下文：每一个程序都有一个全局可执行代码，并且只有一个。任何不在函数内部的代码都在全局执行上下文。")]),r("li",[s._v("函数可执行上下文：每当一个函数被调用时, 都会为该函数创建一个新的上下文。每个函数都被调用时都会创建它自己的执行上下文。")]),r("li",[s._v("Eval 可执行上下文：Eval 也有自己执行上下文。")])]),r("p",[s._v('因为 JS 执行中最先进入全局环境，所以处于"栈底的永远是全局环境的执行上下文"。而处于"栈顶的是当前正在执行函数的执行上下文"，当函数调用完成后，它就会从栈顶被推出（理想的情况下，闭包会阻止该操作，闭包后续文章深入详解）。')]),r("p",[s._v('"全局环境只有一个，对应的全局执行上下文也只有一个，只有当页面被关闭之后它才会从执行栈中被推出，否则一直存在于栈底"')]),r("p",[s._v("看个例子：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" name = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'蜗牛'")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayName")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayNameStart")]),s._v("(name)\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayNameStart")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayNameEnd")]),s._v("(name)\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayNameEnd")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(name)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("debugger")]),s._v("\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("sayName")]),s._v("(name)\n")])]),r("p",[s._v("执行 sayName 函数时，会把直接函数压如执行栈，并且会创建执行上下文，执行完毕编译器会自动释放")]),r("p",[r("img",{attrs:{src:a("e0f1"),alt:"调用栈"}})]),r("h3",[s._v("栈溢出问题")]),r("h4",[s._v("栈大小限制")]),r("p",[s._v("不同浏览器对调用栈的大小是有限制，超过将出现栈溢出的问题。下面这段代码可以检验不用浏览器对调用栈的大小限制。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("recursiveFn")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\ti++\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("recursiveFn")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("recursiveFn")]),s._v("()\n} "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (ex) {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我的最大调用栈 i = "),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${i}")]),s._v(" errorMsg = "),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${ex}")]),s._v("`")]),s._v(")\n}\n")])]),r("h4",[s._v("递归调用的栈溢出问题")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Fibonacci")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("n")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (n <= "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci")]),s._v("(n - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") + "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci")]),s._v("(n - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 89")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 超时")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 超时")]),s._v("\n")])]),r("p",[s._v("上面代码是一个阶乘函数，计算 n 的阶乘，最多需要保存 n 个调用记录，复杂度 O(n) 。如果超出限制，会出现栈溢出问题。")]),r("h4",[r("a",{attrs:{href:"https://es6.ruanyifeng.com/#docs/function#%E5%B0%BE%E8%B0%83%E7%94%A8%E4%BC%98%E5%8C%96"}},[s._v("尾递归调用优化")])]),r("p",[s._v("递归非常耗费内存，因为需要同时保存成千上百个调用帧，很容易发生“栈溢出”错误（stack overflow）。但对于尾递归来说，由于只存在一个调用帧，所以永远不会发生“栈溢出”错误。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Fibonacci2")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("n, ac1 = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", ac2 = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")])]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (n <= "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ac2\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci2")]),s._v("(n - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", ac2, ac1 + ac2)\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci2")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 573147844013817200000")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci2")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 7.0330367711422765e+208")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Fibonacci2")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10000")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Infinity")]),s._v("\n")])]),r("p",[s._v("由此可见，“尾调用优化”对递归操作意义重大，所以一些函数式编程语言将其写入了语言规格。ES6 亦是如此，第一次明确规定，所有 ECMAScript 的实现，都必须部署“尾调用优化”。这就是说，ES6 中只要使用尾递归，就不会发生栈溢出（或者层层递归造成的超时），相对节省内存。")]),r("p",[s._v("为什么这个例子里尾递归占用的栈内存也会随着参数增加呢 "),r("img",{attrs:{src:a("847a"),alt:"尾调用优化"}}),s._v(" 说好的尾递归优化只存在一个调用帧了，说好的永远不会发生“栈溢出”了。这路给大家解释一下原因。 各大浏览器（除了 safari）根本就没部署尾调用优化，直接在浏览器上的控制台上调试尾递归的代码当然还是会出现栈溢出的问题。")]),r("h2",[s._v("堆")]),r("p",[s._v("堆是向高地址扩展的数据结构，是不连续的内存区域。这是由于系统是用链表来存储的空闲内存地址的，自然是不连续的，而链表的遍历方向是由低地址向高地址。堆的大小受限于计算机系统中有效的虚拟内存。")]),r("p",[s._v("堆逻辑上可以看成是一堆空间，就像一个抽屉，可以往里面放定西（数据）。 堆，一般由操作人员（程序员）分配释放，若操作人员不分配释放，将由 OS 回收释放。分配方式类似链表。堆存储在二级缓存中。")]),r("h3",[s._v("堆内存")]),r("p",[s._v("JavaScript 的数据类型除了基本类型，还有一类是 Object 类型，它包含 Object、Function、Array、Date、RegExp")]),r("p",[s._v("Object 类型都存储在堆内存中，是大小不定，复杂可变的。"),r("strong",[s._v("Object 类型数据的 指针 存储在栈内存空间， 指针实际指向的值存储在堆内存空间")]),s._v("。 "),r("img",{attrs:{src:a("a25e"),alt:"堆内存"}})]),r("h2",[s._v("为什么会有堆内存、栈内存之分")]),r("p",[s._v("栈像个容器，容量小速度快，由系统自动分配，但程序员是无法控制的。 堆像个房间，容量较大，是由 new 分配的内存，一般速度比较慢，而且容易产生内存碎片,不过用起来最方便")]),r("h2",[s._v("队列")]),r("p",[s._v("队列遵循 FIFO，先进先出原则的一组有序集合。队列在尾部添加元素，在顶部删除元素。在现实中最常见的队列就是排队。先排队的先服务。（请大家文明排队，不要插队。） "),r("img",{attrs:{src:a("22d4"),alt:"队列"}})]),r("h3",[s._v("任务队列")]),r("p",[s._v("JavaScript 是单线程，单线程任务被分为同步任务和异步任务。同步任务在调用栈中等待主线程依次执行，异步任务会在有了结果之后，将回调函数注册到任务队列，等待主线程空闲（调用栈为空），放入执行栈等待主线程执行。")]),r("p",[s._v("Event loop 执行如下图，任务队列只是其中的一部分 "),r("img",{attrs:{src:a("6924"),alt:"Event loop"}})]),r("p",[s._v("执行栈在执行完同步任务之后，如果执行栈为空，就会去检查微任务（MicroTask）队列是否为空，如果为空的话，就会去执行宏任务队列（MacroTask）。否则就会一次性执行完所有的微任务队列。 每次一个宏任务执行完成之后，都会去检查微任务队列是否为空，如果不为空就会按照先进先出的方式执行完微任务队列。然后在执行下一个宏任务，如此循环执行。直到结束。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},4882:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h2",[s._v("如何减少 Dom 操作中的回流和重绘问题")]),a("h3",[s._v("什么是回流和重绘？")]),a("ul",[a("li",[s._v("当 render tree 中的一部分（或全部）因为元素的规模尺寸，布局，隐藏等改变而需要重新构建"),a("strong",[s._v("影响布局")]),s._v("。这就称为回流（reflow）")]),a("li",[s._v("当 render tree 中的一些"),a("strong",[s._v("元素需要更新属性")]),s._v("，而这些属性只是影响元素的外观，风格，而"),a("strong",[s._v("不会影响布局的")]),s._v("，比如 background-color，这就是重绘")])]),a("blockquote",[a("p",[s._v("在回流的时候，浏览器会使渲染树中受影响的一部分失效，并重新构造这部分渲染树，完成回流后，浏览器会重新绘制受影响的部分到屏幕中，该过程为重绘。 回流必然会引起重绘，而重绘不一定会引起回流")])]),a("h3",[s._v("常见的重绘和回流操作？")]),a("ul",[a("li",[s._v("添加、删除元素（回流+重绘）")]),a("li",[s._v("隐藏元素，display：none（回流+重绘）")]),a("li",[s._v("移除元素，比如改变 top，left（jQuery 的 animate 方法就是，该变 top，left 不一定会回流），或者移动元素到另外 1 个父元素中。（回流+重绘）")]),a("li",[s._v("对 style 的操作（对不同的属性操作，影响不一样）")]),a("li",[s._v("以下属性，只要改动他们的值，就会造成回流，这些属性包括：offsetLeft、offsetTop、offsetWidth、offsetHeight；scrollTop、scrollLeft、scrollWidth、scrollHeight；clientWidth、clientHeight、clientLeft、clientTop；")]),a("li",[s._v("还有一种是用户的操作，比如改变浏览器大小，改变浏览器的字体大小。")])]),a("h3",[s._v("如何减少回流和重绘")]),a("p",[s._v("减少回流、重绘其实就是需要减少对 render tree 的操作（"),a("strong",[s._v("合并多次 Dom 和样式的修改")]),s._v("），并减少对一下 style 信息的请求，尽量利用好浏览器的优化策略")]),a("h4",[s._v("直接改变 className，如果动态改变样式，则使用 cssText（考虑没有优化的浏览器）")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 不好的写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" left = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" top = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\nel."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("style")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("left")]),s._v(" = left + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'px'")]),s._v("\nel."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("style")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("top")]),s._v(" = top + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'px'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 比较好的写法 改变className")]),s._v("\nel."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("className")]),s._v(" += "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' className1'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 比较好的写法 改变style（样式）")]),s._v("\nel."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("style")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("cssText")]),s._v(" += "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("';left: '")]),s._v(" + left + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'px;top: '")]),s._v(" + top + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'px;'")]),s._v("\n")])]),a("h4",[s._v("让要操作的元素进行”离线处理”，处理完后一起更新")]),a("h5",[s._v("CSS中避免回流")]),a("ol",[a("li",[s._v("使用 DocumentFragment 进行缓存操作,引发一次回流和重绘；")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//不好的写法（模式中所说的反模式）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" p, t\np = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'p'")]),s._v(")\nt = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatTextNode")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fist paragraph'")]),s._v(")\np."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(t)\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(p) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//将引起一次回流")]),s._v("\np = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'p'")]),s._v(")\nt = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatTextNode")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'second paragraph'")]),s._v(")\np."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(t)\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(p) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//将再引起一次回流")]),s._v("\n")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//好的写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" p, t, frag\nfrag = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatDocumentFragment")]),s._v("()\np = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'p'")]),s._v(")\nt = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatTextNode")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fist paragraph'")]),s._v(")\np."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(t)\nfarg."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(p)\np = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatElement")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'p'")]),s._v(")\nt = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("creatTextNode")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'second paragraph'")]),s._v(")\np."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(t)\nfarg."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(p)\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(frag)\n")])]),a("p",[s._v("相比前面的方法，这里仅仅引起一次回流，倘若页面里有很多这样的操作，利用文档随便将会提升很多")]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("使用 display:none 技术，display:none上的DOM操作不会引发回流和重绘")]),a("li",[s._v("使用 cloneNode")])]),a("h4",[s._v("不要经常访问会引起浏览器 flush 队列的属性，如果你确实要访问，利用缓存")]),a("p",[s._v("例如避免循环读取 offsetLeft 等属性。在循环之前把它们存起来。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//BAD WAY")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" (循环) {\n  el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("style")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("left")]),s._v(" = el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offsetLeft")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"px"')]),s._v(";\n  el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("style")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("top")]),s._v(" = el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offsetTop")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"px"')]),s._v(";\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// good")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" left = el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offsetLeft")]),s._v(",\n  top = el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("offsetTop")]),s._v(",\n  style = el."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("style")]),s._v(";\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" (循环) {\n  left += "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(";\n  top += "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(";\n  style."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("left")]),s._v(" = left + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"px"')]),s._v(";\n  style."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("top")]),s._v(" = top + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"px"')]),s._v(";\n}\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"4b63":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-06_23-35-17.2ee99dee.png"},"4b96":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("本地搭建 Nginx 服务器启动 web 项目")]),a("p",[s._v("安装 widnow.s 版本的 nginx，首先下载 nginx 最新的版"),a("a",{attrs:{href:"https://nginx.org/en/download.html"}},[s._v("nginx")]),s._v(" 下载之后，解压到一个目录下面切换到 nginx-1.15.3 目录下，然后运行 nginx.exe(双击) 也可以使用命令行工具")]),a("p",[s._v("nginx 默认的端口是 80 端口，修改端口可在 conf\\nginx.conf 中修改")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("#keepalive_timeout  0;")]),s._v("\n    keepalive_timeout  65;\n\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("#gzip  on;")]),s._v("\n\n    server {\n        listen       80//8090;//侦听80端口，可修改为任意没有占用的端口，比如8090\n        server_name  localhost;\n\n        "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("#charset koi8-r;")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("#access_log  logs/host.access.log  main;")]),s._v("\n默认主页目录在nginx安装目录的html子目录\n        location / {\n            root   html;\n            index  index.html index.htm;\n        }\n")])]),a("p",[s._v("在 nginx 目录下的 html 目录下面，删除改目录下的 html 文件。添加自己的 html 文件 或者修改 root 的为打包好的文件路径")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"4d4c":function(s,t,a){s.exports=a.p+"img/gitHooksScreenshot.d1039db4.png"},"4ea6":function(s,t,a){s.exports=a.p+"img/1-18_15-26-04.1542d08c.png"},"4f95":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("异步加载图片")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("imgLoad")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("url")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" request = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("XMLHttpRequest")]),s._v("()\n\t\trequest."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("open")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'GET'")]),s._v(", url)\n\t\trequest."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("responseType")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'blob'")]),s._v("\n\t\trequest."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (request."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("status")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("(request."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("response")]),s._v(")\n\t\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Image didn\'t load successfully; error code:"')]),s._v(" + request."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("statusText")]),s._v("))\n\t\t\t}\n\t\t}\n\t\trequest."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onerror")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'There was a network error.'")]),s._v("))\n\t\t}\n\t\trequest."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("send")]),s._v("()\n\t})\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" body = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("querySelector")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'body'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myImage = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Image")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("imgLoad")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'https://p26-passport.byteacctimg.com/img/user-avatar/1035af1f1261526990c117454a5e3fab~300x300.image'")]),s._v(")."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("(\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("response")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" imageURL = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("URL")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createObjectURL")]),s._v("(response)\n\t\tmyImage."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = imageURL\n\t\tbody."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(myImage)\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("Error")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v(")\n\t}\n)\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},5191:function(s,t,a){"use strict";a.r(t);var r={common:{hello:"hello中文"}};t["default"]=r},"51a7":function(s,t,a){"use strict";a.r(t),t["default"]=[]},"52ea":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-16_22-44-24.608ef6bc.png"},5310:function(s,t,a){},5369:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_15-40-18.91650c15.png"},5376:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_21-23-18.2b35a6d3.png"},"569f":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-50-37.fe7cc7e5.png"},"56d7":function(s,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("d3b7"),a("159b");var r=a("2b0e"),e=a("5c96"),n=a.n(e),l=a("2909"),p=(a("ddb0"),a("caad"),a("2532"),a("99af"),a("ac1f"),a("466d"),a("3ca3"),a("d81d"),a("8c4f")),_=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"frame"},[a("Aside"),a("div",{ref:"rightContent",staticClass:"right-content"},[a("router-view")],1)],1)},v=[],c=a("a925"),o=a("4897"),i=a.n(o),h=a("9df6");r["default"].use(c["a"]);var j=new c["a"]({locale:"zh",fallbackLocale:"zh",messages:h["default"]});i.a.i18n((function(s,t){return j.t(s,t)}));var u=["zh"];function g(s){return j.locale=s,document.querySelector("html").setAttribute("lang",s),s}function d(s){return j.locale!==s?u.includes(s)?Promise.resolve(g(s)):a("5892")("./".concat(s)).then((function(t){return j.setLocaleMessage(s,t.default[s]),u.push(s),g(s)})):Promise.resolve(s)}var m=j,f=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"aside-container"},[a("div",{staticClass:"top-user"}),a("h2",{staticClass:"user-name"},[s._v("aken")]),a("el-button",{attrs:{type:"text"}},[s._v("文章总数："+s._s(s.totalCount.length))]),a("div",{staticClass:"catalog"},[a("el-tree",{ref:"leftTree",attrs:{data:s.asideMenu,"node-key":"fullPath","highlight-current":"","default-expand-all":"",props:s.defaultProps,"current-node-key":s.currentNodeKey,"default-expanded-keys":[s.currentNodeKey]},on:{"node-click":s.handleNodeClick}})],1)],1)},b=[],y=(a("2ca0"),{data:function(){return{defaultProps:{children:"children",label:"label"}}},computed:{asideMenu:function(){return this.$store.getters.asideMenu},totalCount:function(){var s=this.$store.getters.asideMenu.reduce((function(s,t){return t.children&&s.push.apply(s,Object(l["a"])(t.children)),s}),[]);return s},currentNodeKey:function(){return this.$route.fullPath}},methods:{handleNodeClick:function(s){if(console.log("data",s),!Array.isArray(s.children)){var t=s.fullPath||s.path;this.$router.push({path:t.startsWith("/")?t:"/".concat(t)})}}},mounted:function(){var s=this;console.log("this.currentNodeKey",this.currentNodeKey),this.$nextTick((function(){s.$refs.leftTree.setCurrentKey(s.currentNodeKey)}))}}),w=y,k=(a("40cc"),a("2877")),x=Object(k["a"])(w,f,b,!1,null,"2f3446c4",null),S=x.exports,P={data:function(){return{}},components:{Aside:S},watch:{"$route.path":{handler:function(){var s=this;this.$nextTick((function(){s.$refs["rightContent"].scroll(0,0)}))},deep:!0,immediate:!0}},methods:{testStoreModule:function(){this.$store.commit("shop/changeTime")},testStore:function(){this.$store.commit("increment"),console.log(this.$store.state.count)},too:function(){this.$router.push("/observerUse")},showMessage:function(){this.$message({message:this.$t("common.hello")})},changeLang:function(){var s=this,t="zh"==this.$i18n.locale?"en":"zh";d(t).then((function(){console.log(s.$t("common.hello"))}))}}},E=P,O=(a("3da9"),Object(k["a"])(E,_,v,!1,null,"94ec8312",null)),C=O.exports,T=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"mobile-index"},[a("el-dropdown",{staticClass:"mobile-top",attrs:{"hide-on-click":!1,size:"mini"},on:{command:s.dropdownMenuClick}},[a("span",{staticClass:"el-dropdown-link"},[s._v(" 文章列表 "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},s._l(s.mdList,(function(t){return a("el-dropdown-item",{key:t.name,attrs:{command:t.name}},[s._v(" "+s._s(t.label)+" ")])})),1)],1),a("div",{staticClass:"mobile-main"},[a("router-view")],1)],1)},R=[],N=(a("b0c0"),a("7db0"),{components:{},computed:{mdList:function(){if(this.mdTree){var s=this.mdTree.reduce((function(s,t){if(Array.isArray(t.children)){var a=t.children.map((function(s){var t=s.fileName,a=s.fullPath,r=s.label,e=s.meta,n=s.name,l=s.path,p=s.title;return{fileName:t,fullPath:a,label:r,meta:e,name:n,path:l,title:p}}));return[].concat(Object(l["a"])(s),Object(l["a"])(a))}return s}),[]);return s}return[]},mdTree:function(){return this.$store.getters.asideMenu},isIndex:function(){return"home"!==this.$route.name}},watch:{asideMenu:{handler:function(){console.log(111111,this.asideMenu),console.log(this.$route)},immediate:!0,deep:!0}},methods:{dropdownMenuClick:function(s){var t=this.mdList.find((function(t){return t.name===s}));if(t){var a=t.fullPath;this.$router.push(a)}}}}),A=N,M=(a("2d12"),Object(k["a"])(A,T,R,!1,null,"f4b2b7f4",null)),L=M.exports;r["default"].use(p["a"]);var I=a("7191"),D=[];I.keys().forEach((function(s){s.includes("index.js")||(D=D.concat(I(s).default))}));var F=!0;navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)&&(F=!1);var B=[{path:"/",component:F?C:L,redirect:{path:"/index"},meta:{title:"主页"},children:[{path:"/index",name:"home",component:function(){return a.e("home").then(a.bind(null,"f75a"))},meta:{requiresAuth:!1,title:"首页"}}].concat(Object(l["a"])(D))}];function $(s){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fullPath:"",path:""},a=s.map((function(s){return s.fullPath="".concat(t.fullPath||t.path).concat(s.path.includes("/")?"":"/").concat(s.path),Array.isArray(s["children"])&&s["children"].length>0?(s["children"]=$(s["children"],s),s):s}));return a}console.log("autoImportRoute",D);var q=p["a"].prototype.push;p["a"].prototype.push=function(s){return q.call(this,s).catch((function(s){return s}))};var U=$(B[0].children);console.log("routes",B);var J=new p["a"]({mode:"hash",routes:B}),H=a("6912"),V=(a("3e8e"),a("000c"),{install:function(s){s.mixin({created:function(){this.init&&"function"==typeof this.init&&this.init()}})}}),z=(a("3cd6"),a("5530")),W=(a("1276"),a("5319"),a("2f62"));r["default"].use(W["a"]);var G=a("c653"),K=G.keys().reduce((function(s,t){var a=t.replace(/^(\.)|(.js)/g,"").split("/")[1];return s[a]=G(t).default,s}),{}),X=new W["a"].Store({namespaced:!0,state:{count:0,menuList:U},mutations:{increment:function(s){s.count++}},getters:{asideMenu:function(s){var t=s.menuList.map((function(s){return s.label=s.meta.title,Array.isArray(s.children)&&s.children.length&&(s.children=s.children.map((function(s){return Object(z["a"])(Object(z["a"])({},s),{},{label:s.meta.title})}))),s}));return console.log("temp",t),t}},modules:Object(z["a"])({},K)}),Q=X,Y=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",[a("router-view")],1)},Z=[],ss=a("ade3"),ts={name:"App",components:{},methods:{},data:function(){return{id:"test",obj:Object(ss["a"])({},this.id,null)}},mounted:function(){}},as=ts,rs=(a("5c0b"),Object(k["a"])(as,Y,Z,!1,null,null,null)),es=rs.exports,ns=a("c00a");r["default"].component(ns["default"].name,ns["default"]);var ls=a("32e0"),ps=function(s){return s.keys().map(s)};ps(ls);a("2af9"),a("2c43"),a("e4cb");r["default"].use(n.a),H["default"].forEach((function(s){r["default"].use(s)})),r["default"].use(V),r["default"].config.productionTip=!1,new r["default"]({render:function(s){return s(es)},i18n:m,store:Q,router:J}).$mount("#app")},5892:function(s,t,a){var r={"./en":"3fab","./en.js":"3fab","./product/en":"f7f2","./product/en.js":"f7f2","./product/zh":"234e","./product/zh.js":"234e","./shop/en":"b5a1","./shop/en.js":"b5a1","./shop/zh":"5191","./shop/zh.js":"5191","./zh":"9df6","./zh.js":"9df6"};function e(s){return Promise.resolve().then((function(){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}var e=r[s];return a(e)}))}e.keys=function(){return Object.keys(r)},e.id="5892",s.exports=e},"58ab":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("路由的 props 属性")]),a("p",[s._v("一般在组件内使用路由参数，大多数人会这样做：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getParamsId")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$route")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("params")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v("\n\t\t}\n\t}\n}\n")])]),a("p",[s._v("在组件中使用 $route 会使它与路由系统形成高度耦合，从而使组件只能在使用了路由功能的项目内，或某些特定的 URL 上使用，限制了其灵活性。")]),a("blockquote",[a("p",[s._v("试想一下，如果你的组件被人拿去复用了，但是那个人并没有使用路由系统，而是通过别的方式传递 id 参数，那么他该怎么办？")])]),a("h4",[s._v("正确的做法是通过 props 解耦！")]),a("ul",[a("li",[s._v("首先，为组件定义一个叫做 id 的 prop：")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'id'")]),s._v("],\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getParamsId")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v("\n\t\t}\n\t}\n}\n")])]),a("p",[a("code",{pre:!0},[s._v("如果组件没有对应路由，那么这个id也可以通过父组件向子组件传值的方式使用。")]),a("code",{pre:!0},[s._v("如果使用了路由，可以通过路由的prop属性，传递id的值：")]),s._v(" 将路由的 props 属性设置为 true 后，组件内可通过 props 接收到 params 参数")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("VueRouter")]),s._v("({\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("routes")]),s._v(": [\n\t\t{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/user/:id'")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t\t}\n\t]\n})\n")])]),a("p",[s._v("另外，你还可以通过函数模式来返回 props")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" router = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("VueRouter")]),s._v("({\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("routes")]),s._v(": [\n\t\t{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/user/:id'")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("route")]),s._v(" =>")]),s._v(" ({\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": route."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("query")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v("\n\t\t\t})\n\t\t}\n\t]\n})\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"58ff":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h3",[s._v("@babel/preset-env 与@babel/plugin-transform-runtime 使用及场景区别")]),r("p",[s._v("@babel/preset-env 和 @babel/plugin-transform-runtime 都具有转换语法的能力， 并且都能实现按需 polyfill ,但是网上又找不到比较明确的答案， 趁这次尝试 roullp 的时候试了试")]),r("p",[s._v("如果我们什么都不做， 没有为 babel 编写参数及配置， 那 babel 并没有那么大的威力， 它什么都不会做， 正是因为各个预设插件的灵活组合、赋能， 让 babel 充满魅力， 创造奇迹")]),r("blockquote",[r("p",[s._v("初始化 yarn init -y 安装 Babel-cli @babel/preset-env")])]),r("h4",[s._v("@babel/preset-env")]),r("p",[s._v("这是一个我们很常用的预设， 几乎所有的教程和框架里都会让你配置它， 它的出现取代了 preset-es20** 系列的 babel 预设， 你再也不需要繁杂的兼容配置了。 每出一个新提案就加一个？ 太蠢了。")]),r("p",[s._v("有了它， 我们就可以拥有全部， 并且！ 它还可以做到按需加载我们需要的 polyfill。 就是这么神奇。 但是吧， 它也不是那么自动化的， 如果你要是不会配置，很有可能就没有用起它的功能")]),r("p",[s._v("不管怎么养， 首先试一下，眼见为实")]),r("p",[s._v("首先创建一个 index.js,内容如下， 很简单")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arr = ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("map")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item * item)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arr)\n")])]),r("p",[s._v("然后我们在根目录下创建一个 .babelrc 文件, 帮我们刚刚说的预设加进去")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("然后我我们打包一下（这里我用的是 roullup）看一下产出的结果 "),r("img",{attrs:{src:a("7118"),alt:""}})]),r("p",[s._v("我们可以看到， 它 babel 帮我们做了这几件事情:")]),r("ul",[r("li",[s._v("转换箭头函数")]),r("li",[s._v("const 变为 var")])]),r("p",[s._v("奇怪， 为什么 babel 不帮我们转换 map ? 还有 promise 这些也都是 es6 的特性呀")]),r("p",[s._v("嗯～，会不会是我们的目标浏览器不对， babel 觉得不需要转换了， 会不会是这样， 那我们加一个 .browserslistrc 试一下")]),r("blockquote",[r("p",[s._v(".browserslistrc 主要用来设定 babel 编译成要适配的浏览器环境的代码")])]),r("p",[s._v("那就。让我们在根目录下创建一个 .browserslistrc")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("> 1%\nlast 10 versions\nnot ie <= 8>\n")])]),r("p",[s._v("好。现在让我们再打包一次.")]),r("p",[r("img",{attrs:{src:a("0500"),alt:""}})]),r("p",[s._v("咦， 没什么效果。 跟刚刚一样啊。 说明不是目标浏览器配置的问题， 是 babel 做不了这个事。")]),r("p",[s._v("因为默认 @babel/preset-env 只会转换语法，也就是我们看到的箭头函数、const 一类。 如果进一步需要转换内置对象、实例方法，那就得用 polyfill, 这就需要你做一点配置了,")]),r("p",[s._v('这里有一个至关重要的参数 "useBuiltIns"，他是控制 @babel/preset-env 使用何种方式帮我们导入 polyfill 的核心， 它有三个值可以选')]),r("h5",[s._v("entry")]),r("p",[s._v('这是一种入口导入方式, 只要我们在打包配置入口 或者 文件入口写入 import "core-js" 这样一串代码， babel 就会替我们根据当前你所配置的目标浏览器(browserslist)来引入所需要的 polyfill 。')]),r("p",[s._v("像这样， 我们在 index.js 文件中加入试一下 core-js")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// src/index.js")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arr = ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("map")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item * item)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arr)\n")])]),r("p",[s._v("babel 配置如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("[\n  "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"presets"')]),s._v(": [\n    ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),s._v(",\n      {\n        "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"useBuiltIns"')]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"entry"')]),s._v("\n      }\n    ]\n  ]\n}\n")])]),r("p",[s._v("当前 .browserslistrc 文件(更改目标浏览器为 Chrome 是为了此处演示更直观，简洁)， 我们只要求兼容 chrome 50 版本以上即可（当下最新版本为 78）")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("Chrome > 50\n")])]),r("p",[s._v("那打包后如何呢？ "),r("img",{attrs:{src:a("b126"),alt:""}})]),r("p",[s._v('恐怖如斯啊，babel 把我们填写的 import "core-js"替换掉， 转而导入了一大片的 polyfill， 而且都是一些我没有用到的东西。')]),r("p",[s._v("那我们提升一下目标浏览器呢？ 它还会导入这么多吗？ 此时， 我们把目标浏览器调整为比较接近最新版本的 75(当下最新版本为 78)")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("// .browserslistrc\nChrome > 75\n")])]),r("p",[s._v("此刻打包后引入的 polyfill 明显少了好多。")]),r("p",[r("img",{attrs:{src:a("7c98"),alt:""}})]),r("p",[s._v("但同样是我们没用过的。 这也就是印证了上面所说的， 当 useBuiltIns 的值为 entry 时， @babel/preset-env 会按照你所设置的目标浏览器在入口处来引入所需的 polyfill, 不管你需不需要。")]),r("p",[s._v("如此，我们可以知道， useBuiltIns = entry 的优点是覆盖面积就比较广， 一股脑全部搞定， "),r("strong",[s._v("但是缺点就是打出来的包就大了多了很多没有用到的 polyfill, 并且还会污染全局")])]),r("h5",[s._v("useage")]),r("p",[s._v("这个就比较神奇了， useBuiltIns = useage 时，会参考目标浏览器（browserslist） 和 代码中所使用到的特性来按需加入 polyfill")]),r("p",[s._v("当然， 使用 useBuiltIns = useage, 还需要填写另一个参数 corejs 的版本号")]),r("blockquote",[r("p",[s._v("core-js 支持两个版本， 2 或 3， 很多新特性已经不会加入到 2 里面了， 比如: flat 等等最新的方法， 2 这个版本里面都是没有的， 所以建议大家用 3")])]),r("p",[s._v("此时的 .babelrc")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"useBuiltIns"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"usage"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("此时的 index.js")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arr = ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("map")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item * item)\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v(" = num => ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(num)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arr)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("))\n")])]),r("p",[s._v("此时的 .browserslistrc")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("> 1%\nlast 10 versions\nnot ie <= 8\n")])]),r("p",[s._v("打包后: "),r("img",{attrs:{src:a("0b13"),alt:""}})]),r("p",[s._v("nice ,够神奇， 我们用的几个新特性真的通通都加上了")]),r("p",[s._v("这种方式打包体积不大，但是如果我们排除 node_modules/目录，遇上没有经过转译的第三方包，就检测不到第三方包内部的 ‘hello‘.includes(‘h‘)这种句法，这时候我们就会遇到 bug")]),r("h5",[s._v("false")]),r("p",[s._v("剩下最后一个 useBuiltIns = false , 那就简单了， 这也是默认值 ， 使用这个值时不引入 polyfill")]),r("h4",[s._v("@babel/runtime")]),r("p",[s._v("这种方式会借助 helper function 来实现特性的兼容， 并且利用 @babel/plugin-transform-runtime 插件还能以沙箱垫片的方式防止污染全局， 并抽离公共的 helper function , 以节省代码的冗余")]),r("p",[s._v("也就是说 @babel/runtime 是一个核心， 一种实现方式， "),r("strong",[s._v("而 @babel/plugin-transform-runtime 就是一个管家， 负责更好的重复使用 @babel/runtime")])]),r("p",[s._v("@babel/plugin-transform-runtime 插件也有一个 corejs 参数需要填写")]),r("blockquote",[r("p",[s._v("版本 2 不支持内置对象 ， 但自从 Babel 7.4.0 之后，拥有了 @babel/runtime-corejs3 ， 我们可以放心使用 corejs: 3 对实例方法做支持")])]),r("p",[s._v("当前的 .babelrc")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-runtime"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("当前的 index.js")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arr = ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("map")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item * item)\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v(" = num => ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(num)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arr)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("))\n")])]),r("p",[s._v("打包后如下: "),r("img",{attrs:{src:a("fa7b"),alt:""}})]),r("p",[s._v("我们看到使用 @babel/plugin-transform-runtime 编译后的代码和之前的 @babel/preset-env 编译结果大不一样了， 它使用了帮助函数, 并且赋予了别名 ， 抽出为公共方法， 实现复用。 比如它用了 _Promise 代替了 new Promise ， 从而避免了创建全局对象")]),r("p",[s._v("上面两种方式一起用会怎么样")]),r("h4",[s._v("useage 和 @babel/runtime")]),r("p",[s._v("useage 和 @babel/runtime 同时使用的情况下比较智能， 并没有引入重复的 polyfill")]),r("blockquote",[r("p",[s._v("个人分析原因应该是： babel 的 plugin 比 prset 要先执行， 所以 preset-env 得到了 @babel/runtime 使用帮助函数包装后的代码，而 useage 又是检测代码使用哪些新特性来判断的， 所以它拿到手的只是一堆 帮助函数， 自然没有效果了")])]),r("p",[s._v("当前 index.js")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arr = ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("map")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item * item)\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v(" = num => ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(num)\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber2")]),s._v(" = num => ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("9")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(num)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arr)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("))\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber2")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("))\n")])]),r("p",[s._v("当前 .babelrc")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"useBuiltIns"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"usage"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-runtime"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("打包结果:")]),r("p",[r("img",{attrs:{src:a("f82e"),alt:""}})]),r("h4",[s._v("entry 和 @babel/runtime")]),r("p",[s._v("跟 useage 的情况不一样， entry 模式下， 在经过 @babel/runtime 处理后不但有了各种帮助函数还引入了许多 polyfill， 这就会导致打包体积无情的增大")]),r("blockquote",[r("p",[s._v('个人分析: entry 模式下遭遇到入口的 import "core-js" 及就立即替换为当前目标浏览器下所需的所有 polyfill, 所以也就跟 @babel/runtime 互不冲突了， 导致了重复引入代码的问题， 所以这两种方式千万不要一起使用， 二选一即可')])]),r("p",[s._v("实现过程如下:")]),r("p",[s._v("当前 index.js:")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" arr = ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("map")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("item")]),s._v(" =>")]),s._v(" item * item)\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v(" = num => ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(num)\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber2")]),s._v(" = num => ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("5")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("9")]),s._v("]."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(num)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arr)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("))\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasNumber2")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("))\n")])]),r("p",[s._v("当前 .babelrc")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"useBuiltIns"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"entry"')]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-runtime"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("当前 .browserslistrc 的目标版本(为了减少打包后的文件行数为又改为 chrome 了， 懂那个意思就行)")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("Chrome > 70\n")])]),r("p",[s._v("打包结果: "),r("img",{attrs:{src:"image/123132-33.png",alt:""}})]),r("h4",[s._v("总结")]),r("ol",[r("li",[s._v("@babel/preset-env 拥有根据 useBuiltIns 参数的多种 polyfill 实现，优点是覆盖面比较全（entry）， 缺点是会污染全局， 推荐在业务项目中使用")])]),r("ul",[r("li",[s._v("entry 的覆盖面积全， 但是打包体积自然就大，")]),r("li",[s._v("useage 可以按需引入 polyfill, 打包体积就小， "),r("strong",[s._v("但如果打包忽略 node_modules 时如果第三方包未转译则会出现兼容问题")])])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"useBuiltIns"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"usage"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("ol",{attrs:{start:"2"}},[r("li",[s._v("@babel/runtime 在 babel 7.4 之后大放异彩， 利用 corejs 3 也实现了各种内置对象的支持， 并且依靠 @babel/plugin-transform-runtime 的能力，沙箱垫片和代码复用， 避免帮助函数重复 inject 过多的问题， 该方式的优点是不会污染全局， 适合在类库开发中使用")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-runtime"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[r("strong",[s._v("上面 1， 2 两种方式取其一即可， 同时使用没有意义, 还可能造成重复的 polyfill 文件")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"5a6b":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-05_12-29-37.caeb2fbb.png"},"5c0b":function(s,t,a){"use strict";a("9c0c")},"5d19":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-05_17-05-52.651430f4.png"},"68cb":function(s,t,a){"use strict";a.r(t);var r=a("e017"),e=a.n(r),n=a("21a1"),l=a.n(n),p=new e.a({id:"icon-home",use:"icon-home-usage",viewBox:"0 0 1034 1024",content:'<symbol class="icon" viewBox="0 0 1034 1024" xmlns="http://www.w3.org/2000/svg" id="icon-home"><defs><style></style></defs><path d="M984.25 347.741 571.81 20.876a96 96 0 0 0-119.272 0L40.122 347.74C14.988 367.663.186 398.988.186 432.268v486.074c0 58.275 44.59 105.542 99.584 105.542h275.48a20.596 20.596 0 0 0 20.596-20.597V686.383c0-19.27 15.616-34.886 34.886-34.886H616.96c19.27 0 34.886 15.616 34.886 34.886v316.904c0 11.38 9.216 20.597 20.596 20.597H924.65c54.993 0 99.584-47.244 99.584-105.542V432.244c-.047-33.256-14.872-64.581-39.983-84.503z" /></symbol>'});l.a.add(p);t["default"]=p},6912:function(s,t,a){"use strict";a.r(t);a("d3b7"),a("159b"),a("ddb0"),a("caad"),a("2532");var r=a("f666"),e=[];r.keys().forEach((function(s){s.includes("index.js")||s.includes("element.js")||e.push(r(s).default)})),t["default"]=e},6924:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_22-07-24.3704ec29.png"},"69f8":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("正则入门")]),a("h4",[s._v("字符组")]),a("p",[s._v("顾名思义，字符组是一组字符，表示在同一位置可能出现的多种字符。语法是在方括号  [ ]  之间列出可能出现的字符。字符组支持  -  范围表示法、^  排除型字符组。")]),a("table",[a("thead",[a("tr",[a("th",[s._v("字符组")]),a("th",[s._v("含义")])])]),a("tbody",[a("tr",[a("td",[s._v("[ab]")]),a("td",[s._v("匹配 a 或 b")])]),a("tr",[a("td",[s._v("[0-9]")]),a("td",[s._v("匹配 0 或 1 或 2 ... 或 9")])]),a("tr",[a("td",[s._v("[^ab]")]),a("td",[s._v("匹配 除 a、b 任意字符")])])])]),a("h5",[s._v("对于常见 [0-9]、[a-z] 等字符组，正则表达式提供简记形式")]),a("table",[a("thead",[a("tr",[a("th",[s._v("字符组")]),a("th",[s._v("含义")])])]),a("tbody",[a("tr",[a("td",[s._v(".")]),a("td",[s._v("表示 [^\\n")])]),a("tr",[a("td",[s._v("\\d")]),a("td",[s._v("表示 [0-9]，数字字符")])]),a("tr",[a("td",[s._v("\\D")]),a("td",[s._v("表示 [^0-9]，非数字字符")])]),a("tr",[a("td",[s._v("\\w")]),a("td",[s._v("表示 [_0-9a-zA-Z]，单词字符，注意下划线")])]),a("tr",[a("td",[s._v("\\W")]),a("td",[s._v("表示 [^_0-9a-za-z]，非单词字符")])]),a("tr",[a("td",[s._v("\\s")]),a("td",[s._v("表示 [ \\t\\v\\n\\r\\f]，空白符")])]),a("tr",[a("td",[s._v("\\S")]),a("td",[s._v("表示 [^ \\t\\v\\n\\r\\f]，非空白符")])])])]),a("h4",[s._v("量词")]),a("p",[s._v("量词也称重复，可以匹配固定或非固定长度字符。其常见形式是  {m,n}，注意逗号之后绝不能有空格，表示连续出现最少 m 次，最多 n 次。")]),a("p",[s._v("量词又可分为，匹配优先量词（贪婪量词）、忽略优先量词（惰性量词）。对于不确定是否要匹配时，匹配优先量词会尝试匹配，忽略量词则选择不匹配。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" greedyRe = "),a("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\w+/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" lazyRe = "),a("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\w+?/")]),s._v("\n\ngreedyRe."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("exec")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'abc'")]),s._v(")\nlazyRe."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("exec")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'abc'")]),s._v(")\n")])]),a("table",[a("thead",[a("tr",[a("th",[s._v("匹配优先量词")]),a("th",[s._v("忽略优先量词")]),a("th",[s._v("含义")])])]),a("tbody",[a("tr",[a("td",[s._v("{m,n}")]),a("td",[s._v("{m,n}?")]),a("td",[s._v("表示至少出现 m 次，至多 n 次")])]),a("tr",[a("td",[s._v("{m,}")]),a("td",[s._v("{m,}?")]),a("td",[s._v("表示至少出现 m 次")])]),a("tr",[a("td",[s._v("{m}")]),a("td",[s._v("{m}?")]),a("td",[s._v("表示必须出现 m 次，等价 {m,m}")])]),a("tr",[a("td",[s._v("?")]),a("td",[s._v("??")]),a("td",[s._v("等价 {0,1}")])]),a("tr",[a("td",[s._v("+")]),a("td",[s._v("+?")]),a("td",[s._v("等价 {1,}")])]),a("tr",[a("td",[s._v("_")]),a("td",[s._v("_?")]),a("td",[s._v("等价 {0,}")])])])]),a("h4",[s._v("括号")]),a("p",[s._v("括号在正则中主要有三种用途：")]),a("ul",[a("li",[s._v("分组，将相关的元素归拢，构成单个元素,可通过  $数字   提取相应顺序分组")]),a("li",[s._v("多选结构，(...|...)，规定可能出现的多个子表达式；引用分组，通过  \\数字   形式引用，即反向引用")]),a("li",[s._v("存储子表达式匹配文本，供之后引用。 分组示例，将  yyyy-mm-dd  时间，替换  mm/dd/yyyy  格式。")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" re = "),a("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/(\\d{4})-(\\d{2})-(\\d{2})/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" str = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'2018-01-12'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = str."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("replace")]),s._v("(re, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'$2/$3/$1'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(result)\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// => '01/12/2018'")]),s._v("\n")])]),a("table",[a("thead",[a("tr",[a("th",[s._v("字符")]),a("th",[s._v("含义")])])]),a("tbody",[a("tr",[a("td",[s._v("(x)")]),a("td",[s._v('捕获括号。匹配 x 并且捕获匹配项。 /(foo)/  匹配且捕获  "foo bar."  中的  "foo"。被匹配的子字符串可以通过   元素[n]  中找到，或 RegExp 对象的属性  $n  中找到。会消耗性能，如果需要捕获的数组，可以使用非捕获括号')])]),a("tr",[a("td",[s._v("\\n")]),a("td",[s._v('反向引用（back reference），指向正则表达式中第 n 个括号（从左开始数）中匹配的子字符串。/apple(,)\\sorange\\1/ 匹配 "apple, orange, cherry, peach." 中的 "apple,orange,"(最后的,号)')])]),a("tr",[a("td",[s._v("(?:x)")]),a("td",[s._v("非捕获括号（non-capturing parentheses）。匹配 x 不会捕获匹配项。匹配项不能够从结果再次访问。(推荐)")])])])]),a("h4",[s._v("锚点与断言")]),a("table",[a("thead",[a("tr",[a("th",[s._v("锚点")]),a("th",[s._v("含义")])])]),a("tbody",[a("tr",[a("td",[s._v("^")]),a("td",[s._v("匹配开头，多行匹配中匹配行开头")])]),a("tr",[a("td",[s._v("$")]),a("td",[s._v("匹配结尾，多行匹配中匹配行结尾")])]),a("tr",[a("td",[s._v("\\b")]),a("td",[s._v("单词边界，\\w 与 \\W 之间位置")])]),a("tr",[a("td",[s._v("\\B")]),a("td",[s._v("非单词边界")])]),a("tr",[a("td",[s._v("(?=p)")]),a("td",[s._v("该位置后面字符要匹配 p")])]),a("tr",[a("td",[s._v("(?!p)")]),a("td",[s._v("该位置后面字符不匹配 p")])])])]),a("h4",[s._v("修饰符")]),a("table",[a("thead",[a("tr",[a("th",[s._v("修饰符")]),a("th",[s._v("含义")])])]),a("tbody",[a("tr",[a("td",[s._v("i")]),a("td",[s._v("不区分大小写匹配")])]),a("tr",[a("td",[s._v("m")]),a("td",[s._v("允许匹配多")])]),a("tr",[a("td",[s._v("g")]),a("td",[s._v("执行全局匹配")])])])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"6a6a":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-52-54.0c381fff.png"},"6b5a":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("关于 react 的相关知识")]),a("p",[s._v("收集一些react相关的东西")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"6f08":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("JavaScript Proxy 以及 Reflect")]),a("h2",[s._v("举例子")]),a("p",[s._v("如下请分别使用"),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v("和"),a("code",{pre:!0},[s._v("Proxy")]),s._v("完善下面的代码逻辑")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observe")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("obj, callback")]),s._v(") {}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observe")]),s._v("(\n\t{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'男'")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key, value")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`属性["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${key}")]),s._v("]的值被修改为["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${value}")]),s._v("]`")]),s._v(")\n\t}\n)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这段代码执行后，输出 属性[name]的值被修改为[小红]")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小红'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这段代码执行后，输出 属性[sex]的值被修改为[女]")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("sex")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'女'")]),s._v("\n")])]),a("p",[s._v("下面分别用"),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v("和"),a("code",{pre:!0},[s._v("Proxy")]),s._v("去实现上面的逻辑.")]),a("h3",[s._v("使用 Object.defineProperty")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * 请实现这个函数，使下面的代码逻辑正常运行\n * @param {*} obj 对象\n * @param {*} callback 回调函数\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observe")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("obj, callback")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" newObj = {}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("keys")]),s._v("(obj)."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(newObj, key, {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("configurable")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("enumerable")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" obj[key]\n\t\t\t},\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 当属性的值被修改时，会调用set，这时候就可以在set里面调用回调函数")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("newVal")]),s._v(") {\n\t\t\t\tobj[key] = newVal\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("callback")]),s._v("(key, newVal)\n\t\t\t}\n\t\t})\n\t})\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" newObj\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observe")]),s._v("(\n\t{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'男'")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key, value")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`属性["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${key}")]),s._v("]的值被修改为["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${value}")]),s._v("]`")]),s._v(")\n\t}\n)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这段代码执行后，输出 属性[name]的值被修改为[小红]")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小红'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这段代码执行后，输出 属性[sex]的值被修改为[女]")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'女'")]),s._v("\n")])]),a("h3",[s._v("使用 Proxy")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observe")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("obj, callback")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(obj, {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" target[key]\n\t\t},\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, value")]),s._v(") {\n\t\t\ttarget[key] = value\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("callback")]),s._v("(key, value)\n\t\t}\n\t})\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observe")]),s._v("(\n\t{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'男'")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key, value")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`属性["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${key}")]),s._v("]的值被修改为["),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${value}")]),s._v("]`")]),s._v(")\n\t}\n)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这段代码执行后，输出 属性[name]的值被修改为[小红]")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小红'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这段代码执行后，输出 属性[sex]的值被修改为[女]")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'女'")]),s._v("\n")])]),a("p",[s._v("通过上面两种不同实现方式，我们可以大概的了解到 "),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v(" 和 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 的用法，但是当给对象添加新的属性的时候，区别就出来了，比如给对象添加一个"),a("code",{pre:!0},[s._v("age")]),s._v("的属性")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加age字段")]),s._v("\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v("\n")])]),a("p",[a("strong",[s._v("使用 Object.defineProperty 无法监听到新增属性，但是使用 Proxy 是可以监听到的。对比上面两段代码可以发现有以下几点不同")])]),a("ul",[a("li",[s._v("Object.defineProperty 监听的是对象的每一个属性，而 Proxy 监听的是对象自身")]),a("li",[s._v("使用 Object.defineProperty 需要遍历对象的每一个属性，对于性能会有一定的影响")]),a("li",[s._v("Proxy 对新增的属性也能监听到，但 Object.defineProperty 无法监听到。")])]),a("h2",[s._v("初识 Proxy")]),a("p",[s._v("在 MDN 中，关于 Proxy 是这样介绍的: Proxy 对象用于定义基本操作的自定义行为（如属性查找、赋值、枚举、函数调用等）。什么意思呢？Proxy 就像一个拦截器一样，它可以在读取对象的属性，修改对象的属性，获取对象属性列表，通过 for in 循环等等操作的时候，去拦截对象上面的默认行为，然后自己去自定义这些行为，比如上面例子中的 set,我们通过拦截默认的 set,然后在自定义的 set 里面添加了回调函数的调用")]),a("blockquote",[a("p",[s._v("可以将"),a("code",{pre:!0},[s._v("Proxy")]),s._v("理解成“拦截”，在目标对象之前架设一层“拦截”，当外界对该对象的访问，都必须先通过这层拦截，正因为有了一种拦截机制，当外界的访问对象时可以对对象或者对象属性进行一些操作（过滤或改写）")])]),a("h2",[s._v("Proxy 语法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * target: 要兼容的对象，可以是一个对象，数组,函数等等\n * handler: 是一个对象，里面包含了可以监听这个对象的行为函数，比如上面例子里面的`get`与`set`\n * 同时会返回一个新的对象proxy, 为了能够触发handler里面的函数，必须要使用返回值去进行其他操作，比如修改值\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(target, handler)\n")])]),a("h2",[s._v("handler 里面的捕获器")]),a("h3",[s._v("handler.get")]),a("p",[s._v("当通过 proxy 去读取对象里面的属性的时候，会进入到 get 钩子函数里面 语法：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * target: 目标对象，即通过proxy代理的对象\n * key: 要访问的属性名称\n * receiver: receiver相当于是我们要读取的属性的this,一般情况\n *           下他就是proxy对象本身，关于receiver的作用，后文将具体讲解\n */")]),s._v("\nhandle."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(target, key, receiver)\n")])]),a("p",[s._v("示例 在工作中经常会有封装 axios 的需求，在封装过程中，也需要对请求异常进行封装，比如不同的状态码返回的异常信息是不同的，如下是一部分状态码及其提示信息:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 状态码提示信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" errorMessage = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("400")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'错误请求'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("401")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'系统未授权，请重新登录'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("403")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'拒绝访问'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("404")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'请求失败，未找到该资源'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用方式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" code = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("404")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" message = errorMessage[code]\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(message)\n")])]),a("p",[s._v("但这存在一个问题，状态码很多，不可能每一个状态码都去枚举出来，所以对于一些异常状态码，希望可以进行统一提示，如提示为系统异常，请联系管理员，这时候就可以使用 Proxy 对错误信息进行代理处理")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 状态码提示信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" errorMessage = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("400")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'错误请求'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("401")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'系统未授权，请重新登录'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("403")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'拒绝访问'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("404")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'请求失败，未找到该资源'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(errorMessage, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" value = target[key]\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" value || "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'系统异常，请联系管理员'")]),s._v("\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 错误请求")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(proxy["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("400")]),s._v("])\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 系统异常，请联系管理员")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(proxy["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v("])\n")])]),a("h3",[s._v("handler.set")]),a("p",[s._v("当通过 proxy 去为对象设置修改属性的时候，会进入到 set 钩子函数里面 语法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * target: 目标对象，即通过proxy代理的对象\n * key: 要赋值的属性名称\n * value: 目标属性要赋的新值\n * receiver: 与 get的receiver 基本一致\n */")]),s._v("\nhandle."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(target, key, value, receiver)\n")])]),a("p",[s._v("示例 某系统需要录入一系列数值用于数据统计，但是在录入数值的时候，可能录入的存在一部分异常值，对于这些异常值需要在录入的时候进行处理, 比如大于 100 的值，转换为 100, 小于 0 的值，转换为 0, 这时候就可以使用 proxy 的 set，在赋值的时候，对数据进行处理")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" numbers = []\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(numbers, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, value")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (value < "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n\t\t\tvalue = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (value > "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(") {\n\t\t\tvalue = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v("\n\t\t}\n\t\ttarget[key] = value\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 对于set 来说，如果操作成功必须返回true, 否则会被视为失败")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t}\n})\n\nproxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\nproxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("101")]),s._v(")\nproxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("(-"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("10")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 [1, 100, 0]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(numbers)\n")])]),a("p",[s._v("在使用 Vue2.0 的时候，如果给对象添加新属性的时候，往往需要调用"),a("code",{pre:!0},[s._v("$set")]),s._v(", 这是因为"),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v("只能监听已存在的属性，而新增的属性无法监听，而通过"),a("code",{pre:!0},[s._v("$set")]),s._v(" 相当于手动给对象新增了属性，然后再触发数据响应。但是对于 Vue3.0 来说，因为使用了 "),a("code",{pre:!0},[s._v("Proxy")]),s._v("， 在他的 set 钩子函数中是可以监听到新增属性的，所以就不再需要使用"),a("code",{pre:!0},[s._v("$set")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(obj, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, value")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!target."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hasOwnProperty")]),s._v("(key)) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`新增了属性"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${key}")]),s._v(",值为"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${value}")]),s._v("`")]),s._v(")\n\t\t}\n\t\ttarget[key] = value\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t}\n})\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新增 age 属性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 新增了属性age,值为18")]),s._v("\nproxy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v("\n")])]),a("h3",[s._v("handler.has")]),a("p",[s._v("当使用 "),a("code",{pre:!0},[s._v("in")]),s._v(" 判断属性是否在 "),a("code",{pre:!0},[s._v("proxy")]),s._v(" 代理对象里面时，会触发 "),a("code",{pre:!0},[s._v("has")]),s._v(" 语法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * target: 目标对象，即通过proxy代理的对象\n * key: 要判断的key是否在target中\n */")]),s._v("\nhandle."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(target, key)\n")])]),a("p",[s._v("示例 一般情况下我们在 js 中声明私有属性的时候，会将属性的名字以"),a("em",[s._v("开头，对于这些私有属性，是不需要外部调用，所以如果可以隐藏掉是最好的，这时候就可以通过 has 在判断某个属性是否在对象时，如果以")]),s._v("开头，则返回 false")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" obj = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("publicMethod")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_privateMethod")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(obj, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (key."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("startsWith")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'_'")]),s._v(")) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(target, key)\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'_privateMethod'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" proxy)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出 true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'publicMethod'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" proxy)\n")])]),a("h3",[s._v("handler.deleteProperty")]),a("p",[s._v("当使用 delete 去删除对象里面的属性的时候，会进入 "),a("code",{pre:!0},[s._v("deleteProperty")]),s._v("钩子函数 语法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n * target: 目标对象，即通过proxy代理的对象\n * key: 要删除的属性\n */")]),s._v("\nhandle."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deleteProperty")]),s._v("(target, key)\n")])]),a("p",[s._v("示例：现在有一个用户信息的对象，对于某些用户信息，只允许查看，但不能删除或者修改，对此使用 Proxy 可以对不能删除或者修改的属性进行拦截并抛出异常，如下")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" userInfo = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("height")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("187")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'男'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("age")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("22")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 只能删除用户名和age")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" readonlyKeys = ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'name'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'age'")]),s._v("]\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(userInfo, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, value")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (readonlyKeys."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(key)) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`属性"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${key}")]),s._v("不能被修改`")]),s._v(")\n\t\t}\n\t\ttarget[key] = value\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deleteProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (readonlyKeys."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("(key)) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`属性"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${key}")]),s._v("不能被删除`")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" target[key]\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t}\n})\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 报错")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" proxy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v("\n")])]),a("h3",[s._v("handler.apply")]),a("p",[s._v("当 proxy 监听的是一个函数的时候，当调用这个函数时，会进入 apply 钩子函数")]),a("h3",[s._v("handle.ownKeys")]),a("p",[s._v("当通过"),a("code",{pre:!0},[s._v("Object.getOwnPropertyNames")]),s._v(","),a("code",{pre:!0},[s._v("Object.getownPropertySymbols")]),s._v(","),a("code",{pre:!0},[s._v("Object.keys")]),s._v(","),a("code",{pre:!0},[s._v("Reflect.ownKeys")]),s._v("去获取对象的信息的时候，就会进入 ownKeys 这个钩子函数")]),a("h3",[s._v("handler.construct")]),a("p",[s._v("当使用 new 操作符的时候，会进入 construct 这个钩子函数")]),a("h3",[s._v("handler.defineProperty")]),a("p",[s._v("当使用 "),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v(" 去修改属性修饰符的时候，会进入这个钩子函数")]),a("h3",[s._v("handler.getPrototypeOf")]),a("p",[s._v("当读取对象的原型的时候，会进入这个钩子函数")]),a("h3",[s._v("handler.setPrototypeOf")]),a("p",[s._v("当设置对象的原型的时候，会进入这个钩子函数")]),a("h3",[s._v("handler.isExtensible")]),a("p",[s._v("当通过 "),a("code",{pre:!0},[s._v("Object.isExtensible")]),s._v(" 去判断对象是否可以添加新的属性的时候，进入这个钩子函数")]),a("h3",[s._v("handler.preventExtensions")]),a("p",[s._v("当通过"),a("code",{pre:!0},[s._v("Object.preventExtensions")]),s._v(" 去设置对象不可以修改新属性时候，进入这个钩子函数")]),a("h3",[s._v("handler.getOwnPropertyDescriptor")]),a("p",[s._v("在获取代理对象某个属性的属性描述时触发该操作，比如在执行 "),a("code",{pre:!0},[s._v('Object.getOwnPropertyDescriptor(proxy, "foo")')]),s._v(" 时会进入这个钩子函数")]),a("h2",[s._v("Reflect")]),a("p",[s._v("参考"),a("a",{attrs:{href:"https://juejin.cn/post/6844904090116292616#heading-6"}},[s._v("Proxy 和 Reflect")])]),a("p",[a("code",{pre:!0},[s._v("Reflect")]),s._v(" 是一个内置对象，可简化的创建 Proxy。以前的内部方法，比如"),a("code",{pre:!0},[s._v("[[Get]]")]),s._v("，"),a("code",{pre:!0},[s._v("[[Set]]")]),s._v("等等都只是规范，不能直接调用。"),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象使调用这些内部方法成为可能。它的方法是内部方法的最小包装。这是 Reflect 执行相同操作和调用的示例：")]),a("table",[a("thead",[a("tr",[a("th",[s._v("操作")]),a("th",[a("code",{pre:!0},[s._v("Reflect")]),s._v(" 调用")]),a("th",[s._v("内部方法")])])]),a("tbody",[a("tr",[a("td",[s._v("obj[prop]")]),a("td",[s._v("Reflect.get(obj, prop)")]),a("td",[s._v("[[Get]]")])]),a("tr",[a("td",[s._v("obj[prop] = value")]),a("td",[s._v("Reflect.set(obj, prop, value)")]),a("td",[s._v("[[Set]]")])]),a("tr",[a("td",[s._v("delete obj[prop]")]),a("td",[s._v("Reflect.deleteProperty(obj, prop)")]),a("td",[s._v("[[Delete]]")])]),a("tr",[a("td",[s._v("new F(value)")]),a("td",[s._v("Reflect.construct(F, value)")]),a("td",[s._v("[[Construct]]")])]),a("tr",[a("td",[s._v("...")]),a("td",[s._v("...")]),a("td",[s._v("...")])])])]),a("p",[s._v("例如：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = {}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(user, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'name'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'John'")]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(user."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// John")]),s._v("\n")])]),a("p",[s._v("对于每个可被 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 捕获的内部方法，"),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 都有一个对应的方法，其名称和参数与 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 钩子相同。")]),a("p",[s._v("因此，可以用 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 将操作转发到原始对象。")]),a("p",[s._v("在此示例中，钩子"),a("code",{pre:!0},[s._v("get")]),s._v(" 和 "),a("code",{pre:!0},[s._v("set")]),s._v(" 透明地（好像它们都不存在）将读/写操作转发到对象，并显示一条消息：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'John'")]),s._v("\n}\n\nuser = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`GET "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${prop}")]),s._v("`")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(target, prop, receiver) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (1)")]),s._v("\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, val, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`SET "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${prop}")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${val}")]),s._v("`")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(target, prop, val, receiver) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (2)")]),s._v("\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" name = user."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// shows "GET name"')]),s._v("\nuser."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Pete'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// shows "SET name=Pete"')]),s._v("\n")])]),a("p",[s._v("这里:")]),a("ul",[a("li",[a("code",{pre:!0},[s._v("Reflect.get")]),s._v(" 读取一个对象属性")]),a("li",[a("code",{pre:!0},[s._v("Reflect.set")]),s._v(" 写入对象属性，成功返回 "),a("code",{pre:!0},[s._v("true")]),s._v(" ，否则返回 "),a("code",{pre:!0},[s._v("false")])])]),a("p",[a("strong",[s._v("就是说，一切都很简单：如果钩子想要将调用转发给对象，则只需使用相同的参数调用 "),a("code",{pre:!0},[s._v("Reflect.<method>")]),s._v(" 就足够了")])]),a("h3",[s._v("使用"),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 与 "),a("code",{pre:!0},[s._v("target[prop]")]),s._v("的差别")]),a("p",[s._v("在大多数情况下，我们可以不使用 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 完成相同的事情，例如，使用 "),a("code",{pre:!0},[s._v("Reflect.get(target, prop, receiver)")]),s._v(" 读取属性可以替换为 "),a("code",{pre:!0},[s._v("target[prop]")]),s._v("。尽管有一些细微的差别。 代理一个 "),a("code",{pre:!0},[s._v("getter")]),s._v("，让我们看一个示例，说明为什么 "),a("code",{pre:!0},[s._v("Reflect.get")]),s._v(" 更好。我们还将看到为什么 get/set 有第四个参数 "),a("code",{pre:!0},[s._v("receiver")]),s._v("，而我们以前没有使用过它。")]),a("p",[s._v("一个带有一个 "),a("code",{pre:!0},[s._v("_name")]),s._v(" 属性和一个 "),a("code",{pre:!0},[s._v("getter")]),s._v(" 的对象 "),a("code",{pre:!0},[s._v("user")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("_name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Guest'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("name")]),s._v("() {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_name")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" userProxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" target[prop]\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(userProxy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Guest")]),s._v("\n")])]),a("p",[s._v("该 get 钩子在这里是“透明的”，它返回原来的属性，不会做别的任何事情。对于我们的示例而言，这就足够了。")]),a("p",[s._v("一切似乎都很好。但是让我们将示例变得更加复杂。")]),a("p",[s._v("另一个对象 "),a("code",{pre:!0},[s._v("admin")]),s._v(" 从 "),a("code",{pre:!0},[s._v("user")]),s._v(" 继承后，我们可以观察到错误的行为：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("_name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Guest'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("name")]),s._v("() {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_name")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" userProxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" target[prop] "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (*) target = user")]),s._v("\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" admin = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("__proto__")]),s._v(": userProxy,\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("_name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Admin'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Expected: Admin")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("(admin."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出：Guest （？！？）")]),s._v("\n")])]),a("p",[s._v("读取 "),a("code",{pre:!0},[s._v("admin.name")]),s._v(" 应该返回 "),a("code",{pre:!0},[s._v('"Admin"')]),s._v("，而不是 "),a("code",{pre:!0},[s._v('"Guest"')]),s._v("！ 但是，如果我们删除代理，那么一切都会按预期进行 问题实际上出在代理中，在 "),a("code",{pre:!0},[s._v("(*)")]),s._v("行。")]),a("ol",[a("li",[s._v("当我们读取 "),a("code",{pre:!0},[s._v("admin.name")]),s._v("，由于 "),a("code",{pre:!0},[s._v("admin")]),s._v(" 对象自身没有对应的的属性，搜索将转到其原型。")]),a("li",[s._v("原型是 "),a("code",{pre:!0},[s._v("userProxy")])]),a("li",[s._v("从代理读取 "),a("code",{pre:!0},[s._v("name")]),s._v(" 属性时，"),a("code",{pre:!0},[s._v("get")]),s._v(" 钩子会触发并从原始对象返回 "),a("code",{pre:!0},[s._v("target[prop]")]),s._v(" 属性，在 "),a("code",{pre:!0},[s._v("(\\*)")]),s._v("行当调用 "),a("code",{pre:!0},[s._v("target[prop]")]),s._v(" 时，若 "),a("code",{pre:!0},[s._v("prop")]),s._v(" 是一个 "),a("code",{pre:!0},[s._v("getter")]),s._v("，它将在 "),a("code",{pre:!0},[s._v("this=target")]),s._v(" 上下文中运行其代码。因此，结果是来自原始对象 "),a("code",{pre:!0},[s._v("target")]),s._v(" 的 "),a("code",{pre:!0},[s._v("this.\\_name")]),s._v(" 即来自 "),a("code",{pre:!0},[s._v("user")]),s._v("。")])]),a("p",[s._v("为了解决这种情况，我们需要 "),a("code",{pre:!0},[s._v("get")]),s._v(" 钩子的第三个参数 "),a("code",{pre:!0},[s._v("receiver")]),s._v("。它保证传递正确的 "),a("code",{pre:!0},[s._v("this")]),s._v(" 给 "),a("code",{pre:!0},[s._v("getter")]),s._v("。在我们的情况下是 "),a("code",{pre:!0},[s._v("admin")]),s._v("。如何为 "),a("code",{pre:!0},[s._v("getter")]),s._v(" 传递上下文？对于常规函数，我们可以使用 "),a("code",{pre:!0},[s._v("call/apply")]),s._v("，但这是一个 "),a("code",{pre:!0},[s._v("getter")]),s._v("，它不是“被调用”的，只是被访问的。"),a("code",{pre:!0},[s._v("Reflect.get")]),s._v(" 可以做到的。如果我们使用它，一切都会正常运行。这是更正后的变体：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("_name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Guest'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("name")]),s._v("() {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_name")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" userProxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// receiver = admin")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(target, prop, receiver) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (*)")]),s._v("\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" admin = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("__proto__")]),s._v(": userProxy,\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("_name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Admin'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(admin."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Admin")]),s._v("\n")])]),a("p",[s._v("现在 "),a("code",{pre:!0},[s._v("receiver")]),s._v("，保留了"),a("strong",[s._v("对正确 "),a("code",{pre:!0},[s._v("this")]),s._v(" 的引用（即 "),a("code",{pre:!0},[s._v("admin")]),s._v("）的引用")]),s._v("，该引用将在 "),a("code",{pre:!0},[s._v("(*)")]),s._v(" 行中使用"),a("code",{pre:!0},[s._v("Reflect.get")]),s._v("传递给"),a("code",{pre:!0},[s._v("getter")]),s._v("x 我们可以将钩子重写得更短：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(..."),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(");\n}\n")])]),a("p",[a("code",{pre:!0},[s._v("Reflect")]),s._v(" 调用的命名方式与钩子完全相同，并且接受相同的参数。它们是通过这种方式专门设计的。")]),a("p",[s._v("因此， "),a("code",{pre:!0},[s._v("return Reflect...")]),s._v(" 会提供一个安全的提示程序来转发操作，并确保我们不会忘记与此相关的任何内容。")]),a("p",[s._v("recevier 为最初被调用的对象，什么意思呢，就是谁调用的 Proxy 经过捕捉器函数那么它就是谁")]),a("h2",[s._v("Proxy 和 Reflect 的局限性")]),a("h3",[s._v("某些内置对象使用失败")]),a("p",[a("code",{pre:!0},[s._v("Proxy")]),s._v("对象用于创建一个对象的代理，从而实现基本操作的拦截和自定义（如属性查找、赋值、枚举、函数调用等）；但是"),a("code",{pre:!0},[s._v("Proxy")]),s._v("也有其的局限性 许多内置对象，例如 "),a("code",{pre:!0},[s._v("Map")]),s._v(", "),a("code",{pre:!0},[s._v("Set")]),s._v(", "),a("code",{pre:!0},[s._v("Date")]),s._v(", "),a("code",{pre:!0},[s._v("Promise")]),s._v(" 等等都使用了所谓的 “内部插槽”。 它们类似于属性，但仅限于内部使用，仅用于规范目的。例如， Map 将项目存储在 "),a("code",{pre:!0},[s._v("[[MapData]]")]),s._v("中。内置方法直接访问它们，而不通过 "),a("code",{pre:!0},[s._v("[[Get]]/[[Set]]")]),s._v(" 内部方法。所以 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 不能拦截。 在像这样的内置对象被代理后，代理对象没有这些内部插槽，因此内置方法将失败")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" map = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Map")]),s._v("()\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(map, {})\n\nproxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error")]),s._v("\n")])]),a("p",[s._v("在内部，一个 "),a("code",{pre:!0},[s._v("Map")]),s._v(" 将所有数据存储在其 "),a("code",{pre:!0},[s._v("[[MapData]]")]),s._v(" 内部插槽中。代理对象没有这样的插槽。内建方法 "),a("code",{pre:!0},[s._v("Map.prototype.set")]),s._v(" 方法试图访问内部属性 "),a("code",{pre:!0},[s._v("this.[[MapData]]")]),s._v("，但由于 "),a("code",{pre:!0},[s._v("this=proxy")]),s._v(" 在 proxy 中不能找到它，只能失败。 幸运的是，有一种解决方法：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" map = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Map")]),s._v("()\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" proxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(map, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" value = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(..."),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" value == "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(" ? value."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("(target) : value\n\t}\n})\n\nproxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(proxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(")) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1 (works!)")]),s._v("\n")])]),a("p",[s._v("现在它可以正常工作，因为 "),a("code",{pre:!0},[s._v("get")]),s._v(" 钩子将函数属性（例如 "),a("code",{pre:!0},[s._v("map.set")]),s._v("）绑定到目标对象（map）本身。与前面的示例不同，"),a("code",{pre:!0},[s._v("proxy.set(...)")]),s._v(" 内部 "),a("code",{pre:!0},[s._v("this")]),s._v(" 的值并不是 "),a("code",{pre:!0},[s._v("proxy")]),s._v("，而是原始对象 "),a("code",{pre:!0},[s._v("map")]),s._v("。因此，当 "),a("code",{pre:!0},[s._v("set")]),s._v(" 钩子的内部实现尝试访问 "),a("code",{pre:!0},[s._v("this.[[MapData]]")]),s._v(" 内部插槽时，它会成功")]),a("h3",[s._v("私有字段")]),a("p",[s._v("类的私有字段也会发生类似的情况。 例如，getName() 方法访问私有的 #name 属性并在代理后中断：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v(" {\n\t#name = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Guest'")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".#name\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v("()\n\nuser = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("(user."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error")]),s._v("\n")])]),a("p",[s._v("原因是专用字段是使用内部插槽实现的。JavaScript 访问它们时不使用 "),a("code",{pre:!0},[s._v("[[Get]]/[[Set]]")]),s._v(" 在调用 "),a("code",{pre:!0},[s._v("getName()")]),s._v(" 时 "),a("code",{pre:!0},[s._v("this")]),s._v(" 的值是代理后的 user，它没有带私有字段的插槽。")]),a("p",[s._v("再次，bind 方法的解决方案使它恢复正常：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v(" {\n\t#name = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Guest'")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".#name\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" user = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v("()\n\nuser = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" value = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(..."),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" value == "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(" ? value."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("(target) : value\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("(user."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Guest")]),s._v("\n")])]),a("blockquote",[a("p",[s._v("该解决方案有缺点，如前所述：将原始对象暴露给该方法，可能使其进一步传递并破坏其他代理功能")])]),a("h3",[s._v("Proxy != target")]),a("p",[s._v("代理跟原对象肯定是不同的对象，所以当我们使用原对象进行管理后代理却无法进行正确管理，比如下方代理做了一个所有用户实例的集中管理：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" users = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Set")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tusers."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("add")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" user = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(users."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(user))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" userProxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {})\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// false")]),s._v("\nusers."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(userProxy)\n")])]),a("p",[s._v("所以在开发中这类问题需要特别注意，在开发时假如对一个对象做代理时，对代理的所有管理也需要再进行一层代理，原对象对原对象，代理对代理，比如上方这个实例可以通过下方代码改进")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" users = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Set")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tusers."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("add")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取原对象")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getRaw")]),s._v(" = target => (target[toRaw] ? target[toRaw] : target)\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" toRaw = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Symbol")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'toRaw'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" usersProxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(users, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 注意Set size是属性，而不是方法，这个属性用到了内部插槽，")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 所以不能够使用Reflect.get(...arguments)获取")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" value = prop === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'size'")]),s._v(" ? target[prop] : "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(..."),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\n\t\tvalue = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" value === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(" ? value."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bind")]),s._v("(target) : value\n\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这里只做两个api示例，当添加或者判断一定是通过原对象判断添加，")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 因为原对象的管理只能放原对象")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (prop === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'has'")]),s._v(" || prop === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'add'")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, ...args")]),s._v(") =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("value")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getRaw")]),s._v("(target), ...args)\n\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" value\n\t\t}\n\t}\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("factoryUserProxy")]),s._v(" = user => {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" userProxy = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(user, {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, recevier")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (prop === toRaw) {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" target\n\t\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(..."),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t\t}\n\t\t}\n\t})\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" userProxy\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" user = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("User")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" userProxy = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("factoryUserProxy")]),s._v("(user)\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(users."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(user))\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(usersProxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(user))\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(usersProxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(userProxy))\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(users."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("size")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(usersProxy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("size")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 因为会转化为原对象添加，而原对象已有 所以添加不进去")]),s._v("\nusersProxy."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("add")]),s._v("(userProxy)\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(users."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("size")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(usersProxy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("size")]),s._v(")\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"70be":function(s,t,a){},7118:function(s,t,a){s.exports=a.p+"img/4654867.623bbe09.png"},7149:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_16-07-47.5fa58360.png"},7191:function(s,t,a){var r={"./cssRoute.js":"db16","./elementRoute.js":"1531","./htmlRoute.js":"c5a8","./jsRoute.js":"fbb4","./mdRoute.js":"3a03","./vueUsePage.js":"51a7"};function e(s){var t=n(s);return a(t)}function n(s){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return r[s]}e.keys=function(){return Object.keys(r)},e.resolve=n,s.exports=e,e.id="7191"},"72e3":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-19_23-37-44.51483ab0.png"},"78d9":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("vue 异步组件")]),a("p",[s._v("在大型应用中，我们可能需要将应用分割成小一些的代码块，并且只在需要的时候才从服务器加载一个模块。")]),a("p",[s._v("为了简化，Vue 允许你以一个工厂函数的方式定义你的组件，这个工厂函数会异步解析你的组件定义。Vue 只有在这个组件需要被渲染的时候才会触发该工厂函数，且会把结果缓存起来供未来重渲染。例如：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("component")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'async-example'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 向 `resolve` 回调传递组件定义")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("({\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("template")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'<div>I am async!</div>'")]),s._v("\n\t\t})\n\t}, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(")\n})\n")])]),a("p",[s._v("如你所见，这个工厂函数会收到一个 resolve 回调，这个回调函数会在你从服务器得到组件定义的时候被调用。")]),a("p",[s._v("你也可以调用 reject(reason) 来表示加载失败。这里的 setTimeout 是为了演示用的，如何获取组件取决于你自己。")]),a("p",[s._v("一个推荐的做法是将异步组件和 webpack 的 code-splitting 功能一起配合使用：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("component")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'async-webpack-example'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这个特殊的 `require` 语法将会告诉 webpack")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 自动将你的构建代码切割成多个包，这些包")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 会通过 Ajax 请求加载")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("(["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./my-async-component'")]),s._v("], resolve)\n})\n")])]),a("p",[s._v("你也可以在工厂函数中返回一个 Promise，所以把 webpack 2 和 ES2015 语法加在一起，我们可以写成这样：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("component")]),s._v("(\n\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'async-webpack-example'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这个 `import` 函数会返回一个 `Promise` 对象。")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./my-async-component'")]),s._v(")\n)\n")])]),a("p",[s._v("当使用局部注册组件的时候，你也可以直接提供一个返回 Promise 的函数：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("({\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("components")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'my-component'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./my-async-component'")]),s._v(")\n\t}\n})\n")])]),a("p",[s._v("如果你想实现异步加载组件的功能，提高首屏显示速度，那么可以使用上面例子中的定义组件的方法，也就是：箭头函数+import语句")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"7bb4":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_16-04-33.90f1b90e.png"},"7c98":function(s,t,a){s.exports=a.p+"img/6c07832d.25fb031a.png"},"7e98":function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_15-39-26.cc344f1e.png"},"7f6d":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("javascript 相关知识碎片")]),a("h2",[s._v("stage 0，1，2，3 这些阶段代表什么")]),a("p",[s._v("代表 JavaScript新增的语法的每个阶段的提案啊，es 是一个广泛公开的标准，不是谁一个人说了算的，因此要往语言里添加新特性，需要像委员会提交提案，并在社区讨论，提交提案的一方一般会自己根据提案来实现一个初级版本并通过转译来进行试用新特性。提案分阶段，越往后表示提案被接受的程度越高，受众越广，并且在通过最后一个阶段之后采纳为语言的自身特性，并由引擎自己来实现支持。并不是所有提案多会被通过，也有很多被废弃或者修改的，只有社区广泛认可的提案才会被最终采纳")]),a("p",[s._v("stage0 (https://babeljs.io/docs/en/babel-preset-stage-0) 只是一个美好激进的想法，一些 Babel 插件实现了对这些特性的支持 ，但是不确定是否会被定为标准.")]),a("p",[s._v("stage1 (https://babeljs.io/docs/en/babel-preset-stage-1) 值得被纳入标准的特性.")]),a("p",[s._v("stage2 (https://babeljs.io/docs/en/babel-preset-stage-2) 该特性规范己经被起草，将会被纳入标准里.")]),a("p",[s._v("stage3 (https://babeljs.io/docs/en/babel-preset-stage-3) 该特性规范已经定稿，大浏览器厂商和 Node.js 社区己开始着手实现.")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},8121:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("JavaScript 装饰器")]),a("h2",[s._v("前言")]),a("p",[s._v("装饰器是最新的 ECMA 中的一个提案，是一种与类（class）相关的语法，用来注释或修改类和类方法。装饰器在 Python 和 Java 等语言中也被大量使用。装饰器是实现 AOP（面向切面）编程的一种重要方式 下面是一个使用装饰器的简单例子，这个 @readonly 可以将 "),a("code",{pre:!0},[s._v("sex")]),s._v(" 属性设置为只读。可以看出来，装饰器大大提高了代码的简洁性和可读性")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Girl")]),s._v(" {\n\t@readonly sex = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'woman'")]),s._v("\n}\n")])]),a("h2",[s._v("装饰器")]),a("p",[s._v("装饰器模式是一种结构型设计模式，"),a("strong",[s._v("它允许向一个现有的对象添加新的功能，同时又不改变其结构，是作为对现有类的一个包装")]),s._v("。")]),a("p",[s._v("一般来说，在代码设计中，我们应当遵循「多用组合，少用继承」的原则。通过装饰器模式动态地给一个对象添加一些额外的职责。就增加功能来说，装饰器模式相比生成子类更为灵活。")]),a("p",[s._v("在传统面向对象语言中，如果想为一个对象创建新的功能或者属性时，往往采用继承的方式，重写某个方法")]),a("p",[s._v("举个例子:例如小学生擦黑板 但是有些个子小的小学生擦黑板前要做一些前置动作，比如他要拿个凳子垫一下脚，因为他不够高擦不到黑板，那么个子小的小学生擦黑板之前就要做拿凳子垫一下的前置动作了，以下分别使用两种方式来实现这个个子小的小学生擦黑板这个动作")]),a("p",[s._v("方式一 如果是传统的话往往采用继承的方式，重写某个方法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Student")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cleanBoard")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`我是"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("，我正在擦黑板....`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SmallStd1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("Student")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("smallStdCleanBoard")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'我个子小，先拿个凳子垫一下'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cleanBoard")]),s._v("()\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" std1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SmallStd1")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小明'")]),s._v(")\nstd1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("smallStdCleanBoard")]),s._v("()\n")])]),a("p",[s._v("方式一的做法不易后期分解移除，超类和子类之间存在强耦合性的问题，因此这种方式并不能灵活， 后期估计还要其他的前置或者后置动作，我们应当遵循「多用组合，少用继承」的原则 方式二 es7 使用装饰器")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Studdent")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cleanBoard")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".name}")]),s._v("正在擦黑板....`")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takeChair")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, descriptor")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'我个子小，先拿个凳子垫一下'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" descriptor\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SmallStd2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("Student")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(name)\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("@takeChair")]),s._v("()\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("smallStdCleanBoard")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cleanBoard")]),s._v("()\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" std2 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SmallStd2")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'小红'")]),s._v(")\nstd2."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("smallStdCleanBoard")]),s._v("()\n")])]),a("h2",[a("a",{attrs:{href:"https://github.com/tc39/proposal-decorators"}},[s._v("JavaScript 装饰器")])]),a("p",[a("a",{attrs:{href:"https://babeljs.io/docs/en/babel-plugin-proposal-decorators#docsNav"}},[s._v("@babel/plugin-proposal-decorators")])]),a("p",[s._v("装饰器是 ES2016 提出来的一个提案，当前处于 Stage 2 阶段，装饰器是一种与类相关的语法糖，用来包装或者修改类或者类的方法的行为，其实装饰器就是设计模式中装饰者模式的一种实现方式。")]),a("blockquote",[a("p",[s._v("注意：装饰器目前还处于 stage-2，意味着语法之后也许会有变动")])]),a("h3",[s._v("类装饰器")]),a("p",[s._v("装饰类的时候，装饰器方法一般会接收一个目标类作为参数")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("@decoratorClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("decoratorClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("age")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target")]),s._v(") {\n\t\ttarget."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = age\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'age'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(")\n")])]),a("p",[s._v("经过 babel 编译之后主要源码部分如下，可以很清晰得看出类装饰器是把整 个构造函数作为参数传递进装饰函数的，"),a("strong",[s._v("除了可以修改类本身，还可以通过修改原型，给实例增加新属性")]),a("strong",[s._v("利用高阶函数的属性，还可以给装饰器传参，通过参数来判断对类进行什么处理")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _dec, _"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" =\n\t((_dec = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("decoratorClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v(")),\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_dec")]),s._v("(\n\t\t(_class = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_createClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_classCallCheck")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(")\n\t\t}))\n\t) || _class)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("decoratorClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("age")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target")]),s._v(") {\n\t\ttarget."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(" = age\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'age'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'person'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("age")]),s._v(")\n")])]),a("h3",[s._v("类属性装饰器")]),a("p",[s._v("类属性装饰器可以用在类的属性、方法、get/set 函数中，一般会接收三个参数：")]),a("ul",[a("li",[s._v("target：被修饰的类")]),a("li",[s._v("name：类成员的名字")]),a("li",[s._v("descriptor：属性描述符，对象会将这个参数传给 Object.defineProperty")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t@readonly sex = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'girl'")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readonly")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") {\n\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("writable")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" person = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("sex")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'boy'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 报错")]),s._v("\n")])]),a("p",[s._v("经过 babel 编译之后主要源码部分如下，由编译之后得代码可知，当"),a("code",{pre:!0},[s._v("new Person")]),s._v("的时候 会执行函数"),a("code",{pre:!0},[s._v("_initializerDefineProperty")]),s._v("并且传递了四个参数其中包括"),a("code",{pre:!0},[s._v("property")]),s._v(" 和"),a("code",{pre:!0},[s._v("descriptor")]),s._v("，在函数"),a("code",{pre:!0},[s._v("_initializerDefineProperty")]),s._v("里面最终是使用"),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v(" 来定义属性")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _class, _descriptor\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_initializerDefineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, property, descriptor, context")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!descriptor) "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, property, {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("enumerable")]),s._v(": descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("enumerable")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("configurable")]),s._v(": descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("configurable")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("writable")]),s._v(": descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("writable")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v(" ? descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(context) : "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n\t})\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_applyDecoratedDescriptor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, property, decorators, descriptor, context")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" desc = {}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("keys")]),s._v("(descriptor)."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("key")]),s._v(") {\n\t\tdesc[key] = descriptor[key]\n\t})\n\tdesc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("enumerable")]),s._v(" = !!desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("enumerable")]),s._v("\n\tdesc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("configurable")]),s._v(" = !!desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("configurable")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'value'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" desc || desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v(") {\n\t\tdesc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("writable")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t}\n\tdesc = decorators\n\t\t."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("slice")]),s._v("()\n\t\t."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reverse")]),s._v("()\n\t\t."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reduce")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("desc, decorator")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("decorator")]),s._v("(target, property, desc) || desc\n\t\t}, desc)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (context && desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v(" !== "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n\t\tdesc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v(" ? desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(context) : "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n\t\tdesc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v("\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (desc."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initializer")]),s._v(" === "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, property, desc)\n\t\tdesc = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" desc\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" =\n\t((_class = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_createClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Person")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_classCallCheck")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_initializerDefineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sex'")]),s._v(", _descriptor, "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(")\n\t})),\n\t(_descriptor = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_applyDecoratedDescriptor")]),s._v("(_class."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sex'")]),s._v(", [readonly], {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("configurable")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("enumerable")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("writable")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("initializer")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initializer")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'girl'")]),s._v("\n\t\t}\n\t})),\n\t_class)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("readonly")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") {\n\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("writable")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n}\n")])]),a("p",[s._v("还可以用来统计一个函数的执行时间，以便于后期做一些性能优化")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("time")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" func = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" func === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("time")]),s._v("()\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" results = func."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("timeEnd")]),s._v("()\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" results\n\t\t}\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t@time\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" person = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\n")])]),a("h3",[s._v("装饰器组合")]),a("p",[s._v("装饰器是可以叠加的，排前面得装饰器限制性，由上到下，由前到后")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takeMicro")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" func = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" func === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'拿起麦克风'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" results = func."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" results\n\t\t}\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("openMouth")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" func = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" func === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张大嘴巴'")]),s._v(")\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" results = func."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" results\n\t\t}\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t@takeMicro\n\t@openMouth\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'say hello'")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" person = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 拿起麦克风")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张大嘴巴")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// say hello")]),s._v("\n")])]),a("h2",[s._v("装饰器可以做哪些有意思的事情")]),a("h3",[s._v("记录日志")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fn = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v("\n\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...rest")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`这是调用方法【"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${name}")]),s._v("】前打印的日志`")]),s._v(")\n\t\tfn."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", ...rest)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`这是调用方法【"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${name}")]),s._v("】后打印的日志`")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t@log\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\n")])]),a("h3",[s._v("节流")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("throttle")]),s._v(" = time => {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" prev = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" func = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" func === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n\t\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" now = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("()\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (now - prev >= time) {\n\t\t\t\t\tfunc."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t\t\t\tprev = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("@throttle")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" person = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\n")])]),a("h3",[s._v("防抖")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("debounce")]),s._v(" = time => {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" timer\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, descriptor")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" func = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" func === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'function'")]),s._v(") {\n\t\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (timer) "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("clearTimeout")]),s._v("(timer)\n\t\t\t\ttimer = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\t\t\tfunc."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t\t\t}, time)\n\t\t\t}\n\t\t}\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("@debounce")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hello'")]),s._v(")\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" person = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\nperson."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("say")]),s._v("()\n")])]),a("p",[s._v("其实装饰器可以做的东西还有很多，mobx，Angular，Nestjs 都已经开始使用装饰器了，大家阔以慢慢得去探究哦，")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"847a":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_21-39-57.e57cb508.png"},"84b4":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("windows 环境相关")]),a("p",[s._v("安装 Visual Studio 2017 或者 Visual Studio 2015 选择对应的环境 或者https://github.com/felixrieseberg/windows-build-tools")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install --global windows-build-tools\n// 或者\nyarn global add windows-build-tools\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"8a14":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-48-19.595f483b.png"},"8a22":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-55-48.37253065.png"},"8c80":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("使用 gitHooks 提交前校验代码")]),r("p",[s._v("在每一个使用 git 进行版本管理的仓库，都有一个目录 .git/hooks，包含 commit 各个阶段 "),r("a",{attrs:{href:"https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90"}},[s._v("Hooks")]),s._v(" 的脚本。这些 Hooks 在 git 操作 commit、push、merge 等得时候，可以做前置或者后置的操作，例如 pre-commit 在 git commit 前可以做代码校验，校验代码的时候使用的"),r("a",{attrs:{href:"https://eslint.bootcss.com/"}},[s._v("ESLint")]),s._v("，格式化使用的是 prettier。Git 支持的常用钩子见下表，更多请查看官网"),r("a",{attrs:{href:"https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90"}},[s._v("Hooks")]),s._v(":")]),r("table",[r("thead",[r("tr",[r("th",[s._v("Git Hook")]),r("th",[s._v("调用时机")]),r("th",[s._v("调用时机")])])]),r("tbody",[r("tr",[r("td",[s._v("pre-commit")]),r("td",[s._v("git commit 执行前")]),r("td",[s._v("可以用 git commit --no-verify 绕过")])]),r("tr",[r("td",[s._v("commit-msg")]),r("td",[s._v("git commit 执行前")]),r("td",[s._v("可以用 git commit --no-verify 绕过")])]),r("tr",[r("td",[s._v("pre-merge-commit")]),r("td",[s._v("git merge 执行前")]),r("td",[s._v("可以用 git merge --no-verify 绕过")])]),r("tr",[r("td",[s._v("pre-push")]),r("td",[s._v("git push 执行前")]),r("td")])])]),r("blockquote",[r("p",[s._v("本文先实践，怎么去写 pre-commit 这个 git hooks，然后介绍 husky，lint-staged，commitlint 的使用")])]),r("p",[s._v("在 git 项目中，"),r("code",{pre:!0},[s._v(".git/hooks")]),s._v("下面有很多 hooks 示例如下 "),r("img",{attrs:{src:a("9103"),alt:""}})]),r("p",[s._v("这些 git hooks 都是"),r("code",{pre:!0},[s._v(".sample")]),s._v("结尾的，如果要启某个 hooks 用可以去掉"),r("code",{pre:!0},[s._v(".sample")]),s._v("结尾")]),r("h2",[s._v("实践")]),r("p",[r("code",{pre:!0},[s._v("npm init -y")]),s._v("初始化一个项目，然后"),r("code",{pre:!0},[s._v("git init")]),s._v("，然后"),r("code",{pre:!0},[s._v("npm install eslint --save-dev")])]),r("p",[s._v("新建"),r("code",{pre:!0},[s._v(".gitignore")]),s._v("文件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("node_modules\n\n# local env files\n.env.local\n.env.*.local\n\n# Log files\nnpm-debug.log*\nyarn-debug.log*\nyarn-error.log*\n\n*-lock.json\n*.lock\n")])]),r("p",[s._v("新建"),r("code",{pre:!0},[s._v(".eslintrc")]),s._v("，配置 eslint")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"rules"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 要求使用分号")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"semi"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"always"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 强制使用一致的反勾号、双引号或单引号")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"quotes"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"double"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("新建"),r("code",{pre:!0},[s._v("src")]),s._v("目录，然后里面新建"),r("code",{pre:!0},[s._v("index.js")]),s._v("，禁止使用快捷键格式化")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(")\n")])]),r("p",[s._v("根目录新建文件夹"),r("code",{pre:!0},[s._v(".customGitHooks")]),s._v(" 然后 "),r("code",{pre:!0},[s._v("git config 'core.hooksPath' .customGitHooks")]),s._v("，主要是设置 gitHooks 的存放目录，因为 gitHooks 默认存放目录是"),r("code",{pre:!0},[s._v(".git/hooks")]),s._v("，新建"),r("code",{pre:!0},[s._v("pre-commit")]),s._v("，写入如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[r("span",{pre:!0,attrs:{class:"hljs-meta"}},[s._v("#!/bin/sh")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'start check your code，please wait...'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# git diff 获取更改的内容 可以通过参数--diff-filter 配置条件")]),s._v("\nnpx eslint $(git diff --cached --name-only --diff-filter=ACM -- "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'*.js'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# 变量$?---\x3e上一个命令的执行状态结果")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" [ $? != "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'0'")]),s._v(" ];"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("then")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ending and failed，please check your code；"')]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("exit")]),s._v(" 1\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"check pass"')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("fi")]),s._v("\n\n")])]),r("p",[s._v("这时候，执行"),r("code",{pre:!0},[s._v("git add .")]),s._v("，"),r("code",{pre:!0},[s._v("git commit -m 'test'")]),s._v("就会发现没有 commit 成功，报错了，如下图 "),r("img",{attrs:{src:a("4d4c"),alt:"报错"}}),s._v(" 如果把 index.js 的代码修改如下：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(")\n")])]),r("p",[s._v("执行"),r("code",{pre:!0},[s._v("git add .")]),s._v(" ，"),r("code",{pre:!0},[s._v("git commit -m 'test'")]),s._v("就会发现 eslint 代码检查通过了，能正常提交了，以上实践能很好解释 commit 前怎么检验代码，但是有个缺点就是别人 pull 你的代码要执行"),r("code",{pre:!0},[s._v("git config 'core.hooksPath' .customGitHooks")]),s._v("能起作用；下面就介绍 husky，lint-staged，commitlint 的使用")]),r("blockquote",[r("p",[s._v(".git 文件夹不会被跟踪并且上传至远程仓库的")])]),r("h2",[r("a",{attrs:{href:"https://typicode.github.io/husky/#/"}},[s._v("Husky")])]),r("p",[r("a",{attrs:{href:"https://github.com/typicode/husky"}},[s._v("github")]),s._v(" 为了解决"),r("code",{pre:!0},[s._v(".git")]),s._v("配置不能提交远程仓库的问题，"),r("code",{pre:!0},[s._v("husky")]),s._v(" 出来了，husky 在你"),r("code",{pre:!0},[s._v("npm i")]),s._v("安装完依赖只有自动执行"),r("code",{pre:!0},[s._v("husky install")])]),r("h3",[s._v("安装 npm install husky -D")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install husky -D\n")])]),r("h3",[s._v("使用")]),r("p",[s._v("编辑"),r("code",{pre:!0},[s._v("package.json")]),s._v("在"),r("code",{pre:!0},[s._v("script")]),s._v("里添加"),r("code",{pre:!0},[s._v("prepare")]),s._v("的值为"),r("code",{pre:!0},[s._v("husky install")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"scripts"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"prepare"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"husky install"')]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n")])]),r("p",[s._v("然后执行"),r("code",{pre:!0},[s._v("npm run prepare")]),s._v("，做了什么事呢")]),r("p",[s._v("源码"),r("code",{pre:!0},[s._v("index.ts")]),s._v("中,我们看到执行 husky install 实际上就是创建 "),r("code",{pre:!0},[s._v(".husky")]),s._v(" 目录，复制"),r("code",{pre:!0},[s._v("../husky.sh")]),s._v("文件到该目录下，配置了一个"),r("code",{pre:!0},[s._v(".gitignore")]),s._v(",设置了"),r("code",{pre:!0},[s._v("core.hooksPath")]),s._v("（设置 .husky 目录为 git hooks 目录）")]),r("h3",[s._v("添加一个 hook")]),r("p",[s._v("在"),r("code",{pre:!0},[s._v(".husky")]),s._v("目录下创建"),r("code",{pre:!0},[s._v("pre-commit")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[r("span",{pre:!0,attrs:{class:"hljs-meta"}},[s._v("#!/bin/sh")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'start check your code，please wait...'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# git diff 获取更改的内容 可以通过参数--diff-filter 配置条件")]),s._v("\nnpx eslint $(git diff --cached --name-only --diff-filter=ACM -- "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'*.js'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# 变量$?---\x3e上一个命令的执行状态结果")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" [ $? != "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'0'")]),s._v(" ];"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("then")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"ending and failed，please check your code；"')]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("exit")]),s._v(" 1\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"check pass"')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("fi")]),s._v("\n\n")])]),r("p",[r("code",{pre:!0},[s._v("index.js")]),s._v("文件内容如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(")\n")])]),r("p",[s._v("然后执行"),r("code",{pre:!0},[s._v("git add .")]),s._v("，"),r("code",{pre:!0},[s._v("git commit -m 'test'")]),s._v("发现代码已经被拦截，没有提交，因为"),r("code",{pre:!0},[s._v("index.js")]),s._v("代码不符合规范")]),r("blockquote",[r("p",[s._v("遗留问题就是 git hooks 不会编写怎么办，下面 lint-staged 出来了")])]),r("h2",[r("a",{attrs:{href:"https://github.com/okonet/lint-staged"}},[s._v("lint-staged")])]),r("p",[r("a",{attrs:{href:"https://github.com/okonet/lint-staged#examples"}},[s._v("配置例子")]),s._v(" 作用：对 Git 暂存区代码文件进行 bash 命令操作等等")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm i lint-staged -D\n")])]),r("p",[s._v("根目录下新建"),r("code",{pre:!0},[s._v(".lintstagedrc")]),s._v("文件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("{\n  "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"*.js"')]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"eslint"')]),s._v("\n}\n")])]),r("p",[s._v("把"),r("code",{pre:!0},[s._v("husky")]),s._v("目录下的"),r("code",{pre:!0},[s._v("pre-commit")]),s._v("修改如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v(". "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"'),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("$(dirname "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"'),r("span",{pre:!0,attrs:{class:"hljs-variable"}},[s._v("$0")]),s._v('"')]),s._v(")")]),s._v('/_/husky.sh"')]),s._v("\nnpm run lint\n")])]),r("p",[r("code",{pre:!0},[s._v("package.json")]),s._v("添加"),r("code",{pre:!0},[s._v("script")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"scripts"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"lint"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"lint-staged"')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[r("code",{pre:!0},[s._v("index.js")]),s._v("如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'object'")]),s._v(")\n")])]),r("p",[s._v("执行"),r("code",{pre:!0},[s._v("git add .")]),s._v("，"),r("code",{pre:!0},[s._v("git commit -m 'test'")]),s._v("，可以发现调用了 eslint 去检查代码，检查不通过就退出"),r("code",{pre:!0},[s._v("commit")]),r("img",{attrs:{src:a("5a6b"),alt:"执行结果"}})]),r("p",[s._v("综上，代码检测规范有了，现在也需要规范一下提交规范；")]),r("h2",[r("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint"}},[s._v("commitlint")])]),r("p",[r("a",{attrs:{href:"https://commitlint.js.org/#/guides-local-setup"}},[s._v("github")])]),r("p",[r("strong",[s._v("校验 commit 提交的信息")])]),r("p",[r("code",{pre:!0},[s._v("npm install --save-dev @commitlint/config-conventional @commitlint/cli")])]),r("p",[s._v("使用新建"),r("code",{pre:!0},[s._v("commitlint.config.js")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@commitlint/config-conventional'")]),s._v("],\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'type-enum'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'always'")]),s._v(", ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'build'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ci'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'docs'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'feat'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'fix'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'perf'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'refactor'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'style'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'revert'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'chore'")]),s._v("]],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'type-case'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'type-empty'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'scope-empty'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'scope-case'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'subject-full-stop'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'never'")]),s._v("],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'subject-case'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'never'")]),s._v("],\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'header-max-length'")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'always'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("72")]),s._v("]\n\t}\n}\n")])]),r("p",[s._v("配置"),r("code",{pre:!0},[s._v("git hooks")]),s._v("，执行下面命令")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npx husky add .husky/commit-msg "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'npx --no -- commitlint --edit $1'")]),s._v("\n")])]),r("p",[s._v("commit message 一般分为三个部分 Header，Body 和 Footer")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("header\n<"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("type")]),s._v(">(<scope>): <subject>\n// 空一行\n<body>\n// 空一行\n<footer>\n其中，Header 是必需的，Body 和 Footer 可以省略\n")])]),r("p",[s._v("接下来提交的 commit 必须符合下面的格式")]),r("blockquote",[r("p",[s._v("注意冒号后面有空格")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("git commit -m <type>[optional scope]: <description>\n")])]),r("p",[s._v("常用的 type 类别")]),r("ul",[r("li",[s._v("build：主要目的是修改项目构建系统(例如 glup，webpack，rollup 的配置等)的提交")]),r("li",[s._v("ci：主要目的是修改项目继续集成流程(例如 Travis，Jenkins，GitLab CI，Circle 等)的提交")]),r("li",[s._v("docs：文档更新")]),r("li",[s._v("feat：新增功能")]),r("li",[s._v("fix：bug 修复")]),r("li",[s._v("perf：性能优化")]),r("li",[s._v("refactor：重构代码(既没有新增功能，也没有修复 bug)")]),r("li",[s._v("style：不影响程序逻辑的代码修改(修改空白字符，补全缺失的分号等)")]),r("li",[s._v("test：新增测试用例或是更新现有测试")]),r("li",[s._v("revert：回滚某个更早之前的提交")]),r("li",[s._v("chore：不属于以上类型的其他类型(日常事务)")])]),r("p",[s._v("optional scope：一个可选的修改范围。用于标识此次提交主要涉及到代码中哪个模块。")]),r("p",[s._v("description：一句话描述此次提交的主要内容，做到言简意赅。")]),r("p",[s._v("这时候，执行一次测试一下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("git add .\ngit commit -m "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v("\n")])]),r("p",[s._v("因为该提交的 commit 是不规范的所以提交时失败的 如下图")]),r("p",[r("img",{attrs:{src:a("b105"),alt:"commit"}})]),r("p",[s._v("如果把 commit 修改，就会提交成功，因为符合 commit 规范")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("git add .\ngit commit -m "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'feat: test'")]),s._v("\n")])]),r("p",[r("img",{attrs:{src:a("0529"),alt:"commit success"}})]),r("p",[s._v("但是问题又来了，每次 commit 都要输入，有点不方便；而且有可能输错 下面就介绍到 commitizen")]),r("h2",[r("a",{attrs:{href:"https://github.com/commitizen/cz-cli"}},[s._v("commitizen")])]),r("p",[r("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/cz-commitlint"}},[s._v("cz-commitlint")])]),r("p",[r("strong",[s._v("生成符合规范的 commit message")])]),r("p",[s._v("本地安装并没有全局安装，当然可以全局安装具体查看"),r("a",{attrs:{href:"https://github.com/commitizen/cz-cli"}},[s._v("官方文档")]),s._v("，全局安装可以使用"),r("code",{pre:!0},[s._v("git cz")]),s._v("， "),r("code",{pre:!0},[s._v("cz-commitlint")]),s._v("打通 "),r("code",{pre:!0},[s._v("commitizen")]),s._v(" 和"),r("a",{attrs:{href:"https://github.com/conventional-changelog/commitlint/tree/master/@commitlint/cz-commitlint"}},[r("code",{pre:!0},[s._v("commitlint")])]),s._v("配置")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install --save-dev @commitlint/cz-commitlint commitizen\n")])]),r("p",[s._v("然后")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npx commitizen init cz-conventional-changelog --save-dev --save-exact\n")])]),r("p",[r("code",{pre:!0},[s._v("package.json")]),s._v("添加"),r("code",{pre:!0},[s._v("script")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"scripts"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"commit"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"git-cz"')]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"config"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"commitizen"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"path"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@commitlint/cz-commitlint"')]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("新建"),r("code",{pre:!0},[s._v("commitlint.config.js")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@commitlint/config-conventional'")]),s._v("]\n}\n")])]),r("p",[s._v("然后执行")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("git add .\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm run commit\n")])]),r("p",[s._v("发现为中文提示如下图 "),r("img",{attrs:{src:a("4b63"),alt:""}}),s._v(" 再次修改"),r("code",{pre:!0},[s._v("commitlint.config.js")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@commitlint/config-conventional'")]),s._v("],\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("prompt")]),s._v(": {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("questions")]),s._v(": {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v(": {\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("description")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'选择你要提交的类型:'")]),s._v(",\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("enum")]),s._v(": {\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("feat")]),s._v(": {\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("description")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'新功能'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Features'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("emoji")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'✨'")]),s._v("\n\t\t\t\t\t},\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fix")]),s._v(": {\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("description")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'修复相关bug'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Bug Fixes'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("emoji")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'🐛'")]),s._v("\n\t\t\t\t\t},\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("docs")]),s._v(": {\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("description")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'文档更改'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Documentation'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("emoji")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'📚'")]),s._v("\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n")])]),r("p",[s._v("然后执行")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("git add .\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm run commit\n")])]),r("p",[s._v("可以看到变成中文了，具体参考"),r("a",{attrs:{href:"https://commitlint.js.org/#/reference-prompt"}},[s._v("官网")]),r("img",{attrs:{src:a("306e"),alt:""}})]),r("p",[s._v("接下来提交信息 执行"),r("code",{pre:!0},[s._v("npm run commit")]),s._v("，就可以按照规范提交了； 如果没有使用"),r("code",{pre:!0},[s._v("commitlint")]),s._v("，在 "),r("code",{pre:!0},[s._v("commitizen")]),s._v("中使用 "),r("a",{attrs:{href:"https://github.com/leonardoanalista/cz-customizable"}},[r("code",{pre:!0},[s._v("cz-customizable")])]),s._v("也可以自定义很多配置的")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},9103:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-03_15-17-54.e40af411.png"},"919b":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("PostCss")]),r("p",[s._v("PostCSS 是一个允许使用 JS 插件转换样式的工具。")]),r("blockquote",[r("p",[s._v("可以直观的理解为：它就是 css 平台,这个平台上有许多插件，可以使用这些插件来处理 css")])]),r("p",[s._v("这些插件可以检查（lint）你的 CSS，支持 CSS Variables 和 Mixins， 编译尚未被浏览器广泛支持的先进的 CSS 语法，内联图片，以及其它很多优秀的功能。")]),r("p",[s._v("PostCSS 在工业界被广泛地应用，其中不乏很多有名的行业领导者，如：维基百科，Twitter，阿里巴巴，JetBrains。")]),r("p",[s._v("PostCSS 的 [Autoprefixer] 插件是最流行的 CSS 处理工具之一。")]),r("h2",[s._v("插件")]),r("p",[s._v("截止到目前，PostCSS 有 200 多个插件。你可以在 插件列表 或 搜索目录 找到它们。 下方的列表是我们最喜欢的插件 - 它们很好地演示了我们可以用 PostCSS 做些什么。")]),r("p",[s._v("如果你有任何新的想法，开发 PostCSS 插件 非常简单易上手。")]),r("h3",[s._v("解决全局 CSS 的问题")]),r("ul",[r("li",[s._v("postcss-use 允许你在 CSS 里明确地设置 PostCSS 插件，并且只在当前文件执行它们。")]),r("li",[s._v("postcss-modules 和 react-css-modules 可以自动以组件为单位隔绝 CSS 选择器。")]),r("li",[s._v("postcss-autoreset 是全局样式重置的又一个选择，它更适用于分离的组件。")]),r("li",[s._v("postcss-initial 添加了 all: initial 的支持，重置了所有继承的样式。")]),r("li",[s._v("cq-prolyfill 添加了容器查询的支持，允许添加响应于父元素宽度的样式.")])]),r("h3",[s._v("提前使用先进的 CSS 特性")]),r("ul",[r("li",[s._v("autoprefixer 添加了 vendor 浏览器前缀，它使用 Can I Use 上面的数据。")]),r("li",[s._v("postcss-cssnext 允许你使用未来的 CSS 特性（包括 autoprefixer）。")]),r("li",[s._v("postcss-image-set-polyfill 为所有浏览器模拟了 image-set 函数逻辑。")])]),r("h3",[s._v("更佳的 CSS 可读性")]),r("ul",[r("li",[s._v("precss 囊括了许多插件来支持类似 Sass 的特性，比如 CSS 变量，套嵌，mixins 等。")]),r("li",[s._v("postcss-sorting 给规则的内容以及@规则排序。")]),r("li",[s._v("postcss-utilities 囊括了最常用的简写方式和书写帮助。")]),r("li",[s._v("short 添加并拓展了大量的缩写属性。")])]),r("h3",[s._v("图片和字体")]),r("ul",[r("li",[s._v("postcss-assets 可以插入图片尺寸和内联文件。")]),r("li",[s._v("postcss-sprites 能生成雪碧图。")]),r("li",[s._v("font-magician 生成所有在 CSS 里需要的 @font-face 规则。")]),r("li",[s._v("postcss-inline-svg 允许你内联 SVG 并定制它的样式。")]),r("li",[s._v("postcss-write-svg 允许你在 CSS 里写简单的 SVG。")])]),r("h3",[s._v("提示器（Linters）")]),r("ul",[r("li",[s._v("postcss-rtl 在单个 CSS 文件里组合了两个方向（左到右，右到左）的样式。")]),r("li",[s._v("cssnano 是一个模块化的 CSS 压缩器。")]),r("li",[s._v("lost 是一个功能强大的 calc() 栅格系统。")]),r("li",[s._v("rtlcss 镜像翻转 CSS 样式，适用于 right-to-left 的应用场景。")])]),r("h3",[s._v("其它")]),r("p",[s._v("postcss-rtl 在单个 CSS 文件里组合了两个方向（左到右，右到左）的样式。 cssnano 是一个模块化的 CSS 压缩器。 lost 是一个功能强大的 calc() 栅格系统。 rtlcss 镜像翻转 CSS 样式，适用于 right-to-left 的应用场景。")]),r("h3",[s._v("语法")]),r("p",[s._v("PostCSS 可以转化样式到任意语法，不仅仅是 CSS。 如果还没有支持你最喜欢的语法，你可以编写一个解释器以及（或者）一个 stringifier 来拓展 PostCSS。")]),r("ul",[r("li",[s._v("sugarss 是一个以缩进为基础的语法，类似于 Sass 和 Stylus。")]),r("li",[s._v("postcss-html 允许你在 HTML / Markdown / Vue component 里编写样式。")]),r("li",[s._v("postcss-scss 允许你使用 SCSS (但并没有将 SCSS 编译到 CSS)。")]),r("li",[s._v("postcss-sass 允许你使用 Sass (但并没有将 Sass 编译到 CSS)。")]),r("li",[s._v("postcss-less 允许你使用 Less (但并没有将 LESS 编译到 CSS)。")]),r("li",[s._v("postcss-less-engine 允许你使用 Less (并且使用真正的 Less.js 把 LESS 编译到 CSS)。")]),r("li",[s._v("postcss-js 允许你在 JS 里编写样式，或者转换成 React 的内联样式／Radium／JSS。")]),r("li",[s._v("postcss-safe-parser 查找并修复 CSS 语法错误。")]),r("li",[s._v("midas 将 CSS 字符串转化成高亮的 HTML。")])]),r("h2",[s._v("实践")]),r("p",[s._v("使用"),r("code",{pre:!0},[s._v("npm init -y")]),s._v("初始化一个项目")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm i -D postcss postcss-cli\n")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm i -save autoprefixer postcss-pxtorem\n")])]),r("p",[s._v("package.json")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[s._v("  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"scripts"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"postcss"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"npx postcss src -d dist --watch"')]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n")])]),r("p",[s._v("在根目录下新建 src 文件夹，新建 demo.css")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-css"}},[r("span",{pre:!0,attrs:{class:"hljs-selector-class"}},[s._v(".test")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("transform")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("rotate")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("30deg")]),s._v(");\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-selector-class"}},[s._v(".hello")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("display")]),s._v(": flex;\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-selector-class"}},[s._v(".h")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("width")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("300px")]),s._v(";\n\tuser-select: none;\n}\n")])]),r("p",[s._v("新建"),r("code",{pre:!0},[s._v("postcss.config.js")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("autoprefixer")]),s._v(": {},\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// flexible配置")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-pxtorem'")]),s._v(": {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rootValue")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("75")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 设计稿宽度的1/10")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("propList")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'*'")]),s._v("] "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 需要做转化处理的属性，如`hight`、`width`、`margin`等，`*`表示全部")]),s._v("\n\t\t}\n\t}\n}\n")])]),r("p",[s._v("新建"),r("code",{pre:!0},[s._v(".browserslistrc")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[s._v("> 0.001%, last 20 versions,Firefox > 10,ie > 6,iOS > 1,dead\n")])]),r("p",[s._v("然后 yarn run postcss,可以看到根目录下有个 demo.css 这个就是 postCss 编译得到的文件")]),r("h3",[s._v("在 webpack 配置")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("module")]),s._v(": {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": [\n\t\t\t{\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("test")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\.css$/i")]),s._v(",\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("use")]),s._v(": [\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'style-loader'")]),s._v(",\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'css-loader'")]),s._v(",\n\t\t\t\t\t{\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("loader")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-loader'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("options")]),s._v(": {\n\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("postcssOptions")]),s._v(": {\n\t\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": [\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-preset-env'")]),s._v(",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Options")]),s._v("\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t}\n}\n")])]),r("p",[s._v("发散思考使用 sass，less 是否可以在 less-loader 或者 sass-loader 处理后配置 postCss？如下有待进一步验证")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("module")]),s._v(": {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": [\n\t\t\t{\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("test")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\.s[ac]ss$/i")]),s._v(",\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("use")]),s._v(": [\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将 JS 字符串生成为 style 节点")]),s._v("\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'style-loader'")]),s._v(",\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将 CSS 转化成 CommonJS 模块")]),s._v("\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'css-loader'")]),s._v(",\n\t\t\t\t\t{\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("loader")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-loader'")]),s._v(",\n\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("options")]),s._v(": {\n\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("postcssOptions")]),s._v(": {\n\t\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": [\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-preset-env'")]),s._v(",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Options")]),s._v("\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 将 Sass 编译成 CSS")]),s._v("\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sass-loader'")]),s._v("\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t}\n}\n")])]),r("h2",[s._v("css 兼容")]),r("p",[s._v("注意要配合根目录下面"),r("code",{pre:!0},[s._v(".browserslistrc")]),s._v("处理")]),r("p",[r("img",{attrs:{src:a("9272"),alt:"css兼容"}}),s._v(" 在 这里 display:flex 需要兼容性处理，webpack 编译打包时，需要使用 postcss-loader 这个 loader 和 postcss-preset-env 这个插件，它帮 postcss 找到 package.json 中 browserslist 里面的配置，通过配置加载指定的 css 兼容性样式")]),r("p",[s._v("首先，下载安装 "),r("code",{pre:!0},[s._v("npm install --save-dev postcss-loader postcss-preset-env")])]),r("p",[s._v("webpack.config.js 配置：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("{\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("test")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\.css$/")]),s._v(",\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("use")]),s._v(": [\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("MiniCssExtractPlugin")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("loader")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//这个loader取代style-loader,将css从js中提取出来")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'css-loader'")]),s._v(",\n\t\t{\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("loader")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-loader'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//css兼容性处理,修改loader的配置,使用默认配置的话直接 postcss-loader")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("options")]),s._v(": {\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("ident")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss'")]),s._v(",\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" [\n\t\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'postcss-preset-env'")]),s._v(")() "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//postcss的插件")]),s._v("\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t]\n}\n\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},9252:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("JavaScript 设计模式之单例模式")]),a("h2",[s._v("单例模式")]),a("p",[s._v("确保一个类只有一个实例，并提供一个访问它的全局访问点")]),a("blockquote",[a("p",[s._v("单例模式需满足两个条件: 只有一个实例和可以全局访问。")])]),a("h2",[s._v("实现方式")]),a("p",[s._v("使用一个变量存储类实例对象（值初始为 null/undefined ）。进行类实例化时，判断类实例对象是否存在，存在则返回该实例，不存在则创建类实例后返回")]),a("h2",[s._v('"简单版本"单例模式')]),a("p",[s._v("在类里定义个静态方法 getIntance ，判断是否创建过实例，如果创建过则直接返回，没有则创建。 所以无论调用多少次 getIntance 返回的都是第一次创建的那个实例，自然 s1.getName 与 s2.getName 指向的 this 都是 s1 而 s3 不是通过 getIntance 创建的，是直接 new 出来的，所以跟 s1 s2 都不一样")]),a("p",[s._v("缺点：")]),a("ul",[a("li",[s._v("这种单例模式存在两种创建实例方式，当采用 new 时就不再单例了")]),a("li",[s._v("判断是否实例化过(即单例判断)跟对象创建都放在 getIntance 处理，不符合单一职责原则")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("instance")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v("\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getInstance")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 判断是否已经 new 过1个实例")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("instance")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 若这个唯一的实例不存在，则创建它并存储")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("instance")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("(name)\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 如果这个唯一实例已经存在,则直接返回")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("instance")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s1 = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getInstance")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s2 = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getInstance")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s2."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s1 == s2) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 这里只能用 getInstance 才能保证单例，如果用 new SingleObject 就没办法保证了")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s3 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'王五'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s3."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 王五")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s3 == s2) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// false")]),s._v("\n")])]),a("h2",[s._v("闭包版单例模式")]),a("p",[s._v("通过立即执行函数，以及闭包创建了单例函数，这下就又统一成以 new 的形式创建对象即可")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v(" = ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//在闭包里面定义了一个instance变量，将instance变量定义在外部会污染全局变量")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" instance = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 判断变量是否为 null")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!instance) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t\t\tinstance = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" instance\n\t}\n})()\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getName")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s2 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s2."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s1 == s2) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s3 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'王五'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s3."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s3 == s2) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),a("h2",[s._v('"代理版" 单例模式')]),a("p",[s._v("简单版本单例模式将单例管理与对象创建全整在一个类里，不符合单一职责原则，而代理版的作用就是将这两者分离")]),a("p",[s._v("这样， SingleObject 只负责该类相关的属性跟方法， 至于管理单例就由 ProxySingleObject 处理，对外也只暴露 ProxySingleObject 即可。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v("\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ProxySingleObject")]),s._v(" = ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" instance\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!instance) {\n\t\t\tinstance = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v("(name)\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" instance\n\t}\n})()\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s1 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ProxySingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s2 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ProxySingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'李四'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s1."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s2."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s1 == s2) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" s3 = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ProxySingleObject")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'王五'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s3."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("()) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 张三")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("info")]),s._v("(s3 == s2) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),a("h2",[s._v("通用惰性单例模式")]),a("p",[s._v("上面惰性单例模式，也是存在单例控制以及创建融合在一起的问题，另外也不够通用。何为通用呢？ 就是将单例控制抽离成单独的函数，控制保证只有一个对象，类似这样的：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getSingle")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fn")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" result\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'name'")]),s._v(", name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result || (result = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fn")]),s._v("(name))\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'1111'")]),s._v(", name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getName")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v("\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" createSingle = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getSingle")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SingleObject")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" test = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createSingle")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xiaoming'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(test."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(")\n")])]),a("p",[s._v("懒汉式(惰性)：默认不会实例化，什么时候用到了，才会创建对象实例。 饿汉式：类加载的时候就会进行实例化，并且创建单例对象实例。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},9272:function(s,t,a){s.exports=a.p+"img/05100516778-1469026681.deeb986a.png"},"950b":function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("使用 stylelint 校验 css 代码（实践）")]),r("p",[r("a",{attrs:{href:"http://stylelint.docschina.org/"}},[s._v("stylelint")]),s._v(" 使用原因：一个强大的，现代的样式代码检查工具，可以帮助您避免错误并在您的样式中强制执行约定，在多人开发中规范一致的css编写规范")]),r("blockquote",[r("p",[s._v("在阅读该文章前，可以前往stylelint官网先大概了解 stylelint 的基本配置，这样效果更佳哦")])]),r("h2",[s._v("安装")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install stylelint --save-dev\n")])]),r("h2",[s._v("组成")]),r("p",[s._v("配置文件可以由 共享配置"),r("a",{attrs:{href:"http://stylelint.docschina.org/"}},[s._v("extends")]),s._v("、规则"),r("a",{attrs:{href:"http://stylelint.docschina.org/user-guide/rules/"}},[r("code",{pre:!0},[s._v("rules")])]),s._v("、插件"),r("a",{attrs:{href:"http://stylelint.docschina.org/user-guide/plugins/"}},[s._v("plugins")]),s._v("和处理器"),r("a",{attrs:{href:"http://stylelint.docschina.org/user-guide/processors/"}},[s._v("processors")]),s._v("组成")]),r("ul",[r("li",[s._v("共享配置：最快捷的配置方式")]),r("li",[s._v("规则：规则确定了代码检查工具寻找和指正的内容")]),r("li",[s._v("插件：社区构建的规则和规则集，支持方法论、工具集、非标准 CSS 功能或非常具体的用例。他们的包名称以“stylelint”为前缀。他们的规则名称有命名空间，所以它们不会与 stylelint 的核心规则冲突")]),r("li",[s._v("处理器是一些社区包，使 stylelint 能够从非样式表文件中提取样式 （PostCSS 插件将忽略它们）")])]),r("h2",[s._v("创建 stylelint 配置文件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("echo")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"module.exports={}"')]),s._v(" >stylelint.config.js\n")])]),r("p",[r("code",{pre:!0},[s._v("stylelint.config.js")]),s._v("配置如下")]),r("p",[s._v("意思就是：指定缩进规则，值为 2 个空格")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("indentation")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("\n\t}\n}\n")])]),r("p",[r("code",{pre:!0},[s._v("package.json")]),s._v("写入 script")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"scripts"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"stylelint"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stylelint ./src/*.css"')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n")])]),r("p",[s._v("在根目录下新建"),r("code",{pre:!0},[s._v("src")]),s._v("文件夹，在"),r("code",{pre:!0},[s._v("src")]),s._v("中新建"),r("code",{pre:!0},[s._v("index.css")]),s._v("，写入如下内容，注意不要格式化，css 属性 "),r("strong",[s._v("color 的前面不要有空格")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-css"}},[r("span",{pre:!0,attrs:{class:"hljs-selector-tag"}},[s._v("div")]),s._v(" {\n"),r("span",{pre:!0,attrs:{class:"hljs-attribute"}},[s._v("color")]),s._v(": red;\n}\n")])]),r("p",[s._v("然后执行"),r("code",{pre:!0},[s._v("npm run stylelint")]),s._v("，可以看到 stylelint 已经检测出该 css 的写法有问题的如下图 "),r("img",{attrs:{src:a("eb77"),alt:"检测"}})]),r("blockquote",[r("p",[s._v("由于 stylelint 的 rule 有很多，如果一条一条的配置不就是很繁琐，所以 stylelint 官方推荐了两个共享配置，"),r("code",{pre:!0},[s._v("stylelint-config-recommended")]),s._v("和"),r("code",{pre:!0},[s._v("stylelint-config-standard")])])]),r("h2",[r("code",{pre:!0},[s._v("stylelint-config-standard")])]),r("p",[r("code",{pre:!0},[s._v("stylelint-config-standard")]),s._v("是继承于"),r("code",{pre:!0},[s._v("stylelint-config-recommended")]),s._v("，也就是说在"),r("code",{pre:!0},[s._v("stylelint-config-recommended")]),s._v("的基础上新增或者更改规则")]),r("p",[s._v("官方对两者进行了如下的描述：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("建议(recommended)配置仅打开可能错误的规则。标准(standard)配置通过打开 60 个风格规则来扩展它。我们建议您扩展：\n\n- 建议(recommended)配置，如果您使用 prettier 之类的美化排版工具\n- 标准(standard)配置，如果您希望 stylelint 强制执行风格约定\n")])]),r("h3",[s._v("安装"),r("code",{pre:!0},[s._v("stylelint-config-standard")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install stylelint-config-standard --save-dev\n")])]),r("p",[s._v("安装之后在"),r("code",{pre:!0},[s._v("node_modules")]),s._v("中找到"),r("code",{pre:!0},[s._v("stylelint-config-standard")]),s._v("目录，打开目录下的"),r("code",{pre:!0},[s._v("index.js")]),r("img",{attrs:{src:a("52ea"),alt:"目录"}}),s._v(" 可以看到 如下图 "),r("img",{attrs:{src:a("eea3"),alt:"stylelint-config-standard"}})]),r("p",[s._v("此时 "),r("code",{pre:!0},[s._v("stylelint.config.js")]),s._v("配置如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'stylelint-config-standard'")]),s._v("\n}\n")])]),r("p",[s._v("在执行"),r("code",{pre:!0},[s._v("npm run stylelint")]),s._v("会发现一样可以检测出错误")]),r("h2",[s._v("作为 PostCSS 插件在 postcss.config.js 配置文件中使用")]),r("p",[s._v("关于 postCss 使用请参考"),r("a",{attrs:{href:"https://www.postcss.com.cn/"}},[s._v("官方文档")]),s._v(" 与任何其他 PostCSS 插件一样，您可以使用 stylelint 作为 PostCSS 插件 具体参考官方文档"),r("a",{attrs:{href:"http://stylelint.docschina.org/user-guide/postcss-plugin/"}},[s._v("stylelint")])]),r("p",[s._v("在"),r("code",{pre:!0},[s._v("postcss.config.js")]),s._v("中配置如下")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" stylelint = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'stylelint'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'stylelint'")]),s._v(": {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("config")]),s._v(": {\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'stylelint-config-standard'")]),s._v("\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {}\n      }\n    }\n  }\n}\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},"9a5b":function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_21-59-51.115e53c5.png"},"9c0c":function(s,t,a){},"9df6":function(s,t,a){"use strict";a.r(t);var r=a("5530"),e=(a("d3b7"),a("ddb0"),a("caad"),a("2532"),a("f0d9")),n=a.n(e),l=a("ba25"),p=l.keys().reduce((function(s,t){return t.includes("zh")&&(s=Object.assign({},s,l(t).default)),s}),{});t["default"]={zh:Object(r["a"])(Object(r["a"])({},p),n.a)}},a25e:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_21-57-13.409ba66e.png"},a4d8:function(s,t,a){},a697:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-30-46.3f64e823.png"},a70a:function(s,t,a){"use strict";a.r(t);a("caad"),a("2532"),a("d3b7"),a("159b");var r={install:function(s){s.prototype.$bus=new s;var t=console.warn;s.mixin({data:function(){return{eventListeners:[]}},methods:{$listen:function(s,a){return s&&"string"===typeof s?a&&"function"===typeof a?this.eventListeners.includes(s)?t("[注意] 事件: ".concat(s," 已注册,无须重复注册")):(this.eventListeners.push(s),void this.$bus.$on(s,a)):t("[注意] 事件处理方法必须是一个有效的方法"):t("[注意] 请提供一个有效的事件名字")},$dispatch:function(s,a){var r=this;if(!s||"string"!==typeof s)return t("[注意] 请提供一个有效的事件名字");this.$nextTick((function(){setTimeout((function(){r.$bus.$emit(s,a)}),0)}))}},beforeDestroy:function(){var s=this;this.eventListeners.length&&this.eventListeners.forEach((function(t){s.$bus.$off(t)}))}})}};t["default"]=r},aaec:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h3",[s._v("Referer")]),r("h4",[s._v("什么是 Referer")]),r("p",[s._v("Referer 是 HTTP 请求 header 的一部分，当浏览器（或者模拟浏览器行为）向 web 服务器发送请求的时候，头信息里有包含 Referer。 比如我在 www.sojson.com 里有一个 www.baidu.com 链接，那么点击这个www.baidu.com ，它的 header 信息里就有：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":""}},[s._v("Referer=https://www.sojson.com\n")])]),r("p",[s._v("由此可以看出来吧。它就是表示一个来源。看下图的一个请求的 Referer 信息。")]),r("blockquote",[r("p",[s._v("Referer 的正确英语拼法是 referrer 。由于早期 HTTP 规范的拼写错误，为了保持向后兼容就将错就错了。其它网络技术的规范企图修正此问题，使用正确拼法，所以目前拼法不统一。还有它第一个字母是大写。")])]),r("p",[r("img",{attrs:{src:a("d22b"),alt:""}})]),r("h4",[s._v("Referer 的作用")]),r("h5",[s._v("防盗链")]),r("p",[s._v("我在www.sojson.com里有一个www.baidu.com链接，那么点击这个www.baidu.com，它的header信息里就有：")]),r("blockquote",[r("p",[s._v("Referer=https://www.sojson.com 那么可以利用这个来防止盗链了，比如我只允许我自己的网站访问我自己的图片服务器，那我的域名是www.sojson.com，那么图片服务器每次取到Referer来判断一下是不是我自己的域名www.sojson.com，如果是就继续访问，不是就拦截。")])]),r("h5",[s._v("防止恶意请求")]),r("p",[s._v("比如我的 SOJSON 网站上，静态请求是*.html 结尾的，动态请求是*.shtml，那么由此可以这么用，所有的*.shtml 请求，必须 Referer 为我自己的网站。")]),r("blockquote",[r("p",[s._v("Referer=https://www.sojson.com")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},ab3c:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-44-25.d55ddb3a.png"},b105:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-06_09-52-26.bbd14b0c.png"},b126:function(s,t,a){s.exports=a.p+"img/45646547.e467eac0.png"},b27d:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("react 组件懒加载")]),a("p",[s._v("在使用 Create React App 创建的 React 项目，通常会通过 import 引用所需的组件(如 import HelloWorld from './HelloWorld')，"),a("strong",[s._v("当项目打包成生产环境代码时，通过这种方式引用的 js 文件都会被打包到一起")]),s._v("。")]),a("p",[s._v("当前端项目代码量足够大时，这意味最终打包出来的 index.js 代码量也将会非常大，这明显不利于实现页面的秒加载。")]),a("p",[s._v("遇到这种场景，懒加载就提供了解决方案。懒加载的根本就是代码分割，"),a("strong",[s._v("它可以将不需要在首屏显示的组件代码独立分割成一个文件")]),s._v("，在适当的时候(如经过用户交互后)，再把这类组件动态加载出来。")]),a("h4",[s._v("React 实现懒加载有两种方式")]),a("h5",[s._v("import().then()")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./math'")]),s._v(")."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("math")]),s._v(" =>")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(math."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("add")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("16")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("26")]),s._v("))\n})\n")])]),a("p",[s._v("以上面代码为例，用方式实现懒加载，在打包时会将 import 的内容即 math.js 独立打包成一个文件，实现与主程序的代码分割。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-jsx"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("React")]),s._v(", { "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("asyncComponent")]),s._v(" = importComponent => {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("()\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(" = {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t\t}\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("componentDidMount")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("importComponent")]),s._v("()."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("cmp")]),s._v(" =>")]),s._v(" {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setState")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v(": cmp."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("default")]),s._v(" })\n\t\t\t})\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("render")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" C = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("component")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" C ? "),a("span",{pre:!0,attrs:{class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("C")]),s._v(" {"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("...this.props")]),s._v("} />")])]),s._v(" : "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t}\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" asyncComponent\n")])]),a("p",[s._v("在实际应用中，常常会封装成一个动态加载的高阶组件 asyncComponent：")]),a("p",[s._v("asyncComponent 应用于路由的懒加载实现：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-jsx"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Switch")]),s._v(">\n\t"),a("span",{pre:!0,attrs:{class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Route")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("exact")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("{AsyncComponent(()")]),s._v(" =>")]),s._v(" import('./routes/Home'))}>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Route")]),s._v(">")])]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Route")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/about"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("{AsyncComponent(()")]),s._v(" =>")]),s._v(" import('./routes/About'))}>"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Route")]),s._v(">")])]),s._v("\n</"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Switch")]),s._v(">\n")])]),a("h5",[s._v("React.lazy")]),a("p",[s._v("React.lazy 接受一个函数，这个函数需要动态调用 import()。它必须返回一个 Promise，该 Promise 需要 resolve 一个 defalut export 的 React 组件。React.lazy 通常与 React.Suspense 配合使用")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-jsx"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("React")]),s._v(", { lazy, "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Suspense")]),s._v(" } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Comp")]),s._v("A = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("lazy")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./CompA'")]),s._v("))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("React.Component")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("props")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(props)\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("render")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" visible = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" (\n\t\t\t"),a("span",{pre:!0,attrs:{class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n\t\t\t\t{visible ? (\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Suspense")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fallback")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("{")]),s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("div")]),s._v(">")]),s._v("Loading..."),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("}>\n\t\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("CompA")]),s._v(" />")]),s._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Suspense")]),s._v(">")]),s._v("\n\t\t\t\t) : null}\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")])]),s._v("\n\t\t)\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v("\n")])]),a("p",[s._v("在上述代码中，组件 CompA 不会被马上加载进来，只有当 visible 为 true 时，才会被动态加载进来。")]),a("p",[s._v("当项目打包时，与第一种方式相同，CompA.js 会被独立打包出来，打包出来的文件会通过动态加载的方式引用到项目中。")]),a("p",[s._v("React.lazy 应用于路由懒加载实现：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-jsx"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("BrowserRouter")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Router")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Route")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Switch")]),s._v(" } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react-router-dom'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("React")]),s._v(", { "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Suspense")]),s._v(", lazy } "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Home")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("lazy")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./routes/Home'")]),s._v("))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("About")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("lazy")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("import")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./routes/About'")]),s._v("))\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("App")]),s._v(" = ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") => (\n\t"),a("span",{pre:!0,attrs:{class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Router")]),s._v(">")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Suspense")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fallback")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("{")]),s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("div")]),s._v(">")]),s._v("Loading..."),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("}>\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Switch")]),s._v(">")]),s._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Route")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("exact")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("{Home}")]),s._v(" />")]),s._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Route")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("path")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"/about"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("component")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("{About}")]),s._v(" />")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Switch")]),s._v(">")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Suspense")]),s._v(">")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Router")]),s._v(">")])]),s._v("\n)\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},b2a1:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("JavaScript ES6 Reflect")]),a("h2",[s._v("概述")]),a("p",[a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象不是构造函数，所以创建时不是用 "),a("code",{pre:!0},[s._v("new")]),s._v(" 来进行创建 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象与 Proxy 对象一样，也是 ES6 为了操作对象而提供的新 API。"),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象的设计目的有这样几个")]),a("p",[s._v("（1） 将 "),a("code",{pre:!0},[s._v("Object")]),s._v(" 对象的一些明显属于语言内部的方法（比如 "),a("code",{pre:!0},[s._v("Object.defineProperty")]),s._v("），放到 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象上。现阶段，某些方法同时在 "),a("code",{pre:!0},[s._v("Object")]),s._v(" 和 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象上部署，未来的新方法将只部署在 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象上。也就是说，从 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象上可以拿到语言内部的方法")]),a("p",[s._v("（2） 修改某些 "),a("code",{pre:!0},[s._v("Object")]),s._v(" 方法的返回结果，让其变得更合理。比如，"),a("code",{pre:!0},[s._v("Object.defineProperty(obj, name, desc)")]),s._v("在无法定义属性时，会抛出一个错误，而 "),a("code",{pre:!0},[s._v("Reflect.defineProperty(obj, name, desc)")]),s._v("则会返回 "),a("code",{pre:!0},[s._v("false")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 老写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, property, attributes)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// success")]),s._v("\n} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (e) {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// failure")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, property, attributes)) {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// success")]),s._v("\n} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// failure")]),s._v("\n}\n")])]),a("p",[s._v("（3） 让 "),a("code",{pre:!0},[s._v("Object")]),s._v(" 操作都变成"),a("strong",[s._v("函数行为")]),s._v("。某些 "),a("code",{pre:!0},[s._v("Object")]),s._v(" 操作是命令式，比如"),a("code",{pre:!0},[s._v("name in obj")]),s._v(" 和 "),a("code",{pre:!0},[s._v("delete obj[name]")]),s._v("，而 "),a("code",{pre:!0},[s._v("Reflect.has(obj, name)")]),s._v("和 "),a("code",{pre:!0},[s._v("Reflect.deleteProperty(obj, name)")]),s._v("让它们变成了函数行为")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 老写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'assign'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'assign'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),a("p",[s._v("（4）"),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象的方法与 "),a("code",{pre:!0},[s._v("Proxy")]),s._v("对象的方法一一对应，只要是 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 对象的方法，就能在 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象上找到对应的方法。这就让 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 对象可以方便地调用对应的 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 方法，完成默认行为，作为修改行为的基础。也就是说，不管 "),a("code",{pre:!0},[s._v("Proxy")]),s._v(" 怎么修改默认行为，你总可以在 "),a("code",{pre:!0},[s._v("Reflect")]),s._v(" 上获取默认行为。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(target, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("set")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name, value, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" success = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(target, name, value, receiver)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (success) {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'property '")]),s._v(" + name + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' on '")]),s._v(" + target + "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' set to '")]),s._v(" + value)\n\t\t}\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" success\n\t}\n})\n")])]),a("p",[s._v("上面代码中，Proxy 方法拦截 target 对象的属性赋值行为。它采用 Reflect.set 方法将值赋值给对象的属性，确保完成原有的行为，然后再部署额外的功能。 下面是另一个例子")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" loggedObj = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(obj, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(", target, name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(target, name)\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deleteProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'delete'")]),s._v(" + name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deleteProperty")]),s._v("(target, name)\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, name")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'has'")]),s._v(" + name)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(target, name)\n\t}\n})\n")])]),a("p",[s._v("上面代码中，每一个"),a("code",{pre:!0},[s._v("Proxy")]),s._v("对象的拦截操作（"),a("code",{pre:!0},[s._v("get、delete、has")]),s._v("），内部都调用对应的"),a("code",{pre:!0},[s._v("Reflect")]),s._v("方法，保证原生行为能够正常执行。添加的工作，就是将每一个操作输出一行日志。")]),a("p",[s._v("有了"),a("code",{pre:!0},[s._v("Reflect")]),s._v("对象以后，很多操作会更易读。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 老写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("apply")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("floor")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(", ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1.75")]),s._v("]) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("floor")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(", ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1.75")]),s._v("]) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),a("h2",[s._v("静态方法")]),a("p",[a("code",{pre:!0},[s._v("Reflect")]),s._v(" 对象一共有 13 个静态方法")]),a("ul",[a("li",[s._v("Reflect.apply(target, thisArg, args)")]),a("li",[s._v("Reflect.construct(target, args)")]),a("li",[s._v("Reflect.get(target, name, receiver)")]),a("li",[s._v("Reflect.set(target, name, value, receiver)")]),a("li",[s._v("Reflect.defineProperty(target, name, desc)")]),a("li",[s._v("Reflect.deleteProperty(target, name)")]),a("li",[s._v("Reflect.has(target, name)")]),a("li",[s._v("Reflect.ownKeys(target)")]),a("li",[s._v("Reflect.isExtensible(target)")]),a("li",[s._v("Reflect.preventExtensions(target)")]),a("li",[s._v("Reflect.getOwnPropertyDescriptor(target, name)")]),a("li",[s._v("Reflect.getPrototypeOf(target)")]),a("li",[s._v("Reflect.setPrototypeOf(target, prototype)")])]),a("p",[s._v("上面这些方法的作用，大部分与 Object 对象的同名方法的作用都是相同的，而且它与 Proxy 对象的方法是一一对应的。下面是对它们的解释。")]),a("h3",[s._v("Reflect.get(target, name, receiver)")]),a("p",[s._v("Reflect.get 方法查找并返回 target 对象的 name 属性，如果没有该属性，则返回 undefined")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("bar")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("baz")]),s._v("() {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bar")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'foo'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bar'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'baz'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 3")]),s._v("\n")])]),a("p",[s._v("如果 name 属性部署了读取函数（getter），则读取函数的 this 绑定 receiver")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("bar")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("baz")]),s._v("() {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" + "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bar")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myReceiverObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("bar")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("get")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'baz'")]),s._v(", myReceiverObject) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 8")]),s._v("\n")])]),a("h3",[s._v("Reflect.set(target, name, value, receiver)")]),a("p",[s._v("Reflect.set 方法设置 target 对象的 name 属性等于 value")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("value")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" = value)\n\t}\n}\n\nmyObject."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'foo'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\nmyObject."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 2")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bar'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(")\nmyObject."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 3")]),s._v("\n")])]),a("p",[s._v("如果 name 属性设置了赋值函数，则赋值函数的 this 绑定 receiver")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("value")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" = value)\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myReceiverObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bar'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", myReceiverObject)\nmyObject."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 4")]),s._v("\nmyReceiverObject."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 1")]),s._v("\n")])]),a("p",[s._v("注意，如果 Proxy 对象和 Reflect 对象联合使用，前者拦截赋值操作，后者完成赋值的默认行为，而且传入了 receiver，那么 Reflect.set 会触发 Proxy.defineProperty 拦截")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" p = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" handler = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, value, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'set'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(target, key, value, receiver)\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, attribute")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'defineProperty'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, key, attribute)\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" obj = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(p, handler)\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("a")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'A'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// set")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// defineProperty")]),s._v("\n")])]),a("p",[s._v("上面代码中，Proxy.set 拦截里面使用了 Reflect.set，而且传入了 receiver，导致触发 Proxy.defineProperty 拦截。这是因为 Proxy.set 的 receiver 参数总是指向当前的 Proxy 实例（即上例的 obj），而 Reflect.set 一旦传入 receiver，就会将属性赋值到 receiver 上面（即 obj），导致触发 defineProperty 拦截。如果 Reflect.set 没有传入 receiver，那么就不会触发 defineProperty 拦截")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" p = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" handler = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, value, receiver")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'set'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("set")]),s._v("(target, key, value)\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, attribute")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'defineProperty'")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, key, attribute)\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" obj = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(p, handler)\nobj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("a")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'A'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// set")]),s._v("\n")])]),a("h3",[s._v("Reflect.has(obj, name)")]),a("p",[s._v("Reflect.has 方法对应 name in obj 里面的 in 运算符")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'foo'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" myObject "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("has")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'foo'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),a("h3",[s._v("Reflect.deleteProperty(obj, name)")]),a("p",[s._v("Reflect.deleteProperty 方法等同于 delete obj[name]，用于删除对象的属性")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" myObj = { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bar'")]),s._v(" }\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("delete")]),s._v(" myObj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("deleteProperty")]),s._v("(myObj, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'foo'")]),s._v(")\n")])]),a("p",[s._v("该方法返回一个布尔值。如果删除成功，或者被删除的属性不存在，返回 true；删除失败，被删除的属性依然存在，返回 false。")]),a("h3",[s._v("Reflect.construct(target, args)")]),a("p",[s._v("Reflect.construct(target, args)")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Greeting")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("name")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = name\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// new 的写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" instance = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Greeting")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Reflect.construct 的写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" instance = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("construct")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Greeting")]),s._v(", ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'张三'")]),s._v("])\n")])]),a("h3",[s._v("Reflect.getPrototypeOf(obj)")]),a("p",[s._v("Reflect.getPrototypeOf 方法用于读取对象的"),a("strong",[s._v("proto")]),s._v("属性，对应 Object.getPrototypeOf(obj)")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" myObj = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FancyThing")]),s._v("()\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrototypeOf")]),s._v("(myObj) === "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FancyThing")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrototypeOf")]),s._v("(myObj) === "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FancyThing")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("\n")])]),a("p",[s._v("Reflect.getPrototypeOf 和 Object.getPrototypeOf 的一个区别是，如果参数不是对象，Object.getPrototypeOf 会将这个参数转为对象，然后再运行，而 Reflect.getPrototypeOf 会报错")]),a("h3",[s._v("Reflect.setPrototypeOf(obj, newProto)")]),a("p",[s._v("Reflect.setPrototypeOf 方法用于设置目标对象的原型（prototype），对应 Object.setPrototypeOf(obj, newProto)方法。它返回一个布尔值，表示是否设置成功")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" myObj = {}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setPrototypeOf")]),s._v("(myObj, "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setPrototypeOf")]),s._v("(myObj, "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Array")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(")\n\nmyObj."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 0")]),s._v("\n")])]),a("p",[s._v("如果无法设置目标对象的原型（比如，目标对象禁止扩展），Reflect.setPrototypeOf 方法返回 false")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setPrototypeOf")]),s._v("({}, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setPrototypeOf")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("freeze")]),s._v("({}), "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// false")]),s._v("\n")])]),a("h3",[s._v("Reflect.apply(func, thisArg, args)")]),a("p",[s._v("Reflect.apply 方法等同于 Function.prototype.apply.call(func, thisArg, args)，用于绑定 this 对象后执行给定函数。 一般来说，如果要绑定一个函数的 this 对象，可以这样写 fn.apply(obj, args)，但是如果函数定义了自己的 apply 方法，就只能写成 Function.prototype.apply.call(fn, obj, args)，采用 Reflect 对象可以简化这种操作。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" ages = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("11")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("33")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("12")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("54")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("18")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("96")]),s._v("]\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" youngest = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("min")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v(", ages)\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" oldest = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("max")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v(", ages)\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" type = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("toString")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(youngest)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" youngest = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("min")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v(", ages)\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" oldest = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("max")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Math")]),s._v(", ages)\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" type = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("toString")]),s._v(", youngest, [])\n")])]),a("h3",[s._v("Reflect.defineProperty(target, propertyKey, attributes)")]),a("p",[s._v("Reflect.defineProperty 方法基本等同于 Object.defineProperty，用来为对象定义属性。未来，后者会被逐渐废除，请从现在开始就使用 Reflect.defineProperty 代替它")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("MyDate")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*…*/")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("MyDate")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'now'")]),s._v(", {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("now")]),s._v("()\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("MyDate")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'now'")]),s._v(", {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("now")]),s._v("()\n})\n")])]),a("p",[s._v("这个方法可以与 Proxy.defineProperty 配合使用")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Proxy")]),s._v("(\n\t{},\n\t{\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, prop, descriptor")]),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(descriptor)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, prop, descriptor)\n\t\t}\n\t}\n)\n\np."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bar'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// {value: "bar", writable: true, enumerable: true, configurable: true}')]),s._v("\n\np."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("foo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// "bar"')]),s._v("\n")])]),a("p",[s._v("上面代码中，Proxy.defineProperty 对属性赋值设置了拦截，然后使用 Reflect.defineProperty 完成了赋值。")]),a("h3",[s._v("Reflect.getOwnPropertyDescriptor(target, propertyKey)")]),a("p",[s._v("Reflect.getOwnPropertyDescriptor 基本等同于 Object.getOwnPropertyDescriptor，用于得到指定属性的描述对象，将来会替代掉后者")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {}\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hidden'")]),s._v(", {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("enumerable")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n})\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" theDescriptor = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getOwnPropertyDescriptor")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hidden'")]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" theDescriptor = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getOwnPropertyDescriptor")]),s._v("(myObject, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hidden'")]),s._v(")\n")])]),a("p",[s._v("Reflect.getOwnPropertyDescriptor 和 Object.getOwnPropertyDescriptor 的一个区别是，如果第一个参数不是对象，Object.getOwnPropertyDescriptor(1, 'foo')不报错，返回 undefined，而 Reflect.getOwnPropertyDescriptor(1, 'foo')会抛出错误，表示参数非法")]),a("h3",[s._v("Reflect.isExtensible (target)")]),a("p",[s._v("Reflect.isExtensible 方法对应 Object.isExtensible，返回一个布尔值，表示当前对象是否可扩展")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" myObject = {}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("isExtensible")]),s._v("(myObject) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("isExtensible")]),s._v("(myObject) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),a("p",[s._v("如果参数不是对象，Object.isExtensible 会返回 false，因为非对象本来就是不可扩展的，而 Reflect.isExtensible 会报错")]),a("h3",[s._v("Reflect.preventExtensions(target)")]),a("p",[s._v("Reflect.preventExtensions 对应 Object.preventExtensions 方法，用于让一个对象变为不可扩展。它返回一个布尔值，表示是否操作成功")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("preventExtensions")]),s._v("(myObject) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Object {}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("preventExtensions")]),s._v("(myObject) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// true")]),s._v("\n")])]),a("h3",[s._v("Reflect.ownKeys (target)")]),a("p",[s._v("Reflect.ownKeys 方法用于返回对象的所有属性，基本等同于 Object.getOwnPropertyNames 与 Object.getOwnPropertySymbols 之和")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myObject = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("foo")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("bar")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(",\n\t["),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Symbol")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("for")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'baz'")]),s._v(")]: "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(",\n\t["),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Symbol")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("for")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'bing'")]),s._v(")]: "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 旧写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getOwnPropertyNames")]),s._v("(myObject)\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ['foo', 'bar']")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getOwnPropertySymbols")]),s._v("(myObject)\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//[Symbol(baz), Symbol(bing)]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 新写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Reflect")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ownKeys")]),s._v("(myObject)\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// ['foo', 'bar', Symbol(baz), Symbol(bing)]")]),s._v("\n")])]),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6997212505579716644"}},[s._v("作者：artist")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},b5a1:function(s,t,a){"use strict";a.r(t);var r={common:{hello:"hello英文"}};t["default"]=r},b5c6:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h3",[s._v("jsconfigh 或者 tsconfig")]),r("blockquote",[r("p",[r("a",{attrs:{href:"https://www.jianshu.com/p/b0ec870ddfdf"}},[s._v("参考:Xindot-vscode 中的 jsconfig.json")]),s._v(" webpack 模板里 import 路径中@符号有什么用 这是 webpack 的路径别名，相关定义在这里：")])]),r("h5",[s._v("什么是 jsconfig.json？")]),r("p",[s._v("目录中存在 jsconfig.json 文件表示该目录是 JavaScript 项目的根目录。jsconfig.json 文件指定根文件和 JavaScript 语言服务提供的功能选项。")]),r("blockquote",[r("p",[r("strong",[s._v("提示：")]),s._v(" 如果您不使用 JavaScript，则无需担心 jsconfig.json。 **提示：**jsconfig.json 源于 tsconfig.json，是 TypeScript 的配置文件。jsconfig.json 相当于 tsconfig.json 的“allowJs”属性设置为 true")])]),r("h4",[s._v("为什么我需要一个 jsconfig.json 文件？")]),r("blockquote",[r("p",[s._v("告诉编辑器，该项目是 JavaScript 项目，创造 JavaScript 语言编辑环境以及提供输入智能感知")])]),r("p",[s._v("Visual Studio Code 的 JavaScript 支持可以在两种不同的模式下运行：")]),r("ul",[r("li",[s._v("文件范围 - 没有 jsconfig.json：在此模式下，在 Visual Studio Code 中打开的 JavaScript 文件被视为独立单元。 只要文件 a.js 没有显式引用文件 b.ts（使用///引用指令或 CommonJS 模块），两个文件之间就没有共同的项目上下文。")]),r("li",[s._v("显式项目 - 使用 jsconfig.json：JavaScript 项目是通过 jsconfig.json 文件定义的。 目录中存在此类文件表示该目录是 JavaScript 项目的根目录。 文件本身可以选择列出属于项目的文件，要从项目中排除的文件，以及编译器选项（见下文）。")])]),r("p",[s._v("当您在工作空间中有一个定义项目上下文的 jsconfig.json 文件时，"),r("strong",[s._v("JavaScript 体验会得到改进")]),s._v("。 因此，当您在新工作空间中打开 JavaScript 文件时，我们提供了一个创建 jsconfig.json 文件的提示。")]),r("h4",[s._v("jsconfig.json 的位置")]),r("p",[s._v("我们通过创建 jsconfig.json 文件将我们代码的这一部分（我们网站的客户端）定义为 JavaScript 项目。 将文件放在 JavaScript 代码的根目录下，如下所示。")]),r("p",[r("img",{attrs:{src:a("18ac"),alt:"jsconfig setup"}})]),r("p",[s._v("在更复杂的项目中，您可能在工作空间中定义了多个 jsconfig.json 文件。 您将需要执行此操作，以便不将一个项目中的代码建议为 IntelliSense 以在另一个项目中进行编码。 下面的插图是一个带有客户端和服务器文件夹的项目，显示了两个单独的 JavaScript 项目。")]),r("p",[r("img",{attrs:{src:a("3056"),alt:"jsconfig setup"}})]),r("h4",[s._v("例子")]),r("p",[s._v("默认情况下，JavaScript 语言服务将分析并为 JavaScript 项目中的所有文件提供 IntelliSense(智能感知)。 您需要指定要排除或包含的文件，以便提供正确的 IntelliSense。")]),r("h4",[s._v("使用“exclude”属性")]),r("p",[s._v("exclude 属性（glob 模式）告诉语言服务哪些文件是什么文件，而不是源代码的一部分。 这使性能保持在较高水平。 如果 IntelliSense 速度很慢，请将文件夹添加到排除列表中（如果检测到速度减慢，VS 代码将提示您执行此操作）。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"compilerOptions"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"module"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"commonjs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"target"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"es6"')]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"exclude"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"node_modules"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("blockquote",[r("p",[r("strong",[s._v("提示：")]),s._v(" 您将要排除由构建过程生成的文件（例如，dist 目录）。 这些文件会导致建议显示两次，并会降低 IntelliSense 的速度。")])]),r("h4",[s._v("使用“包含”属性")]),r("p",[s._v("或者，可以使用 include 属性（glob 模式）显式设置项目中的文件。如果不存在 include 属性，则默认为包含目录和子目录中的所有文件。如果指定了 include 属性，则只包括这些文件。下面是一个具有显式 include 属性的示例。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"compilerOptions"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"module"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"commonjs"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"target"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"es6"')]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"include"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"src/**/*"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("blockquote",[r("p",[r("strong",[s._v("提示：")]),s._v(" exclude 和 include 中的文件路径是相对于 jsconfig.json 的位置。")])]),r("h4",[s._v("jsconfig 选项")]),r("p",[s._v("下面是 jsconfig“compilerOptions”来配置 JavaScript 语言支持。")]),r("blockquote",[r("p",[r("strong",[s._v("提示：")]),s._v(" 不要被 compilerOptions 混淆。 此属性的存在是因为 jsconfig.json 是 tsconfig.json 的后代，后者用于编译 TypeScript。")])]),r("table",[r("thead",[r("tr",[r("th",[s._v("选项")]),r("th",[s._v("描述")])])]),r("tbody",[r("tr",[r("td",[r("code",{pre:!0},[s._v("noLib")])]),r("td",[s._v("Do not include the default library file (lib.d.ts)")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("target")])]),r("td",[s._v('Specifies which default library (lib.d.ts) to use. The values are "es3", "es5", "es6", "es2015", "es2016", "es2017", "es2018", "es2019", "es2020", "esnext".')])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("module")])]),r("td",[s._v('Specifies the module system, when generating module code. The values are "amd", "commonJS", "es2015", "es6", "esnext", "none", "system", "umd".')])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("moduleResolution")])]),r("td",[s._v('Specifies how modules are resolved for imports. The values are "node" and "classic".')])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("checkJs")])]),r("td",[s._v("Enable type checking on JavaScript files.")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("experimentalDecorators")])]),r("td",[s._v("Enables experimental support for proposed ES decorators.")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("allowSyntheticDefaultImports")])]),r("td",[s._v("Allow default imports from modules with no default export. This does not affect code emit, just type checking.")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("baseUrl")])]),r("td",[s._v("Base directory to resolve non-relative module names.")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("paths")])]),r("td",[s._v("Specify path mapping to be computed relative to baseUrl option.")])])])]),r("h4",[s._v("使用 webpack 别名(让 webpack 别名智能感知)")]),r("p",[s._v("要使 IntelliSense 使用 webpack 别名，您需要使用 glob 模式指定 paths 键。 例如，对于别名'ClientApp'(或@)：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"compilerOptions"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"baseUrl"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"."')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"paths"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"ClientApp/*"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./ClientApp/*"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("p",[s._v("然后使用别名")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Something")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ClientApp/foo'")]),s._v("\n")])]),r("h4",[s._v("最佳实践")]),r("p",[s._v("只要有可能，您应该使用不属于项目源代码的 JavaScript 文件排除文件夹。")]),r("blockquote",[r("p",[r("strong",[s._v("提示：")]),s._v(" 如果工作空间中没有 jsconfig.json，则默认情况下，VS Code 将排除 node_modules 文件夹。")])]),r("p",[s._v("下面是一个将常见项目组件映射到其安装文件夹的表，建议将其排除在外：")]),r("table",[r("thead",[r("tr",[r("th",[s._v("组件")]),r("th",[s._v("要排除的文件夹")])])]),r("tbody",[r("tr",[r("td",[r("code",{pre:!0},[s._v("node")])]),r("td",[s._v("exclude the "),r("code",{pre:!0},[s._v("node_modules")]),s._v(" folder")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("webpack")]),s._v(", "),r("code",{pre:!0},[s._v("webpack-dev-server")])]),r("td",[s._v("exclude the content folder, for example "),r("code",{pre:!0},[s._v("dist")]),s._v(".")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("bower")])]),r("td",[s._v("exclude the "),r("code",{pre:!0},[s._v("bower_components")]),s._v(" folder")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("ember")])]),r("td",[s._v("exclude the "),r("code",{pre:!0},[s._v("tmp")]),s._v(" and "),r("code",{pre:!0},[s._v("temp")]),s._v(" folders")])]),r("tr",[r("td",[r("code",{pre:!0},[s._v("jspm")])]),r("td",[s._v("exclude the "),r("code",{pre:!0},[s._v("jspm_packages")]),s._v(" folder")])])])]),r("p",[s._v("当您的 JavaScript 项目变得太大而性能变慢时，通常是因为像 node_modules 这样的库文件夹。 如果 VS Code 检测到您的项目变得过大，则会提示您编辑排除列表。")]),r("blockquote",[r("p",[r("strong",[s._v("提示：")]),s._v(" 有时无法正确选择更改配置，例如添加或编辑 jsconfig.json 文件。 运行 Reload JavaScript Project 命令应重新加载项目并获取更改。")])]),r("h4",[s._v("使用 TypeScript 编译器进行低级编译")]),r("p",[s._v("当 tsc 用于将 ES6 JavaScript 向下级编译为旧版本时，jsconfig.json 中的以下编译器选项适用：")]),r("table",[r("thead",[r("tr",[r("th",[s._v("选项")]),r("th",[s._v("描述")])])]),r("tbody",[r("tr",[r("td",[s._v("module")]),r("td",[s._v("指定模块代码生成。 值为“commonjs”，“system”，“umd”，“amd”，“es6”，“es2015”")])]),r("tr",[r("td",[s._v("diagnostics")]),r("td",[s._v("显示诊断信息。")])]),r("tr",[r("td",[s._v("emitBOM")]),r("td",[s._v("在输出文件的开头发出 UTF-8 字节顺序标记（BOM）。")])]),r("tr",[r("td",[s._v("inlineSourceMap")]),r("td",[s._v("使用源映射发出单个文件，而不是使用单独的文件。")])]),r("tr",[r("td",[s._v("inlineSources")]),r("td",[s._v("在单个文件中将源与源图一起发出; 需要设置--inlineSourceMap。")])]),r("tr",[r("td",[s._v("jsx")]),r("td",[s._v("指定 JSX 代码生成：“保留”或“反应”?。")])]),r("tr",[r("td",[s._v("reactNamespace")]),r("td",[s._v("指定在针对'react'JSX 发出的目标时为 createElement 和__spread 调用的对象。")])]),r("tr",[r("td",[s._v("mapRoot")]),r("td",[s._v("将位置指定为字符串中的 uri，其中调试器应该找到映射文件而不是生成的位置。")])]),r("tr",[r("td",[s._v("noEmit")]),r("td",[s._v("不发起输出。")])]),r("tr",[r("td",[s._v("noEmitHelpers")]),r("td",[s._v("不在编译输出中生成自定义辅助函数，如__extends。")])]),r("tr",[r("td",[s._v("noEmitOnError")]),r("td",[s._v("如果报告任何类型检查错误，不发起输出。")])]),r("tr",[r("td",[s._v("noResolve")]),r("td",[s._v("不将三斜杠引用或模块导入目标解析为输入文件。")])]),r("tr",[r("td",[s._v("outFile")]),r("td",[s._v("连接并将输出发送到单个文件。")])]),r("tr",[r("td",[s._v("outDir")]),r("td",[s._v("将输出结构重定向到目录。")])]),r("tr",[r("td",[s._v("removeComments")]),r("td",[s._v("不向输出发出注释。")])]),r("tr",[r("td",[s._v("rootDir")]),r("td",[s._v("指定输入文件的根目录。用于通过--outDir 控制输出目录结构。")])]),r("tr",[r("td",[s._v("sourceMap")]),r("td",[s._v("生成相应的'.map'文件。")])]),r("tr",[r("td",[s._v("sourceRoot")]),r("td",[s._v("指定调试器应该找到 JavaScript 文件而不是源位置的位置。")])]),r("tr",[r("td",[s._v("stripInternal")]),r("td",[s._v("不为具有'@internal'注释的代码发出声明。")])]),r("tr",[r("td",[s._v("watch")]),r("td",[s._v("监听输入文件。")])]),r("tr",[r("td",[s._v("emitDecoratorMetadata")]),r("td",[s._v("在源中为装饰声明发出设计类型元数据。")])]),r("tr",[r("td",[s._v("noImplicitUseStrict")]),r("td",[s._v("不在模块输出中发出“use strict”指令。")])])])]),r("blockquote",[r("p",[r("a",{attrs:{href:"https://github.com/Microsoft/TypeScript/wiki/JavaScript-Language-Service-in-Visual-Studio"}},[s._v("JavaScript 语言服务")]),s._v(" > "),r("a",{attrs:{href:"https://www.w3cschool.cn/typescript/typescript-tsconfig-json.html"}},[s._v("TypeScript tsconfig.json")]),s._v(" > "),r("a",{attrs:{href:"https://www.cnblogs.com/xdlysk/p/5183604.html"}},[s._v("glob 模式")]),s._v(" > "),r("a",{attrs:{href:"https://en.wikipedia.org/wiki/Glob_(programming)"}},[s._v("glob (programming)")])])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},b646:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h2",[s._v("Vue@hook 那些事")]),a("p",[s._v("组件内的生命周期函数在执行结束后会 $emit 一个 hook + 生命周期名字 的自定义事件。")]),a("blockquote",[a("p",[s._v("当组件内的生命周期函数在执行结束后 $emit 的自定义事件。不仅仅可以在组件内被监听到。vue 的语法决定了这些事件也可以被父组件 v-on 监听到。")])]),a("h3",[s._v("常规使用")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[s._v("// 父组件\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"parent"')]),s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Child")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@hook:mounted")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"doSomething"')]),s._v("/>")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("doSomething")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'父组件监听到子组件 mounted 钩子函数'")]),s._v(")\n    }\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n\n//子组件\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"child"')]),s._v(">")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("mounted")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'触发mounted事件...'")]),s._v(")\n  }\n}\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n\n")])]),a("h3",[s._v("组件内使用:清除定时器@hook 写法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 常规写法")]),s._v("\n<script>\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("mounted")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("timer")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setInterval")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" { ... }, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(");\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("beforeDestroy")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("clearInterval")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("timer")]),s._v(");\n    }\n  };\n<\/script>\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// vm.$once( event, callback )监听一个自定义事件，但是只触发一次。一旦触发之后，监听器就会被移除。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// @hook写法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"language-xml"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("mounted")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" timer = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setInterval")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" { ... }, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(");\n      "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".$once("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'hook:beforeDestroy'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("clearInterval")]),s._v("(timer);)\n    }\n  };\n")]),a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")])]),s._v("\n")])]),a("h3",[s._v("设想一个需求场景")]),a("p",[s._v("一个页面里需要加载一个可视化组件，这个组件里面的逻辑极其复杂，存在大量复杂的计算。复杂到什么程度呢？就是从页面开始计算到计算完毕大概需要 1s。而且这个时间也是随着数据的多少而变化。 而且这个组件是一个已经离职的同时开发的，里面用到了多个 worker 协助计算，因为属于纯可视化组件，里面只有一个 canvas。因为考虑可能要在多个地方使用，就并没有引入主题相关的 loading。我们的需求是什么呢？")]),a("p",[s._v("就是在数据渲染到页面的之前让页面 loading。mounted 之后停止 loading。beforeUpdata 时开始 loading。updatad 之后停止 loading。")]),a("p",[s._v("最简单的方法就是改写组件的生命周期函数，使其在 mounted/beforeUpdata /updatad 时通知父组件显示或者隐藏 loading。")]),a("p",[s._v('这样做显示不好，因为侵入了自组件的逻辑，增加的逻辑也和组件本身的功能好不关联。最好的办法就是使用 v-on="hook:xxx" 的方式：')]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[a("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("v-chart")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@hook:mounted")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"loading = false"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@hook:beforeUpdated")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"loading = true"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@hook:updated")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"loading = false"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":data")]),s._v("="),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"data"')]),s._v("\n/>")]),s._v("\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},ba25:function(s,t,a){var r={"./en.js":"3fab","./product/en.js":"f7f2","./product/zh.js":"234e","./shop/en.js":"b5a1","./shop/zh.js":"5191","./zh.js":"9df6"};function e(s){var t=n(s);return a(t)}function n(s){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return r[s]}e.keys=function(){return Object.keys(r)},e.resolve=n,s.exports=e,e.id="ba25"},c00a:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("svg",{class:s.svgClass,attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":s.iconName}})])},e=[],n={name:"SvgIcon",props:{iconClass:{type:String,required:!0},className:{type:String,default:""}},computed:{iconName:function(){return"#icon-".concat(this.iconClass)},svgClass:function(){return this.className?"svg-icon "+this.className:"svg-icon"}}},l=n,p=(a("d00f"),a("2877")),_=Object(p["a"])(l,r,e,!1,null,"60076847",null);t["default"]=_.exports},c0a5:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("TypeScript 入门以及进阶")]),s._m(0),a("h2",[s._v("函数定义")]),s._m(1),a("h2",[s._v("继承")]),s._m(2),a("h2",[s._v("小技巧")]),s._m(3),a("h2",[s._v("Intersection Types(交叉类型)")]),a("p",[s._v("交叉类型是一种将多种类型组合为一种类型的方法。这意味着你可以将给定的类型 A 与类型 B 或更多类型合并，并获得具有所有属性的单个类型。")]),s._m(4),a("h2",[s._v("Union Types(联合类型)")]),a("p",[s._v("联合类型使你可以赋予同一个变量不同的类型")]),s._m(5),a("h2",[s._v("Generic Types(泛型)")]),a("p",[s._v("泛型类型是复用给定类型的一部分的一种方式。它有助于捕获作为参数传递的类型 T。")]),s._m(6),a("h3",[s._v("泛型函数")]),a("p",[s._v("如何创建泛型类型:需要使用<>并将 T(名称可自定义)作为参数传递。 🌰 栗子中， 我们给 showType 添加了类型变量 T。T 帮助我们捕获用户传入的参数的类型(比如：number/string)之后我们就可以使用这个类型")]),s._m(7),a("h3",[s._v("泛型接口")]),a("p",[s._v("注:泛型变量约束了整个接口后，在实现的时候，必须指定一个类型")]),s._m(8),a("h3",[s._v("多参数的泛型类型")]),a("p",[s._v("泛型类型可以接收多个参数。")]),s._m(9),a("h2",[s._v("Utility Types(内置类型)")]),a("h3",[s._v("Partial")]),a("p",[s._v("允许你将 T 类型的所有属性设为可选。它将在每一个字段后面添加一个?")]),s._m(10),a("h3",[s._v("Required")]),a("p",[s._v("将某个类型里的属性全部变为必选项")]),s._m(11),a("h3",[s._v("Readonly")]),a("p",[s._v("会转换类型的所有属性，以使它们无法被修改")]),s._m(12),a("p",[s._v("除此之外，你还可以在指定的属性前面使用关键字 readonly 使其无法被重新赋值")]),s._m(13),a("h3",[s._v("Pick")]),a("p",[s._v("此方法允许你从一个已存在的类型 T 中选择一些属性作为 K, 从而创建一个新类型")]),a("p",[s._v("即 抽取一个类型/接口中的一些子集作为一个新的类型")]),s._m(14),s._m(15),a("p",[s._v("例子")]),s._m(16),a("h3",[s._v("Omit")]),a("p",[s._v("Omit 的作用与 Pick 类型正好相反。不是选择元素，而是从类型 T 中删除 K 个属性。")]),s._m(17),a("h3",[s._v("Extract")]),s._m(18),s._m(19),a("h2",[s._v("Exclude")]),a("p",[s._v("Exclude<T, U> --从 T 中剔除可以赋值给 U 的类型。")]),s._m(20),a("p",[s._v("上面的代码可以看到，属性 firstName 和 lastName 在 SecondType 类型中不存在。通过使用 Extract 关键字，我们可以获得 T 中存在而 U 中不存在的字段")]),a("h3",[s._v("Record")]),a("p",[s._v("Record<K,T> 给定类型 T 的一组属性 K 的类型,将一个类型的属性映射到另一个类型的属性时，Record 非常方便。")]),s._m(21),a("h3",[s._v("NonNullable")]),a("p",[s._v("NonNullable"),a("t",[s._v(" 从 T 中剔除 null 和 undefined")])],1),s._m(22),a("h2",[s._v("Mapped Types( 映射类型)")]),a("p",[s._v("映射类型允许你从一个旧的类型，生成一个新的类型。")]),s._m(23),s._m(24),a("h4",[s._v("Type Guards(类型保护)")]),a("h3",[s._v("typeof")]),s._m(25),a("h3",[s._v("instanceof")]),s._m(26),a("h3",[s._v("in")]),a("p",[s._v("使用 in 检查参数对象上是否存在属性 x")]),s._m(27),a("h2",[s._v("interface 和 type 的区别")]),a("p",[s._v("明人不说暗话，直接上区别，下面是引入 ts 官方术语")]),s._m(28),a("p",[s._v("翻译大概如下")]),s._m(29)])])])},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/Mx8kirBth0vSXf-rzxu2eQ"}},[s._v("原文")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("test")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("age: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")])]),s._v(") =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("void")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("age")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(age)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("hello")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("x: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")])]),s._v("): "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("void")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(x)\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 箭头函数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("arrow")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("y: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")])]),s._v(") =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("void")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("y")]),s._v(" =>")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(y)\n}\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("age")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Girl")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'women'")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Man")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Person")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'man'")]),s._v("\n}\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义一个对象;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Funny")]),s._v(" {\n\t["),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("key")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("]: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("any")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 定义一个数组")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Arr")]),s._v(" {\n\t["),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("key")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("]: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("any")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// keyof　去获取对象key")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Women")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("age")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("sex")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'women'")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("height")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" key = keyof "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Women")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// "age" | "sex" | "height"')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("LeftType")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("left")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("RightType")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("right")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("IntersectionType")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("LeftType")]),s._v(" & "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("RightType")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: IntersectionType")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("left")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("right")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: {id: 1, left: "test", right: "test"}')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("UnionType")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("arg: UnionType")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arg)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: test")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: 7")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("blockquote",[a("p",[a("strong",[s._v("优点:")]),s._v(" 创建可重用的函数，一个函数可以支持多种类型的数据。这样开发者就可以根据自己的数据类型来使用函数")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" showType<T>("),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("args")]),s._v(": T) {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: "test"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: 1")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("GenericType")]),s._v("<T> {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": T\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: GenericType<"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v(">")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: {id: 1, name: "test"}')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showTypeTwo")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: GenericType<"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v(">")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showTypeTwo")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(" })\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("GenericType")]),s._v("<T, U> {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": T\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": U\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: GenericType<"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v(">")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: {id: 1, name: "test"}')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showTypeTwo")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: GenericType<"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("[]>")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showTypeTwo")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'001'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'This'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'is'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Test'")]),s._v("] })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: {id: "001", name: Array["This", "is", "a", "Test"]}')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("PartialType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*\n等效于\ninterface PartialType {\n  id?: number\n  firstName?: string\n  lastName?: string\n}\n*/")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: Partial<PartialType>")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: {id: 1}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'John'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Doe'")]),s._v(" })\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("RequiredType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\tfirstName?: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\tlastName?: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: Required<RequiredType>")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ReadonlyType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: Readonly<ReadonlyType>")]),s._v(") {\n\targs."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Doe'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: Cannot assign to 'id' because it is a read-only property.")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ReadonlyType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("readonly")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("blockquote",[a("p",[s._v("T 代表要抽取的对象 K 有一个约束: 一定是来自 T 所有属性字面量的联合类型 新的类型/属性一定要从 K 中选取， T 是要从中选择元素的类型,K 是要选择的属性(可以使使用联合类型来选择多个字段)")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/**\n    源码实现\n * From T, pick a set of properties whose keys are in the union K\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Pick")]),s._v("<T, K "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" keyof T> = {\n\t[P "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" K]: T[P]\n}\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("PickType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: Pick<PickType, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'firstName'")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'lastName'")]),s._v(">")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'John'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Doe'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: {firstName: "John"}')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: Object literal may only specify known properties, and 'id' does not exist in type 'Pick<PickType, \"firstName\" | \"lastName\">'")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("PickType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: Omit<PickType, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'firstName'")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'lastName'")]),s._v(">")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: {id: 7}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'John'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: Object literal may only specify known properties, and 'firstName' does not exist in type 'Pick<PickType, \"id\">'")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("p",[s._v("Extract<T, U> : 提取 T 中可以赋值给 U 的类型-- "),a("strong",[s._v("取交集")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FirstType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SecondType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("address")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("city")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ExtractType")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Extract")]),s._v("<keyof "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FirstType")]),s._v(", keyof "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SecondType")]),s._v(">\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: "id"')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FirstType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("firstName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("lastName")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SecondType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("address")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("city")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ExcludeType")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Exclude")]),s._v("<keyof "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FirstType")]),s._v(", keyof "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SecondType")]),s._v(">\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output; "firstName" | "lastName"')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EmployeeType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fullname")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("role")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("employees")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Record")]),s._v("<"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("EmployeeType")]),s._v("> = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(": { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fullname")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'John Doe'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("role")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Designer'")]),s._v(" },\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(": { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fullname")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Ibrahima Fall'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("role")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Developer'")]),s._v(" },\n\t"),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(": { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fullname")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Sara Duckson'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("role")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Developer'")]),s._v(" }\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 0: { id: 1, fullname: "John Doe", role: "Designer" },')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 1: { id: 2, fullname: "Ibrahima Fall", role: "Developer" },')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 2: { id: 3, fullname: "Sara Duckson", role: "Developer" }')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("NonNullableType")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("args: NonNullable<NonNullableType>")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(args)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'test'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: "test"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: 1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: Argument of type 'null' is not assignable to parameter of type 'string | number'.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("undefined")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: Argument of type 'undefined' is not assignable to parameter of type 'string | number'.")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*\nReadonly， Partial和 Pick是同态的，但 Record不是。因为 Record并不需要输入类型来拷贝属性，所以它不属于同态：\n*/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Readonly")]),s._v("<T> = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("readonly")]),s._v(" [P "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" keyof T]: T[P]\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Partial")]),s._v("<T> = {\n\t[P "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" keyof T]?: T[P]\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Pick")]),s._v("<T, K "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" keyof T> = {\n\t[P "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" K]: T[P]\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Record")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("type")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("StringMap")]),s._v("<T> = {\n\t[P "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" keyof T]: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("arg: StringMap<{ id: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("; name: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v(" }>")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arg)\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Test'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: Type 'number' is not assignable to type 'string'.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'testId'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'This is a Test'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// Output: {id: "testId", name: "This is a Test"}')]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("x: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v(" | "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")])]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" x === "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'number'")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`The result is "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${x + x}")]),s._v("`")]),s._v("\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`This operation can't be done on a "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("typeof")]),s._v(" x}")]),s._v("`")]),s._v(")\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"I\'m not a number"')]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: This operation can't be done on a string")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: The result is 14")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Foo")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Hello World'")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Bar")]),s._v(" {\n\tbaz = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'123'")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("arg: Foo | Bar")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (arg "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Foo")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(arg."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("())\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" arg."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("bar")]),s._v("()\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'The type is not supported'")]),s._v(")\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Foo")]),s._v("())\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: Hello World")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Bar")]),s._v("())\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: The type is not supported")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-ts"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FirstType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("x")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("number")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("interface")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("SecondType")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("y")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("string")]),s._v("\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("arg: FirstType | SecondType")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'x'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" arg) {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`The property "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${arg.x}")]),s._v(" exists`")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`The property "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${arg.x}")]),s._v(" exists`")]),s._v("\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Error")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'This type is not expected'")]),s._v(")\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("x")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("7")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Output: The property 7 exists")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("showType")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("y")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'ccc'")]),s._v(" })\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// Error: This type is not expected")]),s._v("\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("An interface can be named in an extends or implements clause, but a type alias for an object type literal cannot.\nAn interface can have multiple merged declarations, but a type alias for an object type literal cannot.\n")])])},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("一个接口可以通过扩展或实现被重新生命,但一个对象的type不能。 　　一个接口可以有多个合并的声明,但是一个对象的类型不能。\n")])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},c5a8:function(s,t,a){"use strict";a.r(t),t["default"]=[]},c653:function(s,t,a){var r={"./shop.js":"ce84","./user.js":"0f9a"};function e(s){var t=n(s);return a(t)}function n(s){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return r[s]}e.keys=function(){return Object.keys(r)},e.resolve=n,s.exports=e,e.id="c653"},c82c:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("关于 Vue 的相关知识")]),r("p",[s._v("收集简短一些 vue 相关的东西 "),r("a",{attrs:{href:"https://juejin.cn/post/7023197006998978597#heading-64"}},[r("img",{attrs:{src:"https://img.shields.io/badge/%E5%8F%82%E8%80%83%E6%8E%98%E9%87%91-%E8%8A%B1%E5%93%A8-blue",alt:"Juejin"}})]),r("a",{attrs:{href:"https://shields.io"}},[r("img",{attrs:{src:"https://img.shields.io/badge/%E5%9B%BE%E6%A0%87-%E7%94%9F%E6%88%90-yellow",alt:"图标"}})])]),r("h3",[s._v("MVVM 的理解")]),r("p",[s._v("MVVM 是 Model-View-ViewModel 的缩写。Model 代表数据层，可定义修改数据、编写业务逻辑。View 代表视图层，负责将数据渲染成页面。ViewModel 负责监听数据层数据变化，控制视图层行为交互，简单讲，就是同步数据层和视图层的对象。ViewModel 通过双向绑定把 View 和 Model 层连接起来，且同步工作无需人为干涉，使开发人员只关注业务逻辑，无需频繁操作 DOM，不需关注数据状态的同步问题。 "),r("img",{attrs:{src:a("d30d"),alt:""}})]),r("h3",[s._v("如何实现 v-model")]),r("p",[s._v("v-model 指令用于实现 input、select 等表单元素的双向绑定，是个语法糖。 原生 input 元素若是 text/textarea 类型，使用 value 属性和 input 事件。 原生 input 元素若是 radio/checkbox 类型，使用 checked 属性和 change 事件。 原生 select 元素，使用 value 属性和 change 事件。 input 元素上使用 v-model 等价于")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":value")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"message"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@input")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"message = $event.target.value"')]),s._v(" />")]),s._v("\n")])]),r("h3",[s._v("如何理解 Vue 单向数据流 props")]),r("p",[s._v("我们经常说 Vue 的双向绑定，其实是在单向绑定的基础上给元素添加 input/change 事件，来动态修改视图。Vue 组件间传递数据仍然是单项的，即父组件传递到子组件。子组件内部可以定义依赖 props 中的值，但无权修改父组件传递的数据，这样做防止子组件意外变更父组件的状态，导致应用数据流向难以理解。")]),r("blockquote",[r("p",[s._v("如果在子组件内部直接更改 prop，会遇到警告处理。")])]),r("h4",[s._v("2 种定义依赖 props 中的值")]),r("ul",[r("li",[s._v("通过 data 定义属性并将 prop 作为初始值。")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("<script>\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'initialNumber'")]),s._v("],\n "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("data")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n   "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n     "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("number")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("initailNumber")]),s._v("\n   }\n }\n}\n<\/script>\n")])]),r("ul",[r("li",[s._v("用 computed 计算属性去定义依赖 prop 的值。若页面会更改当前值，得分 get 和 set 方法。")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("<script>\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": ["),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'size'")]),s._v("],\n "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("computed")]),s._v(": {\n   "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("normalizedSize")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n     "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("size")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("trim")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toLowerCase")]),s._v("()\n   }\n }\n}\n</sciprt>\n")])]),r("h3",[s._v("关于 Vue.observable 的了解")]),r("p",[s._v("Vue.observable 可使对象可响应。返回的对象可直接用于渲染函数和计算属性内，并且在发生变更时触发相应的更新。也可以作为最小化的跨组件状态存储器。")]),r("blockquote",[r("p",[s._v("适用的场景：在项目中没有大量的非父子组件通信时，可以使用 Vue.observable 去替代 eventBus 和 vuex 方案。 用法如下")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// store.js")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" state = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("observable")]),s._v("({\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("count")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n})\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" mutations = {\n  "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setCount")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("count")]),s._v(") {\n    state."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("count")]),s._v(" = count\n  }\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// vue 文件")]),s._v("\n<template>\n  "),r("span",{pre:!0,attrs:{class:"language-xml"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("{{ count }}"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")])]),s._v("\n</template>\n"),r("span",{pre:!0,attrs:{class:"language-xml"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { state, mutation } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./store.js'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("computed")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("count")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" state."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("count")]),s._v("\n    }\n  }\n}\n")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")])]),s._v("\n")])]),r("h3",[s._v("Vue.directive 有写过么，应用场景有哪些？")]),r("p",[s._v("Vue.directive 可以注册全局指令和局部指令。")]),r("p",[s._v("指令定义函数提供如下钩子函数")]),r("ul",[r("li",[s._v("bind：指令第一次绑定到元素时调用（只调用一次）")]),r("li",[s._v("inserted: 被绑定元素插入父节点时使用（父节点存在即可调用）")]),r("li",[s._v("update：被绑定元素所在模板更新时调用，不论绑定值是否变化。通过比较更新前后的绑定值。")]),r("li",[s._v("componentUpdated: 被绑定元素所在模板完成一次更新周期时调用。")]),r("li",[s._v("unbind: 只调用一次，指令与元素解绑时调用。 我项目中有涉及 一键 copy、权限控制 都可以用指令的方式控制，目的就是简化我们的工作量")])]),r("h3",[s._v("组件中的 data 为什么是个函数")]),r("p",[s._v("在 vue 中，对于组件有一个很明显的特性是在于它是可以被复用的，组件是可以被复用的，那么注册了一个组件本质上就是创建了一个组件构造器的引用，而真正当我们使用组件的时候才会去将组件实例化，")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 创建一个组件")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" {}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" component1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" component2 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" data = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("b")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("\n}\ncomponent1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v(" = data\ncomponent2."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v(" = data\ncomponent1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(component1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 3")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(component2."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 3")]),s._v("\n")])]),r("p",[s._v("通过上面代码可以得知实例化的 component1 和 component2 确是共享同样的 data 对象，所以当你修改 component1 的 data 中的一个属性的时候，component2 中的 data 也会发生改变，这明显不是我们想要的效果。")]),r("blockquote",[r("p",[s._v("这跟 vue 组件复用，并且里面 data 是独立得相违背 当我们的 data 是一个函数的时候，每一个实例的 data 属性都是独立的，不会相互影响了。于是把 data 改成 function")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" {}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" component1 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" component2 = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 改造成function形式类似于vue组件的data")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" data = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(",\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("b")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("\n\t}\n}\ncomponent1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("data")]),s._v("()\ncomponent2."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("data")]),s._v("()\ncomponent1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(component1."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 3")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(component2."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("data")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 2")]),s._v("\n")])]),r("h3",[s._v("Vue 父组件和子组件生命周期执行顺序")]),r("h4",[s._v("加载渲染过程")]),r("p",[s._v("父先创建，才能有子；子创建完成，父才完整。 顺序：父 beforeCreate -> 父 created -> 父 beforeMount -> 子 beforeCreate -> 子 created -> 子 beforeMount -> 子 mounted -> 父 mounted")]),r("h4",[s._v("子组件更新过程")]),r("ul",[r("li",[s._v("子组件更新 影响到 父组件的情况。 顺序：父 beforeUpdate -> 子 beforeUpdate -> 子 updated -> 父 updated")]),r("li",[s._v("子组件更新 不影响到 父组件的情况。 顺序：子 beforeUpdate -> 子 updated")])]),r("h4",[s._v("父组件更新过程")]),r("ul",[r("li",[s._v("父组件更新 影响到 子组件的情况。 顺序：父 beforeUpdate -> 子 beforeUpdate -> 子 updated -> 父 updated")]),r("li",[s._v("父组件更新 不影响到 子组件的情况 顺序：父 beforeUpdate -> 父 updated")])]),r("h4",[s._v("销毁过程")]),r("p",[s._v("顺序：父 beforeDestroy -> 子 beforeDestroy -> 子 destroyed -> 父 destroyed")]),r("h3",[s._v("$nextTick()")]),r("p",[s._v("因为 $nextTick() 返回一个 Promise 对象，所以你可以使用新的 ES2017 async/await 语法完成相同的事情：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("updateMessage")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("message")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'已更新'")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//在这里可以看出，message并没有立刻被执行")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//要理解页面刷新和代码执行速度的差别")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//通常我们在页面上立刻就能看到结果，那是因为一轮队列执行其实很快，感觉不出DOM刷新的过程和所耗费的时间")]),s._v("\n      "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//但对于代码的执行，属于即刻级别，DOM没更新就是没更新，就是会有问题")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$el")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("textContent")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// => '未更新'")]),s._v("\n\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(".$nextTick()\n    "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$el")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("textContent")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// => '已更新'")]),s._v("\n  }\n}\n")])]),r("h3",[s._v("vue 使用展示 md 文件")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[s._v("npm i vue-markdown-loader -D\nnpm i  vue-loader vue-template-compiler -D\n# 样式\nnpm i github-markdown-css -D\nnpm i highlight.js -D\n")])]),r("h5",[s._v("在 vue.config.js 中配置")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[s._v("config."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("module")]),s._v("\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("rule")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'md'")]),s._v(")\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\.md/")]),s._v(")\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("use")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue-loader'")]),s._v(")\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("loader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue-loader'")]),s._v(")\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("end")]),s._v("()\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("use")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue-markdown-loader'")]),s._v(")\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("loader")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue-markdown-loader/lib/markdown-compiler'")]),s._v(")\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("options")]),s._v("({\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("raw")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t})\n")])]),r("h5",[s._v("具体使用方法")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("\x3c!-- class markdown-body 必须加，否则标签样式会出现问题 --\x3e")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"markdown-body"')]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("markdown")]),s._v(" />")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 引入 markdown 文件，引入后是一个组件，需要在 components 中注册")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" markdown "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'xxxx.md'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 代码高亮")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'highlight.js/styles/github.css'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 其他元素使用 github 的样式")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'github-markdown-css'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("components")]),s._v(": {\n    markdown\n  }\n}\n")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n")])]),r("h3",[s._v("watch 同时执行多个方法")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("watch")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 你可以传入回调数组，它们会被逐一调用")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(": [\n      "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'handle1'")]),s._v(",\n      "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handle2")]),s._v(" (val, oldVal) { "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* ... */")]),s._v(" },\n      {\n        "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("handler")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handle3")]),s._v(" (val, oldVal) { "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* ... */")]),s._v(" },\n        "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* ... */")]),s._v("\n      }\n    ],\n  }\n")])]),r("h3",[s._v("批量导入组件")]),r("p",[s._v("如果你恰好使用了 webpack (或在内部使用了 webpack 的 Vue CLI 3+)，那么就可以使用  require.context  方法批量导入这些组件，然后将它们注册为全局组件，这样就可以在任何地方直接使用它们了，再也不用为导入的事情烦恼了！")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-javascript"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" upperFirst "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'lodash/upperFirst'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" camelCase "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'lodash/camelCase'")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" requireComponent = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("context")]),s._v("(\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 其组件目录的相对路径")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./components'")]),s._v(",\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 是否查询其子目录")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(",\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 匹配基础组件文件名的正则表达式")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/Base[A-Z]\\w+\\.(vue|js)$/")]),s._v("\n)\n\nrequireComponent."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("keys")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("forEach")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fileName")]),s._v(" =>")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取组件的配置，也就是具体内容，具体定义，组件的本身代码")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" componentConfig = requireComponent(fileName)\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取组件的 PascalCase 命名，用来规范化组件名")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" componentName = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("upperFirst")]),s._v("(\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("camelCase")]),s._v("(\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 获取和目录深度无关的文件名")]),s._v("\n\t\t\tfileName\n\t\t\t\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("split")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'/'")]),s._v(")\n\t\t\t\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("pop")]),s._v("()\n\t\t\t\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("replace")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\.\\w+$/")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("''")]),s._v(")\n\t\t)\n\t)\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 全局注册组件")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("component")]),s._v("(\n\t\tcomponentName,\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 如果这个组件选项是通过 `export default` 导出的，")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 那么就会优先使用 `.default`，")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 否则回退到使用模块的根。")]),s._v("\n\t\tcomponentConfig."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("default")]),s._v(" || componentConfig\n\t)\n})\n")])]),r("h3",[s._v("vue 相当于 v-model 的修饰符.sync")]),r("p",[s._v("下面是 elementUI 的示例，内部组件可以该表")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("el-dialog")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("title")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"提示"')]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":visible.sync")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"dialogVisible"')]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("width")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"30%"')]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v(":before-close")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"handleClose"')]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("这是一段信息"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("slot")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"footer"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("class")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"dialog-footer"')]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("el-button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"dialogVisible = false"')]),s._v(">")]),s._v("取 消"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("el-button")]),s._v(">")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("el-button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"primary"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("@click")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"dialogVisible = false"')]),s._v(">")]),s._v("确 定"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("el-button")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("span")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("el-dialog")]),s._v(">")]),s._v("\n")])]),r("h3",[s._v("关于 mixin 的理解，有什么应用场景")]),r("blockquote",[r("p",[s._v("定义：mixin（混入），提供了一种非常灵活的方式，来分发 Vue 组件中可复用的功能")])]),r("p",[s._v("mixin 混入分全局混入和局部混入，本质是 JS 对象，如 data、components、computed、methods 等。")]),r("p",[s._v("全局混入不推荐使用，会影响后续每个 Vue 实例的创建。局部混入可提取组件间相同的代码，进行逻辑复用。")]),r("p",[s._v("适用场景：如多个页面具备相同的悬浮定位浮窗，可尝试用 mixin 封装。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// customFloatDialog.js")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" customFloatDialog = {\n  "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("data")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n    "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n      "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("visible")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n    }\n  },\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n    "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("toggleShow")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n      "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("visible")]),s._v(" = !"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("visible")]),s._v("\n    }\n  }\n}\n<\/script>\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//需要引入的组件")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"language-xml"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("div")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("template")]),s._v(">")])]),s._v("\n"),r("span",{pre:!0,attrs:{class:"language-xml"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" { customFloatDialog } "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./customFloatDialog.js'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" {\n  "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("mixins")]),s._v(": [customFloatDialog],\n}\n")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")])]),s._v("\n")])]),r("h3",[s._v("Vue 组件间通讯方式")]),r("h4",[s._v("父子组件通讯")]),r("ul",[r("li",[s._v("props 与 $emit")]),r("li",[s._v("$parent 与 $children")])]),r("h4",[s._v("隔代组件通讯")]),r("ul",[r("li",[s._v("$attrs 与 $listeners")]),r("li",[s._v("provide 和 inject")])]),r("h4",[s._v("父子、兄弟、隔代组件通讯")]),r("ul",[r("li",[s._v("EventBus")]),r("li",[s._v("observal")]),r("li",[s._v("Vuex")])]),r("h3",[s._v("常用的修饰符")]),r("h4",[s._v("表单修饰符")]),r("ul",[r("li",[s._v("lazy: 失去焦点后同步信息")]),r("li",[s._v("trim: 自动过滤首尾空格")]),r("li",[s._v("number: 输入值转为数值类型")]),r("li",[s._v("native：绑定一个原生的事件")])]),r("h4",[s._v("事件修饰符")]),r("ul",[r("li",[s._v("stop：阻止冒泡")]),r("li",[s._v("prevent：阻止默认行为")]),r("li",[s._v("self：仅绑定元素自身触发")]),r("li",[s._v("once：只触发一次")])]),r("h4",[s._v("鼠标按钮修饰符")]),r("ul",[r("li",[s._v("left：鼠标左键")]),r("li",[s._v("right：鼠标右键")]),r("li",[s._v("middle：鼠标中间键")])]),r("h3",[s._v("Vue 性能优化")]),r("ul",[r("li",[s._v("非响应式数据通过 Object.freeze 冻结数据")]),r("li",[s._v("嵌套层级不要过深")]),r("li",[s._v("computed 和 watch 区别使用")]),r("li",[s._v("v-if 和 v-show 区别使用")]),r("li",[s._v("v-for 避免和 v-if 一起使用，且绑定 key 值要唯一")]),r("li",[s._v("列表数据过多采用分页或者虚拟列表")]),r("li",[s._v("组件销毁后清除定时器和事件")]),r("li",[s._v("图片懒加载")]),r("li",[s._v("路由懒加载")]),r("li",[s._v("防抖、节流")]),r("li",[s._v("按需引入外部库")]),r("li",[s._v("keep-alive 缓存使用")]),r("li",[s._v("服务端渲染和预渲染")])]),r("h3",[s._v("Vue 项目按住 ctrl + 鼠标左键跳转对应组件")]),r("p",[s._v("安装 "),r("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=shenjiaolong.vue-helper"}},[s._v("vue Helper")]),s._v(" 插件")]),r("p",[s._v("设置 ==》 扩展 == 》 vue Helper ==》setting.json 编辑 添加或者修改如下内容")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"vue-helper.alias"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n　　"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"@"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"src"')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"vue-helper.componentPrefix"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n　　"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"alias"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n　　"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"path"')]),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"src"')]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),r("h3",[s._v("vue2.0 和 vue3.0 底层 Api")]),r("p",[s._v("大家如果使用过 Vue2.0 ，那你一定知道 Object.defineProperty 方法，这个 API 就是 Vue 响应式的核心，用于观测数据的变化，但是它存在一些弊端： 对象类型数据里添加一对新的 key/value 或删除一对已有的 key/value 时，它是无法观测到的，导致当我们对 object 数据添加或删除值时，无法通知依赖，无法驱动视图进行响应式更新。 对于数组变化侦测是 Vue2.0 通过拦截器实现的，也就是说只要是通过数组原型上的方法对数组进行操作就都可以侦测到，但是通过数组的下标来操作数据，就需要手动去操作了。")]),r("p",[s._v("Proxy 可以理解成，在目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。Proxy 这个词的原意是代理，用在这里表示由它来“代理”某些操作，可以译为“代理器”。 Proxy 是一个天然的拦截器、代理器。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},ca0a:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-31-48.ec977759.png"},ce84:function(s,t,a){"use strict";a.r(t);a("99af");var r={namespaced:!0,state:{crateTime:"11111"},mutations:{changeTime:function(s){s.crateTime="".concat((new Date).getHours()," + ").concat((new Date).getMinutes()," + ").concat((new Date).getSeconds())}},getters:{dateNow:function(s){return"现在是".concat(s.crateTime)}}};t["default"]=r},d00f:function(s,t,a){"use strict";a("a4d8")},d035:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("new Vue()初始化过程")]),a("p",[s._v("new Vue() new 关键字在 js 中是实例化一个对象，在本质上 Vue 是一个类，在 js 中 通过 Function 来实现")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// src/core/instance/index.js")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("() "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//会执行this._init()方法")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Vue")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("options")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (process."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("env")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("NODE_ENV")]),s._v(" !== "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'production'")]),s._v(" && !("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v(")) {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("warn")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Vue is a constructor and should be called with the `new` keyword'")]),s._v(")\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_init")]),s._v("(options)\n}\n")])]),a("p",[s._v("init 方法")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_init")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("options?: "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("Object")])]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("vm")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// a uid")]),s._v("\n\tvm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_uid")]),s._v(" = uid++\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" startTag, endTag\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* istanbul ignore if */")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (process."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("env")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("NODE_ENV")]),s._v(" !== "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'production'")]),s._v(" && config."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("performance")]),s._v(" && mark) {\n\t\tstartTag = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`vue-perf-start:"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${vm._uid}")]),s._v("`")]),s._v("\n\t\tendTag = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`vue-perf-end:"),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${vm._uid}")]),s._v("`")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("mark")]),s._v("(startTag)\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// a flag to avoid this being observed")]),s._v("\n\tvm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_isVue")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// merge options")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (options && options."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_isComponent")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// optimize internal component instantiation")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// since dynamic options merging is pretty slow, and none of the")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// internal component options needs special treatment.")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initInternalComponent")]),s._v("(vm, options)\n\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\tvm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$options")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("mergeOptions")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolveConstructorOptions")]),s._v("(vm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("constructor")]),s._v("), options || {}, vm)\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* istanbul ignore else */")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (process."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("env")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("NODE_ENV")]),s._v(" !== "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'production'")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initProxy")]),s._v("(vm)\n\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\tvm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_renderProxy")]),s._v(" = vm\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// expose real self")]),s._v("\n\tvm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_self")]),s._v(" = vm\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initLifecycle")]),s._v("(vm)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initEvents")]),s._v("(vm)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initRender")]),s._v("(vm)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("callHook")]),s._v("(vm, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'beforeCreate'")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initInjections")]),s._v("(vm) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// resolve injections before data/props")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initState")]),s._v("(vm)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("initProvide")]),s._v("(vm) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// resolve provide after data/props")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("callHook")]),s._v("(vm, "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'created'")]),s._v(")\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* istanbul ignore if */")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (process."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("env")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("NODE_ENV")]),s._v(" !== "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'production'")]),s._v(" && config."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("performance")]),s._v(" && mark) {\n\t\tvm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("_name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("formatComponentName")]),s._v("(vm, "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("mark")]),s._v("(endTag)\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("measure")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`vue "),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${vm._name}")]),s._v(" init`")]),s._v(", startTag, endTag)\n\t}\n\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (vm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$options")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("el")]),s._v(") {\n\t\tvm.$mount(vm."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("$options")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("el")]),s._v(")\n\t}\n}\n")])]),a("p",[s._v("例子")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'vue'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("App")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./App.vue'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" router "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./router'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" store "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./store'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" el = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Vue")]),s._v("({\n\trouter,\n\tstore,\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("render")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("h")]),s._v(" =>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("h")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("App")]),s._v(")\n})\nel.$mount("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'#app'")]),s._v(")\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},d22b:function(s,t,a){s.exports=a.p+"img/6023914857.99cb6884.jpg"},d30d:function(s,t,a){s.exports=a.p+"img/1635473838853.0aad5dac.png"},d36b:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_23-04-24.e06dd505.png"},d68e:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h2",[s._v("关于 Promise 以及 async await")]),a("blockquote",[a("p",[s._v("什么是 promise？我们用 Promise 来解决什么问题？")])]),a("h3",[s._v("什么是异步，什么是同步")]),a("ul",[a("li",[s._v("同步：你打电话去书店订书，老板说我查查，你不挂电话在等待，老板把查到的结果告诉你，这期间你不能做自己的事情")]),a("li",[s._v("异步：你打电话去书店订书，老板说我查查，回头告诉你，你把电话挂了，先去做自己的事情")])]),a("h3",[s._v("什么是 promise？")]),a("blockquote",[a("p",[a("strong",[s._v("Promise 是异步编程的一种解决方案")])])]),a("p",[s._v("从语法上讲，promise 是一个对象，从它可以获取异步操作的消息；从本意上讲，它是承诺，承诺它过一段时间会给你一个结果。")]),a("p",[s._v("promise 有三种状态："),a("strong",[s._v("pending(等待状态)，fulfiled(成功状态)，rejected(失败状态)")]),s._v("，状态一旦改变，就不会再变。创造 promise 实例后，它会立即执行")]),a("h3",[s._v("我们用 Promise 来解决什么问题？")]),a("ul",[a("li",[s._v("同步的方式写异步的代码，用来解决回调地狱问题。")]),a("li",[s._v("此外，promise 对象提供统一的接口，使得控制异步操作更加容易。")])]),a("h3",[s._v("Promise 构造函数")]),a("p",[s._v("使用 new 来创建一个 promise 对象，接收一个回调函数，这个回调函数接收两个参数，分别是 resolve 和 reject；resolve 代表成功状态，reject 代表失败状态；")]),a("h4",[s._v("then()方法")]),a("p",[s._v("通过 then 方法的回调可以获取到这两个状态，第一个是 resolve 成功状态的返回值，第二是 reject 失败状态的返回值")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v(" = ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") => {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("111")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("status")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(" })\n\t\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reject")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("status")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v(" })\n\t\t\t}\n\t\t}, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(")\n\t})\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("(\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("res")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'res'")]),s._v(", res)\n\t},\n\t"),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("er")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'er'")]),s._v(", er)\n\t}\n)\n")])]),a("h4",[s._v("catch()方法")]),a("p",[s._v("它可以和 then 的第二个参数一样，用来获取 reject 的状态的返回值")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test")]),s._v("()\n\t."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("res")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'res'")]),s._v(", res)\n\t})\n\t."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("catch")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("er")]),s._v(" =>")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'er'")]),s._v(", er)\n\t})\n")])]),a("h4",[s._v("all()方法")]),a("p",[a("strong",[s._v("在所有异步操作执行完后才执行回调")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test1")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("status")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" })\n\t\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reject")]),s._v("({\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("status")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v(",\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t\t\t})\n\t\t\t}\n\t\t}, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(")\n\t})\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" p\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test2")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("({ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("status")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(" })\n\t\t\t} "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("reject")]),s._v("({\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("status")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("500")]),s._v(",\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("data")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t\t\t})\n\t\t\t}\n\t\t}, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(")\n\t})\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" p\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("all")]),s._v("(["),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test1")]),s._v("(), "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test2")]),s._v("()])."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("results")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'results'")]),s._v(", results)\n})\n")])]),a("h4",[s._v("race()方法")]),a("p",[s._v("race 按字面解释，就是赛跑的意思,race 的用法与 all 一样， "),a("strong",[s._v("race 的话只要有一个异步操作执行完毕，就立刻执行 then 回调")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("all")]),s._v("(["),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test1")]),s._v("(), "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("test2")]),s._v("()])."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("then")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("results")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'results'")]),s._v(", results)\n})\n")])]),a("h3",[s._v("什么是 async await")]),a("p",[s._v("我总结为一句话 async/await 是 generator + Promise 的语法糖，它用同步方式执行异步代码")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},da6a:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v(".npmrc 文件的作用")]),a("p",[s._v("有些项目根目录下可能有个.npmrc 的文件，点开一看只有一句话 registry=http://registry.npm.xxxx.com 就是 npm 仓库镜像地址")]),a("p",[s._v("在 npm i 的时候，如果项目根目录下有这个文件，会自动从这个镜像地址下安装 node_modules，不需要手动设置镜像地址")]),a("h4",[s._v("常用配置")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v('home=https://npm.taobao.org\nregistry=https://registry.npm.taobao.org/\nsass_binary_site="https://npm.taobao.org/mirrors/node-sass/"\nphantomjs_cdnurl="http://cnpmjs.org/downloads"\nelectron_mirror="https://npm.taobao.org/mirrors/electron/"\nsqlite3_binary_host_mirror="https://foxgis.oss-cn-shanghai.aliyuncs.com/"\nprofiler_binary_host_mirror="https://npm.taobao.org/mirrors/node-inspector/"\nchromedriver_cdnurl="https://cdn.npm.taobao.org/dist/chromedriver"\n')])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},db16:function(s,t,a){"use strict";a.r(t),t["default"]=[]},dd71:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-10_21-56-22.044f22fc.png"},dfb2:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("Github ssh-keygen ed25519 以及 ssh agent 使用")]),a("p",[a("a",{attrs:{href:"https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#adding-your-ssh-key-to-the-ssh-agent"}},[s._v("About SSH key generation")])]),a("h2",[s._v("ssh-key ed25519 生成步骤")]),a("ol",[a("li",[s._v("打开 git bash")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("ssh-keygen -t ed25519 -C "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"your_email@example.com"')]),s._v("\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("看到如下提示时")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[s._v("Enter a file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]\n")])]),a("p",[s._v("按下回车，表示把 ssh key 放在默认地址")]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("设置 ssh key 密码")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[s._v("Enter passphrase (empty for no passphrase): [Type a passphrase]\nEnter same passphrase again: [Type passphrase again]\n")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("启动 ssh agent")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("$(ssh-agent -s)")]),s._v('"')]),s._v("\n")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("使用如下指令把 ssh key 添加到 ssh-agent 中：")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("ssh-add ~/.ssh/id_ed25519\n")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("打开 GitHub 登录 并且添加你的 SSH keys")])]),a("h2",[s._v("ssh agent 使用")]),a("h3",[s._v("连接 ssh agent(git bash 中使用该命令)")]),a("p",[s._v("测试 ssh agent 是否连接成功(git bash 中使用该命令)")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("ssh -T git@github.com\n")])]),a("p",[s._v("如果你看到一下信息,则表示 ssh 连接成功了")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-text"}},[s._v("Hi username! You've successfully authenticated, but GitHub does not provide shell access\n")])]),a("h3",[s._v("ssh-agent 启用 (git bash 中使用该命令)")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("eval")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("$(ssh-agent -s)")]),s._v('"')]),s._v("\n")])]),a("h3",[s._v("windows 杀进程（powershell 中使用）")]),a("p",[s._v("ssh agent 使用完毕应该关闭该进程 查看进程以及 pid")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("tasklist\n")])]),a("p",[s._v("通过 pid 关闭进程")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("taskkill /pid PID /F\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},e0db:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("JavaScript 设计模式之装饰者模式")]),r("p",[s._v("参考"),r("a",{attrs:{href:"https://juejin.cn/post/6844903673756123144#heading-0"}},[s._v("使用装饰者模式做有趣的事情")]),s._v(" 参考"),r("a",{attrs:{href:"https://juejin.cn/post/6844904016279765000#heading-7"}},[s._v("JavaScript 设计模式之装饰者模式")]),s._v(" 参考"),r("a",{attrs:{href:"https://juejin.cn/post/6844903873262387208#heading-7"}},[s._v("5 分钟即可掌握的 JavaScript 装饰者模式与 AOP")])]),r("h2",[s._v("什么是 AOP")]),r("p",[s._v('想必大家对"餐前洗手、饭后漱口"都不陌生。这句标语其实就是 AOP 在生活中的例子：吃饭这个动作相当于切点，我们可以在这个切点前、后插入其它如洗手等动作。 AOP（Aspect-Oriented Programming）：面向切面编程，是对 OOP 的补充。利用 AOP 可以对业务逻辑的各个部分进行隔离，也可以隔离业务无关的功能比如日志上报、异常处理等，从而使得业务逻辑各部分之间的耦合度降低，提高业务无关的功能的复用性，也就提高了开发的效率。 在 JavaScript 中，我们可以通过装饰者模式来实现 AOP，但是两者并不是一个维度的概念。'),r("strong",[s._v("AOP 是一种编程范式，而装饰者是一种设计模式")]),s._v("。")]),r("h2",[s._v("什么是装饰者模式")]),r("p",[s._v("在传统的面向对象(OOP)语言中，给对象添加功能常常使用继承的方式，但是继承的方式并不灵活，还会带来许多问题：一方面会导致超类和子类之间存在强耦合性，当超类改变时，子类也会随之改变；另一方面，继承这种功能复用方式通常被称为“白箱复用”，“白箱”是相对可见性而言的，在继承方式中，超类的内部细节是对子类可见的，继承常常被认为破坏了封装性。")]),r("p",[s._v("使用继承还会带来另外一个问题，在完成一些功能复用的同时，有可能创建出大量的子类，使子类的数量呈爆炸性增长。比如现在有 4 种型号的自行车，我们为每种自行车都定义了一个单独的类。现在要给每种自行车都装上前灯、尾灯和铃铛这 3 种配件。如果使用继承的方式来给每种自行车创建子类，则需要 4×3=12 个子类。但是如果把前灯、尾灯、铃铛这些对象动态组合到自行车上面，则只需要额外增加 3 个类。")]),r("p",[s._v("这种给对象动态地增加职责的方式称为装饰者（decorator）模式。装饰者模式能够在不改变对象自身的基础上，在程序运行期间给对象动态地添加职责。跟继承相比，装饰者是一种更轻便灵活的做法，这是一种“即用即付”的方式，比如天冷了就多穿一件外套，需要飞行时就在头上插一支竹蜻蜓，遇到一堆食尸鬼时就点开 AOE（范围攻击）技能")]),r("p",[s._v("当我们拍了一张照片准备发朋友圈时，许多小伙伴会选择给照片加上滤镜。同一张照片、不同的滤镜组合起来就会有不同的体验。这里实际上就应用了装饰者模式：是通过滤镜装饰了照片。在不改变对象（照片）的情况下动态的为其添加功能（滤镜）；这就是生活中装饰者模式的例子了。")]),r("p",[s._v("自行车的基类如下：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Bicycle")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 其它方法")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("wash")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ride")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("200")]),s._v("\n\t}\n}\n")])]),r("p",[s._v("装饰者模式基类")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("BicycleDecotator")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("bicycle")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bicycle")]),s._v(" = bicycle\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("wash")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bicycle")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("wash")]),s._v("()\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ride")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bicycle")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ride")]),s._v("()\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bicycle")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("()\n\t}\n}\n")])]),r("p",[s._v("这个基类其实没有做什么事情，"),r("strong",[s._v("它只是接受一个 Bicycle 实例，实现其对应的方法，并且将调用其方法返回而已")]),s._v("。")]),r("p",[s._v("有了这个基类之后，我们就可以根据我们的需求对原来的 Bicycle 类为所欲为了。比如我可以创建一个添加了前灯的装饰器以及添加了尾灯的装饰器：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("HeadLightDecorator")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("BicycleDecorator")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("bicycle")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(bicycle)\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bicycle")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("() + "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("20")]),s._v("\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("TailLightDecorator")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("BicycleDecorator")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("bicycle")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(bicycle)\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("bicycle")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("() + "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("20")]),s._v("\n\t}\n}\n")])]),r("p",[s._v("接下来我们就可以来对其自由组合了:")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" bicycle = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Bicycle")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(bicycle."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 200")]),s._v("\nbicycle = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("HeadLightDecorator")]),s._v("(bicycle) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加了前灯的自行车")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(bicycle."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 220")]),s._v("\nbicycle = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("TailLightDecorator")]),s._v("(bicycle) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加了前灯和尾灯的自行车")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(bicycle."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getPrice")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 240")]),s._v("\n")])]),r("p",[r("strong",[s._v("这样写的好处是什么呢?假设说我们有 10 个配件，那么我们只需要写 10 个配件装饰器，然后就可以任意搭配成不同配件的自行车并计算价格。而如果是按照子类的实现方式的话，10 个配件可能就需要有几百个甚至上千个子类了")])]),r("p",[s._v("从例子中我们可以看出装饰者模式的适用场合：")]),r("ol",[r("li",[s._v("如果你需要为类增添特性或职责，可是从类派生子类的解决方法并不太现实的情况下，就应该使用装饰者模式。")]),r("li",[s._v("在例子中，我们并没有对原来的 Bicycle 基类进行修改，因此也不会对原有的代码产生副作用。我们只是在原有的基础上增添了一些功能。因此，如果想为对象增添特性又不想改变使用该对象的代码的话，则可以采用装饰者模式。")])]),r("p",[s._v("又例如拍照的时候要加上各种各样的滤镜")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 相机拍照的时候要加上各种各样的滤镜")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Camera")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("photo")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("photo")]),s._v(" = photo\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 拍照")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("photo")]),s._v("\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 滤镜装饰基类")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("FilterDecotator")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("camera")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("camera")]),s._v(" = camera\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("camera")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("()\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 港风滤镜")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("HongkongFilterDecotator")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("FilterDecotator")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("camera")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(camera)\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("camera")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("() + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' 港风滤镜；'")]),s._v("\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 日系滤镜")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JapaneseFilterDecotator")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("extends")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_ inherited__"}},[s._v("FilterDecotator")]),s._v(" {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("camera")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("super")]),s._v("(camera)\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("camera")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("() + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("' 日系滤镜；'")]),s._v("\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" camera = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Camera")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'美女靓照'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(camera."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("())\ncamera = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("HongkongFilterDecotator")]),s._v("(camera) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加了港风滤镜")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(camera."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("())\ncamera = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JapaneseFilterDecotator")]),s._v("(camera) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 添加了日系滤镜")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(camera."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("()) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 美女靓照 港风滤镜； 日系滤镜；")]),s._v("\n")])]),r("p",[r("strong",[s._v("装饰者模式除了可以应用在类上之外，还可以应用在函数上（其实这就是高阶函数）")]),s._v("。比如，我们想测量函数的执行时间，那么我可以写这么一个装饰器：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("func")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'func'")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("timeProfileDecorator")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("func")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" startTime = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("()\n\t\tfunc."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", ...args)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" elapserdTime = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("()."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getTime")]),s._v("() - startTime."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getTime")]),s._v("()\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`该函数消耗了"),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${elapserdTime}")]),s._v("ms`")]),s._v(")\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" newFunc = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("timeProfileDecorator")]),s._v("(func)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("newFunc")]),s._v("())\n")])]),r("h2",[s._v("模拟传统面向对象语言的装饰者模式")]),r("p",[s._v("首先要提出来的是，作为一门解释执行的语言，给 JavaScript 中的对象动态添加或者改变职责是一件再简单不过的事情，虽然这种做法改动了对象自身，跟传统定义中的装饰者模式并不一样，但这无疑更符合 JavaScript 的语言特色。代码如下：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" obj = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sven'")]),s._v(",\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("address")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'深圳市'")]),s._v("\n}\nobj."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("address")]),s._v(" = obj."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("address")]),s._v(" + "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'福田区'")]),s._v("\n")])]),r("p",[s._v("传统面向对象语言中的装饰者模式在 JavaScript 中适用的场景并不多，如上面代码所示，通常我们并不太介意改动对象自身。尽管如此，但是我们还是稍微模拟一下传统面向对象语言中的装饰者模式实现。")]),r("p",[s._v("假设我们在编写一个飞机大战的游戏，随着经验值的增加，我们操作的飞机对象可以升级成更厉害的飞机，一开始这些飞机只能发射普通的子弹，升到第二级时可以发射导弹，升到第三级时可以发射原子弹。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 建立一架飞机")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Plane")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {}\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 飞机有发射普通子弹的方法")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Plane")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'发射普通子弹'")]),s._v(")\n}\n")])]),r("p",[s._v("接下来增加两个装饰类，分别是导弹和原子弹：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("MissileDecorator")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("plane")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("plane")]),s._v(" = plane\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("MissileDecorator")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("plane")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fire")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'发射导弹'")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("AtomDecorator")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("plane")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("plane")]),s._v(" = plane\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("AtomDecorator")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("plane")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fire")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'发射原子弹'")]),s._v(")\n}\n")])]),r("p",[s._v("导弹类和原子弹类的构造函数都接受参数 plane 对象，并且保存好这个参数，在它们的 fire 方法中，除了执行自身的操作之外，还调用 plane 对象的 fire 方法。")]),r("p",[r("strong",[s._v("这种给对象动态增加职责的方式，并没有真正地改动对象自身，而是将对象放入另一个对象之中，这些对象以一条链的方式进行引用，形成一个聚合对象")]),s._v("。这些对象都拥有相同的接口（fire 方法），当请求达到链中的某个对象时，这个对象会执行自身的操作，随后把请求转发给链中的下一个对象。")]),r("p",[r("strong",[s._v("因为装饰者对象和它所装饰的对象拥有一致的接口")]),s._v("，所以它们对使用该对象的客户来说是透明的，被装饰的对象也并不需要了解它曾经被装饰过，这种透明性使得我们可以递归地嵌套任意多个装饰者对象，如图所示。 "),r("img",{attrs:{src:a("2db3"),alt:""}})]),r("p",[s._v("最后看看测试结果：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" plane = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Plane")]),s._v("()\nplane = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("MissileDecorator")]),s._v("(plane)\nplane = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("AtomDecorator")]),s._v("(plane)\nplane."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fire")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 分别输出： 发射普通子弹、发射导弹、发射原子弹")]),s._v("\n")])]),r("h2",[s._v("回到 JavaScript 的装饰者")]),r("p",[s._v("JavaScript 语言动态改变对象相当容易，我们可以直接改写对象或者对象的某个方法，并不需要使用“类”来实现装饰者模式，代码如下：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" plane = {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("fire")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'发射普通子弹'")]),s._v(")\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" missileDecorator = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'发射导弹'")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" atomDecorator = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'发射原子弹'")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fire1 = plane."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v("\nplane."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fire1")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("missileDecorator")]),s._v("()\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" fire2 = plane."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v("\nplane."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("fire")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fire2")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("atomDecorator")]),s._v("()\n}\nplane."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fire")]),s._v("()\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 分别输出： 发射普通子弹、发射导弹、发射原子弹")]),s._v("\n")])]),r("h2",[s._v("装饰函数")]),r("p",[s._v("在 JavaScript 中，几乎一切都是对象，其中函数又被称为一等对象。在平时的开发工作中，也许大部分时间都在和函数打交道。在 JavaScript 中可以很方便地给某个对象扩展属性和方法，但却很难在不改动某个函数源代码的情况下，给该函数添加一些额外的功能。在代码的运行期间，我们很难切入某个函数的执行环境。")]),r("p",[r("strong",[s._v("要想为函数添加一些功能，最简单粗暴的方式就是直接改写该函数，但这是最差的办法，直接违反了开放-封闭原则")]),s._v("：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" a = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 改成：")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" a = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n}\n")])]),r("p",[s._v("很多时候我们不想去碰原函数，也许原函数是由其他同事编写的，里面的实现非常杂乱。甚至在一个古老的项目中，这个函数的源代码被隐藏在一个我们不愿碰触的阴暗角落里。现在需要一个办法，在不改变函数源代码的情况下，能给函数增加功能，这正是开放-封闭原则给我们指出的光明道路。")]),r("p",[s._v("通过保存原引用的方式就可以改写某个函数：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" a = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _a = a\na = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_a")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("a")]),s._v("()\n")])]),r("p",[s._v("这是实际开发中很常见的一种做法，比如我们想给 "),r("code",{pre:!0},[s._v("window")]),s._v(" 绑定 "),r("code",{pre:!0},[s._v("onload")]),s._v(" 事件，但是又不确定这个事件是不是已经被其他人绑定过，为了避免覆盖掉之前的"),r("code",{pre:!0},[s._v("window.onload")]),s._v(" 函数中的行为，我们一般都会先保存好原先的 "),r("code",{pre:!0},[s._v("window.onload")]),s._v("，把它放入新的 "),r("code",{pre:!0},[s._v("window.onload")]),s._v(" 里执行：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _onload = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" || "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {}\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_onload")]),s._v("()\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n}\n")])]),r("p",[s._v("这样的代码当然是符合开放-封闭原则的，我们在增加新功能的时候，确实没有修改原来的 "),r("code",{pre:!0},[s._v("window.onload")]),s._v(" 代码，但是这种方式存在以下两个问题。")]),r("ul",[r("li",[s._v("必须维护"),r("code",{pre:!0},[s._v("_onload")]),s._v(" 这个中间变量，虽然看起来并不起眼，但如果函数的装饰链较长，或者需要装饰的函数变多，这些中间变量的数量也会越来越多。")]),r("li",[s._v("其实还遇到了 this 被劫持的问题，在 "),r("code",{pre:!0},[s._v("window.onload")]),s._v("的例子中没有这个烦恼，是因为调用普通函数"),r("code",{pre:!0},[s._v("_onload")]),s._v(" 时，this 也指向 window，跟调用 "),r("code",{pre:!0},[s._v("window.onload")]),s._v(" 时一样（函数作为对象的方法被调用时，this 指向该对象，所以此处 this 也只指向 window）。现在把 "),r("code",{pre:!0},[s._v("window.onload")]),s._v(" 换成 "),r("code",{pre:!0},[s._v("document.getElementById")]),s._v("，代码如下:")])]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _getElementById = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getElementById")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getElementById")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("id")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_getElementById")]),s._v("(id) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (1)")]),s._v("\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n")])]),r("p",[s._v("执行这段代码，我们看到在弹出 alert(1)之后，紧接着控制台抛出了异常：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 输出： Uncaught TypeError: Illegal invocation")]),s._v("\n")])]),r("p",[s._v("异常发生在(1) 处的"),r("code",{pre:!0},[s._v("_getElementById(id)")]),s._v("这句代码上，此时"),r("code",{pre:!0},[s._v("_getElementById")]),s._v(" 是一个全局函数，当调用一个全局函数时，this 是指向 window 的，而 "),r("code",{pre:!0},[s._v("document.getElementById")]),s._v(" 方法的内部实现需要使用 this 引用，this 在这个方法内预期是指向 document，而不 是 window, 这是错误发生的原因，所以使用现在的方式给函数增加功能并不保险。")]),r("p",[s._v("改进后的代码可以满足需求，我们要手动把 document 当作上下文 this 传入"),r("code",{pre:!0},[s._v("_getElementById")]),s._v("：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button"')]),s._v(">")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _getElementById = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getElementById")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getElementById")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" _getElementById."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n\t")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n")])]),r("p",[r("strong",[s._v("但这样做显然很不方便，下面我们引入 AOP，来提供一种完美的方法给函数动态增加功能")])]),r("h2",[s._v("用 AOP 装饰函数")]),r("p",[s._v("首先给出 Function.prototype.before 方法和 Function.prototype.after 方法：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("before")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("beforefn")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" __self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 保存原函数的引用")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 返回包含了原函数和新函数的"代理"函数')]),s._v("\n\t\tbeforefn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 执行新函数，且保证this不被劫持，新函数接受的参数")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 也会被原封不动地传入原函数，新函数在原函数之前执行")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" __self."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 执行原函数并返回原函数的执行结果，")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 并且保证this不被劫持")]),s._v("\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("after")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("afterfn")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" __self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ret = __self."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\tafterfn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ret\n\t}\n}\n")])]),r("p",[r("code",{pre:!0},[s._v("Function.prototype.before")]),s._v("接受一个函数当作参数，这个函数即为新添加的函数，它装载了新添加的功能代码。")]),r("p",[s._v("接下来把当前的 this 保存起来，这个 this 指向原函数，然后返回一个“代理”函数，这个“代理”函数只是结构上像代理而已，并不承担代理的职责（比如控制对象的访问等）。它的工作是把请求分别转发给新添加的函数和原函数，且负责保证它们的执行顺序，让新添加的函数在原函数之前执行（前置装饰），这样就实现了动态装饰的效果。")]),r("p",[s._v("我们注意到，通过"),r("code",{pre:!0},[s._v("Function.prototype.apply")]),s._v("来动态传入正确的 this，保证了函数在被装饰之后，this 不会被劫持。")]),r("p",[r("code",{pre:!0},[s._v("Function.prototype.after")]),s._v("的原理跟"),r("code",{pre:!0},[s._v("Function.prototype.before")]),s._v("一模一样，唯一不同的地方在于让新添加的函数在原函数执行之后再执行。")]),r("p",[s._v("下面来试试用 Function.prototype.before 的威力:")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button"')]),s._v(">")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("before")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("beforefn")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" __self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t\tbeforefn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" __self."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t\t}\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getElementById")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("getElementById")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("before")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n\t\t})\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" button = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(button)\n\t")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n")])]),r("p",[s._v("再回到 window.onload 的例子，看看用 Function.prototype.after 来增加新的 window.onload 事件是多么简单：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = ("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" || "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {})\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("after")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n\t})\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("after")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(")\n\t})\n\t."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("after")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(")\n\t})\n")])]),r("p",[s._v("值得提到的是，上面的 AOP 实现是在"),r("code",{pre:!0},[s._v("Function.prototype")]),s._v("上添加 before 和 after 方法，但许多人不喜欢这种污染原型的方式，那么我 们可以做一些变通，把原函数和新函数都作为参数传入 before 或者 after 方法：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" before = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("fn, beforefn")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tbeforefn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" fn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t}\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" a = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("before")]),s._v("(\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(")\n\t},\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n\t}\n)\na = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("before")]),s._v("(a, "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("alert")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n})\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("a")]),s._v("()\n")])]),r("h2",[s._v("AOP 的应用实例")]),r("p",[s._v("用 AOP 装饰函数的技巧在实际开发中非常有用。不论是业务代码的编写，还是在框架层面，我们都可以把行为依照职责分成粒度更细的函数，随后通过装饰把它们合并到一起，这有助于我们编写一个松耦合和高复用性的系统。")]),r("p",[s._v("这一节将介绍几个例子，带大家进一步理解装饰函数的威力。")]),r("h3",[s._v("数据统计上报")]),r("p",[s._v("分离业务代码和数据统计代码，无论在什么语言中，都是 AOP 的经典应用之一。在项目开发的结尾阶段难免要加上很多统计数据的代码，这些过程可能让我们被迫改动早已封装好的函数。")]),r("p",[s._v("比如页面中有一个登录 button，点击这个 button 会弹出登录浮层，与此同时要进行数据上报，来统计有多少用户点击了这个登录 button：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("tag")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"login"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button"')]),s._v(">")]),s._v("点击打开登录浮层"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" showLogin = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'打开登录浮层'")]),s._v(")\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getAttribute")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'tag'")]),s._v("))\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" log = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("tag")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'上报标签为: '")]),s._v(" + tag)\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (new Image).src = 'http:// xxx.com/report?tag=' + tag; // 真正的上报代码略")]),s._v("\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = showLogin\n\t")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n")])]),r("p",[s._v("我们看到在 showLogin 函数里，既要负责打开登录浮层，又要负责数据上报，这是两个层面的功能，在此处却被耦合在一个函数里。使用 AOP 分离之后，代码如下：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-Html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("tag")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"login"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"button"')]),s._v(">")]),s._v("点击打开登录浮层"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("button")]),s._v(">")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),r("span",{pre:!0,attrs:{class:"language-javascript"}},[s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("after")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("afterfn")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" __self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ret = __self."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t\t\tafterfn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(")\n\t\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" ret\n\t\t\t}\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" showLogin = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'打开登录浮层'")]),s._v(")\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" log = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'上报标签为: '")]),s._v(" + "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getAttribute")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'tag'")]),s._v("))\n\t\t}\n\t\tshowLogin = showLogin."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("after")]),s._v("(log) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 打开登录浮层之后上报数据")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getElementById")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button'")]),s._v(")."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = showLogin\n\t")]),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("script")]),s._v(">")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("</"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("html")]),s._v(">")]),s._v("\n")])]),r("h3",[s._v("节流函数 or 防抖函数")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("throttle")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("func, delay")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" tid\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (tid) "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\ttid = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\tfunc."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(self, ...args)\n\t\t\ttid = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t}, delay)\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("debounce")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("func, delay")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" tid\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (tid) "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("clearTimeout")]),s._v("(tid)\n\t\ttid = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("() =>")]),s._v(" {\n\t\t\tfunc."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(self, ...args)\n\t\t\ttid = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t}, delay)\n\t}\n}\n")])]),r("h3",[s._v("缓存函数返回值")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 缓存函数结果，对于一些\b计算量比较大的函数效果比较明显。")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("memorize")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("func")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" cache = {}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" key = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("JSON")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("stringify")]),s._v("(args)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (cache[key]) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'缓存了'")]),s._v(")\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" cache[key]\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = func."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", ...args)\n\t\tcache[key] = result\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fib")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("num")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" num < "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(" ? num : "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fib")]),s._v("(num - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") + "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fib")]),s._v("(num - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" enhanceFib = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("memorize")]),s._v("(fib)\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("enhanceFib")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("40")]),s._v("))\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("enhanceFib")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("40")]),s._v("))\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("enhanceFib")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("40")]),s._v("))\n"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("enhanceFib")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("40")]),s._v("))\n")])]),r("h3",[s._v("构造 React 高阶组件,为组件增加额外的功能，比如为组件提供 shallowCompare 功能：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("React")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" { "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" } = react\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ShadowCompareDecorator")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Instance")]),s._v(" =>\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("extends")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Component")]),s._v(" {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("shouldComponentUpdate")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("nextProps, nextState")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" !"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("shallowCompare")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("props")]),s._v(", nextProps) || !"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("shallowCompare")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("state")]),s._v(", nextState)\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("render")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"language-xml"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("Instance")]),s._v(" {"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("...this.props")]),s._v("} />")])]),s._v("\n\t\t}\n\t}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("default")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ShadowCompareDecorator")]),s._v("\n")])]),r("h2",[s._v("用 AOP 动态改变函数的参数")]),r("p",[s._v("观察 "),r("code",{pre:!0},[s._v("Function.prototype.before")]),s._v(" 方法：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Function")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("before")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("beforefn")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" __self = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tbeforefn."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (1)")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" __self."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("arguments")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// (2)")]),s._v("\n\t}\n}\n")])]),r("p",[s._v("从这段代码的(1)处和(2)处可以看到，beforefn 和原函数"),r("strong",[s._v("self 共用一组参数列表 arguments，当我们在 beforefn 的函数体内改变 arguments 的时候，原函数")]),s._v("self 接收的参数列表自然也会变化。")]),r("p",[s._v("下面的例子展示了如何通过 "),r("code",{pre:!0},[s._v("Function.prototype.before")]),s._v(" 方法给函数 func 的参数 param 动态地添加属性 b：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" func = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("param")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(param) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// 输出： {a: "a", b: "b"}')]),s._v("\n}\nfunc = func."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("before")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("param")]),s._v(") {\n\tparam."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("b")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'b'")]),s._v("\n})\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("func")]),s._v("({ "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("a")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v(" })\n")])]),r("p",[s._v("现在有一个用于发起 ajax 请求的函数，这个函数负责项目中所有的 ajax 异步请求：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ajax = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("type, url, param")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("dir")]),s._v("(param)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 发送ajax请求的代码略")]),s._v("\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ajax")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'http:// xxx.com/userinfo'")]),s._v(", { "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sven'")]),s._v(" })\n")])]),r("p",[s._v("上面的伪代码表示向后台 cgi 发起一个请求来获取用户信息，传递给 cgi 的参数是{ name: 'sven' }")]),r("p",[s._v("ajax 函数在项目中一直运转良好，跟 cgi 的合作也很愉快。直到有一天，我们的网站遭受了 CSRF 攻击。解决 CSRF 攻击最简单的一个办法就是在 HTTP 请求中带上一个 Token 参数。")]),r("p",[s._v("假设我们已经有一个用于生成 Token 的函数")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" getToken = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Token'")]),s._v("\n}\n")])]),r("p",[s._v("现在的任务是给每个 ajax 请求都加上 Token 参数：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ajax = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("type, url, param")]),s._v(") {\n\tparam = param || {}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Param")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("Token")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getToken")]),s._v("() "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 发送ajax请求的代码略...")]),s._v("\n}\n")])]),r("p",[s._v("虽然已经解决了问题，但我们的 ajax 函数相对变得僵硬了，每个从 ajax 函数里发出的请求都自动带上了 Token 参数，虽然在现在的项目中没有什么问题，但如果将来把这个函数移植到其他项目上，或者把它放到一个开源库中供其他人使用，Token 参数都将是多余的。")]),r("p",[s._v("也许另一个项目不需要验证 Token，或者是 Token 的生成方式不同，无论是哪种情况，都必须重新修改 ajax 函数。")]),r("p",[s._v("为了解决这个问题，先把 ajax 函数还原成一个干净的函数：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" ajax = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("type, url, param")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(param) "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 发送ajax请求的代码略")]),s._v("\n}\n")])]),r("p",[s._v("然后把 Token 参数通过 Function.prototyte.before 装饰到 ajax 函数的参数 param 对象中：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" getToken = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Token'")]),s._v("\n}\najax = ajax."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("before")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("type, url, param")]),s._v(") {\n\tparam."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("Token")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getToken")]),s._v("()\n})\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("ajax")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'get'")]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'http:// xxx.com/userinfo'")]),s._v(", { "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'sven'")]),s._v(" })\n")])]),r("p",[s._v("从 ajax 函数打印的 log 可以看到，Token 参数已经被附加到了 ajax 请求的参数中：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[s._v("{"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"sven"')]),s._v(", "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Token")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"Token"')]),s._v("}\n")])]),r("p",[s._v("明显可以看到，用 AOP 的方式给 ajax 函数动态装饰上 Token 参数，保证了 ajax 函数是一个相对纯净的函数，提高了 ajax 函数的可复用性，它在被迁往其他项目的时候，不需要做任何修改。")]),r("h2",[s._v("区分装饰者模式和代理模式")]),r("p",[s._v("装饰者模式和代理模式的结构看起来非常相像，这两种模式都描述了怎样为对象提供一定程度上的间接引用，它们的实现部分都保留了对另外一个对象的引用，并且向那个对象发送请求。")]),r("p",[s._v("代理模式和装饰者模式最重要的区别在于它们的意图和设计目的。代理模式的目的是，当直接访问本体不方便或者不符合需要时，为这个本体提供一个替代者。本体定义了关键功能，而代理提供或拒绝对它的访问，或者在访问本体之前做一些额外的事情。装饰者模式的作用就是为对象动态加入行为。换句话说，代理模式强调一种关系（Proxy 与它的实体之间的关系），这种关系可以静态的表达，也就是说，这种关系在一开始就可以被确定。而装饰者模式用于一开始不能确定对象的全部功能时。代理模式通常只有一层代理-本体的引用，而装饰者模式经常会形成一条长长的装饰链。")]),r("p",[s._v("在虚拟代理实现图片预加载的例子中，本体负责设置 img 节点的 src，代理则提供了预加载的功能，这看起来也是“加入行为”的一种方式，但这种加入行为的方式和装饰者模式的偏重点是不一样的。装饰者模式是实实在在的为对象增加新的职责和行为，而代理做的事情还是跟本体一样，最终都是设置 src。但代理可以加入一些“聪明”的功能，比如在图片真正加载好之前，先使用一张占位的 loading 图片反馈给客户。")]),r("h2",[s._v("使用 ES7 修饰器实现装饰者")]),r("h3",[s._v("拍照滤镜")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("after")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, desc")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" { value } = desc\n\tdesc."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" res = value."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'加滤镜'")]),s._v(")\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" res\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" desc\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v(" {\n\t@after\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'拍照'")]),s._v(")\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" t = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v("()\nt."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("takePhoto")]),s._v("()\n")])]),r("h3",[s._v("性能上报")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("report")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, desc")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" { value } = desc\n\tdesc."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" start = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("now")]),s._v("()\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" res = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" value."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" millis = "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Date")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("now")]),s._v("() - start\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 上报代码")]),s._v("\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" res\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" desc\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v(" {\n\t@report\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getData")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("url")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// fetch 代码")]),s._v("\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" t = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v("()\nt."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getData")]),s._v("()\n")])]),r("h3",[s._v("异常处理")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("handleError")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, key, desc")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" { value } = desc\n\tdesc."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("value")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("...args")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" res\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n\t\t\tres = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" value."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("apply")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", args)\n\t\t} "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (err) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 异常处理")]),s._v("\n\t\t\tlogger."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("error")]),s._v("(err)\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" res\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" desc\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v(" {\n\t@handleError\n\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getData")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("url")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// fetch 代码")]),s._v("\n\t}\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" t = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Test")]),s._v("()\nt."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getData")]),s._v("()\n")])]),r("h2",[s._v("结语")]),r("p",[s._v("通过数据上报、统计函数的执行时间、动态改变函数参数例子，我们了解了装饰函数，它是 JavaScript 中独特的装饰者模式。这种模式在实际开发中非常有用，除了上面提到的例子，它在框架开发中也十分有用。作为框架作者，我们希望框架里的函数提供的是一些稳定而方便移植的功能，那些个性化的功能可以在框架之外动态装饰上去，这可以避免为了让框架拥有更多的功能，而去使用 一些 if、else 语句预测用户的实际需要。")])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},e0f1:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-01-20_21-35-53.d11fcce3.png"},e167:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body")])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},e2b2:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("关于 JavaScript TC39 与 ECMAScript 提案")]),a("p",[s._v("参考"),a("a",{attrs:{href:"https://www.cnblogs.com/ayqy/p/tc39-workflow.html"}},[s._v("TC39 规范制定流程 ")])]),a("h2",[s._v("JavaScript 的诞生")]),a("p",[s._v("1995 年 5 月，一个叫 "),a("a",{attrs:{href:"https://baike.baidu.com/item/%E5%B8%83%E5%85%B0%E7%99%BB%C2%B7%E8%89%BE%E5%A5%87/58101949?fromtitle=Brendan%20Eich&fromid=561441&fr=aladdin"}},[s._v("Brendan Eich(布兰登·艾奇)")]),s._v(" 的人花 10 天创造了 JavaScript")]),a("h2",[s._v("JavaScript 语言的标准化")]),a("p",[s._v("最初 JavaScript 语言有 2 份标准：")]),a("ul",[a("li",[s._v("ECMA-262：主标准，由 ECMA 国际组织（Ecma International）负责管理")]),a("li",[s._v("ISO/IEC 16262：第二标准，由国际标准化组织（ISO，International Organization for Standardization）和国际电子技术委员会（IEC，International Electrotechnical Commission）负责管理")])]),a("p",[s._v("出于商标版权的原因，规范标准中将这门语言称为 ECMAScript，所以原则上 JavaScript 与 ECMAScript 指的是同一个东西，但有时也会加以区分：")]),a("ul",[a("li",[s._v("JavaScript：指语言及其实现")]),a("li",[s._v("ECMAScript：指语言标准及语言版本，比如 ES6 表示语言（标准）的第 6 版")])]),a("blockquote",[a("p",[s._v("ECMAScript 中的 ECMA 取自负责管理主标准的 ECMA 国际组织，这个组织最初叫欧洲计算机制造商协会（European Computer Manufacturers Association），后来影响范围不限于欧洲，遂更名为 ECMA 国际组织（Ecma International）")])]),a("h2",[s._v("ES 规范版本历史")]),a("ul",[a("li",[s._v("ECMAScript 1（1997 年 6 月）：规范第一版")]),a("li",[s._v("ECMAScript 2（1998 年 6 月）：为了同步 ISO 标准，引入了一些小更新")]),a("li",[s._v("ECMAScript 3（1999 年 12 月）：增加了正则表达式、字符串处理、控制语句（do-while、switch）、异常处理（try-catch）等众多核心特性")]),a("li",[s._v("ECMAScript 4（2008 年 7 月废除)：本来是一次大规模升级（静态类型、模块、命名空间等），但跨度过大，出现了分歧，最终没能推广使用")]),a("li",[s._v("ECMAScript 5（2009 年 12 月）：变化不大，加了一些标准库特性和严格模式")]),a("li",[s._v("ECMAScript 5.1（2011 年 6 月）：又一次小更新，为了同步 ISO 标准")]),a("li",[s._v("ECMAScript 6（2015 年 6 月）：一大波更新，实现了当年 ES4 的许多设想，并正式改为按年份命名规范版本（以后不叫 es7 叫 es2016）")]),a("li",[s._v("ECMAScript 2016（2016 年 6 月）：第一个年度版本，与 ES6 相比，发布周期较短，新特性也相对少些")]),a("li",[s._v("ECMAScript 2017（2017 年 6 月）：第二个年度版本")]),a("li",[s._v("以后的 ECMAScript 版本（ES2018、ES2019、ES2020 等）都在 6 月正式获准生效")])]),a("h2",[s._v("TC39")]),a("blockquote",[a("p",[s._v("ECMA 国际组织设有众多技术委员会，除 TC39 ECMAScript 外，还有 TC43 Universal 3D (U3D)、TC45 Office Open XML Formats 等等，具体见"),a("a",{attrs:{href:""}},[s._v("Ecma template for minutes - Ecma International")])])]),a("h3",[s._v("TC39 是什么？包括哪些人？")]),a("p",[s._v("一个推动 JavaScript 发展的委员会，由各个主流浏览器厂商的代表构成")]),a("h3",[s._v("为什么会出现这样一个组织")]),a("p",[s._v("制定 ECMAScript 标准，标准生成的流程，并实现")]),a("h2",[s._v("TC39 标准制定流程")]),a("p",[s._v("从 ES6 来看，发版周期过长存在 2 个问题:")]),a("ul",[a("li",[s._v("版本之间的时间跨度太长，提早定稿的特性要等待非常长的时间，一直等到规范正式发布（才能被实现和使用），而靠后的特性往往赶在最后发版期限之前才定稿，存在风险")]),a("li",[s._v("语言特性的设计与实现和使用相隔太久，在实现和使用阶段才发现设计缺陷为时已晚 为此，"),a("a",{attrs:{href:"https://www.ecma-international.org/technical-committees/tc39/"}},[s._v("TC39")]),s._v("（ECMA 国际组织第 39 号技术委员会）启动了新的流程：")])]),a("p",[s._v("主要变化在于：")]),a("ul",[a("li",[s._v("ECMAScript 各项特性独立设计，历经 5 个阶段，从 Stage 0（Strawman，初稿）开始，经 Stage 1（提案）、Stage 2（草案）、Stage 3（候选提案），最后到 Stage 4（Finished，过审提案）结束")]),a("li",[s._v("要求在后几个阶段进行原型实现和实际测试（"),a("a",{attrs:{href:"https://github.com/tc39/test262"}},[s._v("由 Test 262 负责")]),s._v("），以便在设计和实现之间形成反馈循环")]),a("li",[s._v("ECMAScript 每年发布一版，囊括截止最后发版日期之前所有已经进入第 4 阶段的特性")])]),a("p",[s._v("所以，从 ES2016 开始（新 TC39 流程施行以来），ES 版本的概念被大大弱化了，需要关心的是特性提案处于第几阶段，只要进入第 4 阶段就已经算是标准特性了，会在下一个 6 月正式纳入标准")]),a("blockquote",[a("p",[s._v("按照"),a("a",{attrs:{href:"https://tc39.es/process-document/"}},[s._v("TC39 流程文档")]),s._v("，应该是每年 7 月发版 July: Approval of new standard by the ECMA General Assembly 但实际发版时间是每年 6 月，可能是为了纪念历史上那些 6 月发布的元老版本")])]),a("h3",[s._v("制定流程的 5 个阶段")]),a("p",[a("a",{attrs:{href:"https://github.com/tc39/proposals"}},[s._v("TC39 标准的进程")])]),a("ul",[a("li",[a("strong",[s._v("stage0 strawman")]),s._v(" 任何讨论、想法、改变或者还没加到提案的特性都在这个阶段。只有 TC39 成员可以提交")]),a("li",[a("strong",[s._v("stage1 proposal")]),a("ol",[a("li",[s._v("产出一个正式的提案。")]),a("li",[s._v("发现潜在的问题，例如与其他特性的关系，实现难题。")]),a("li",[s._v("提案包括详细的 API 描述，使用例子，以及关于相关的语义和算法。")])])]),a("li",[a("strong",[s._v("stage2 draft")])])]),a("ol",[a("li",[s._v("提供一个初始的草案规范，与最终标准中包含的特性不会有太大差别。草案之后，原则上只接受增量修改。")]),a("li",[s._v("开始实验如何实现，实现形式包括 polyfill, 实现引擎（提供草案执行本地支持），或者编译转换（例如 babel）")])]),a("ul",[a("li",[a("strong",[s._v("stage3 candidate")]),s._v(" 候选阶段，获得具体实现和用户的反馈。此后，只有在实现和使用过程中出现了重大问题才会修改")])]),a("ol",[a("li",[s._v("规范文档必须是完整的，评审人和 ECMAScript 的编辑要在规范上签字")]),a("li",[s._v("至少要在一个浏览器中实现，提供 polyfill 或者 babel 插件")])]),a("ul",[a("li",[a("strong",[s._v("stage4 finished")]),s._v(" 已经准备就绪，该特性会出现在下个版本的 ECMAScript 规范之中，需要通过有 2 个独立的实现并通过验收测试，以获取使用过程中的重要实践经验")])]),a("h2",[s._v("向后兼容原则")]),a("p",[s._v("我们发现 ES 规范每一版始终完全兼容先前的所有特性，比如 ES6 提出了 let、const 但并没有干掉 var，这是因为如果推出了不兼容的新版本，会造成一些问题：")]),a("ul",[a("li",[s._v("JavaScript 引擎、IDE、构建工具都会变得臃肿，因为要支持新旧两版规范")]),a("li",[s._v("开发者需要知道版本之间的差异")]),a("li",[s._v("要么把现有的代码全都迁移到新版本，要么（不同项目）混用多个版本，重构会变得很麻烦")]),a("li",[s._v("甚至要标注每段代码的所属版本，就像 ES5 手动开启严格模式一样，当时没有流行起来的一个原因是在文件或函数开头添加指令也很麻烦 为了避免这些问题，ES6 采用了一种策略叫 One JavaScript：")]),a("li",[s._v("新版本始终完全向后兼容（但偶尔可能会有轻微、不明显的清理）")]),a("li",[s._v("旧特性不删除也不修复，而是引入更好的版本，比如 let 就是 var 的改进版")]),a("li",[s._v("如果语言的某些方面有变化，只在新的语法结构内生效，即隐式选用，例如，yield 只在 generator 中才是关键字、模块和类中的所有代码都默认开启严格模式")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},e955:function(s,t,a){var r={"./HelloWorld.vue":"fdab","./SvgIcon/index.vue":"c00a","./md/css/css.md":"41f9","./md/css/css_PostCss.md":"919b","./md/css/css_reflowRepaint.md":"4882","./md/javascript/javascript_Property-Descriptor.md":"1130","./md/javascript/javascript_aop-decorator.md":"e0db","./md/javascript/javascript_asyncImg_异步加载图片.md":"4f95","./md/javascript/javascript_babel-preset-env.md":"58ff","./md/javascript/javascript_babel_babel.md":"f741","./md/javascript/javascript_cookieShare_cookie 共享.md":"2a3c","./md/javascript/javascript_decorators.md":"8121","./md/javascript/javascript_designPatterns.md":"2680","./md/javascript/javascript_dns.md":"fc0e","./md/javascript/javascript_event.md":"2667","./md/javascript/javascript_eventLoop_EventLoop事件循环.md":"30b2","./md/javascript/javascript_heapAndStack.md":"45c1","./md/javascript/javascript_hosts.md":"07b4","./md/javascript/javascript_httpCache.md":"4446","./md/javascript/javascript_javascript_javascript相关.md":"7f6d","./md/javascript/javascript_oop.md":"192b","./md/javascript/javascript_promise_Promise使用.md":"d68e","./md/javascript/javascript_proxyPattern.md":"e9f2","./md/javascript/javascript_publicSubscribePattern.md":"06d2","./md/javascript/javascript_refere_Referer.md":"aaec","./md/javascript/javascript_reflect.md":"b2a1","./md/javascript/javascript_regexp_正则.md":"69f8","./md/javascript/javascript_singletonPattern.md":"9252","./md/javascript/javascript_statePattern.md":"440a","./md/javascript/javascritpt_proxy.md":"6f08","./md/other/other_config.md":"e167","./md/other/other_environment_windows环境.md":"84b4","./md/other/other_eslint.md":"fc29","./md/other/other_gitHooks.md":"8c80","./md/other/other_githubAction_GitHub持续集成.md":"107d","./md/other/other_gitssh.md":"dfb2","./md/other/other_jsconfig_jsconfig作用.md":"b5c6","./md/other/other_nginx_本地nginx启动web服务.md":"4b96","./md/other/other_npmrc_npmrc.作用.md":"da6a","./md/other/other_stylelint.md":"950b","./md/other/other_tc39-ecma.md":"e2b2","./md/other/other_useFile.md":"4050","./md/react/reactImmutableData.md":"f3e6","./md/react/react_lazyLoadReact_react懒加载组件.md":"b27d","./md/react/react_reactMd_react相关.md":"6b5a","./md/typescript/typescript_ts_typescript入门.md":"c0a5","./md/vue/Vue_asyncComponent_异步组件.md":"78d9","./md/vue/Vue_newVue.md":"d035","./md/vue/Vue_routerProps_vueRouterProps.md":"58ab","./md/vue/Vue_vueHook_@hook那些事.md":"b646","./md/vue/Vue_vueRouter_vue路由相关.md":"394a","./md/vue/Vue_vueUse_vue知识点.md":"c82c"};function e(s){var t=n(s);return a(t)}function n(s){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return r[s]}e.keys=function(){return Object.keys(r)},e.resolve=n,s.exports=e,e.id="e955"},e9f2:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("JavaScript 设计模式之代理模式")]),r("h2",[s._v("定义")]),r("p",[s._v("代理模式是为对象提供一个代用品或者占位符，以便控制对它的直接访问。当一个对象不想被外界直接访问，就可以使用代理，提供一个替身对象来控制对它的访问，替身对象对请求进行处理之后，再把请求转交给本体对象。")]),r("p",[r("img",{attrs:{src:a("13db"),alt:"示意图"}})]),r("h2",[s._v("类型")]),r("p",[s._v("一般代理有两种类型，保护代理和虚拟代理。")]),r("h3",[s._v("保护代理")]),r("p",[s._v("保护代理主要用来控制不同权限的对象对目标对象的访问，如果目标对象想过滤掉一些请求，就可以让自己的代理去处理掉。")]),r("h3",[s._v("虚拟代理")]),r("p",[s._v("虚拟代理主要用来延时去创建对象或者执行目标对象的方法，如果执行目标对象的方法是一个开销很大的操作，虚拟代理就可以先代理目标对象的方法，延迟到真正需要它的时候再去调用。")]),r("p",[s._v("在 JavaScript 中实现保护代理比较困难，因为很难判断谁访问了对象，虚拟代理是一种比较常用的代理模式，所以接下来主要讲解虚拟代理的应用。")]),r("h2",[s._v("应用")]),r("h3",[s._v("使用代理实现图片预加载")]),r("p",[s._v("下面就用虚拟代理实现图片预加载功能，web 开发中，如果要显示一张很大的图片，经常会使用较小的图片先占位，然后再用异步请求，等大图加载完了再显把它填充到 img 的 src 属性中。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myImage = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" imageNode = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'img'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(imgNode)\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("setSrc")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("src")]),s._v(") {\n\t\t\timgNode."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = src\n\t\t}\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" proxyImage = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" img = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Image")]),s._v("()\n\timg."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\tmyImage."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setSrc")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(")\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("setSrc")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("src")]),s._v(") {\n\t\t\tmyImage."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setSrc")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'loading.gif'")]),s._v(")\n\t\t\timg."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = src\n\t\t}\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// test")]),s._v("\nproxyImage."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setSrc")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'largeImg.png'")]),s._v(")\n")])]),r("p",[s._v("上面代码实现了一个通过 proxyImage 间接访问 myImage。在加载完大图前，用一张 loading 图先占位，避免出现白屏占位的情况。也许你会说，上面的例子通过给 myImage 加一个 img.onload 事件，就可以达到一样的效果。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myImage = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" imageNode = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'img'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(imgNode)\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" img = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Image")]),s._v("()\n\n\timg."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\timgNode."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = img."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v("\n\t}\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("setSrc")]),s._v(": "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("src")]),s._v(") {\n\t\t\timgNode."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'loading.gif'")]),s._v("\n\t\t\timg."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = src\n\t\t}\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// test")]),s._v("\nmyImage."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("setSrc")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'largeImage.png'")]),s._v(")\n")])]),r("p",[s._v("第二段代码精简了许多，但是函数里面做了两件事——给 img 节点设置 src 和预加载图片。这违反了单一职责原则。而第一段代码中，myImage 和 proxyImage 的功能都是单一的。添加预加载功能时，我们也并没有修改 myImage 的代码，这符合开发-封闭原则。但我们加载小图片（不需要预加载功能）时，直接调用 myImage 即可。")]),r("p",[s._v("我们还可以优化一些第一段代码，"),r("strong",[s._v("让两个函数表现的一致")]),s._v("。")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" myImage = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" imageNode = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("createElement")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'img'")]),s._v(")\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("body")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("appendChild")]),s._v("(imgNode)\n\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("src")]),s._v(") {\n\t\timgNode."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = src\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" proxyImage = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" img = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Image")]),s._v("()\n\timg."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onload")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("myImage")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(")\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("src")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("myImage")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'loading.gif'")]),s._v(")\n\t\timg."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("src")]),s._v(" = src\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 接口表现的一致")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("myImage")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'smallImg.png'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("proxyImage")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'largeImg.png'")]),s._v(")\n")])]),r("h3",[s._v("使用虚拟代理合并 HTTP 请求")]),r("p",[s._v("在 web 开发中，网络请求的开销很大，假设我们要做一个文件同步的功能，当我们选中文件的时候，文件就会同步到服务器。首先在页面中创建可供点击的 checkbox 节点：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-html"}},[r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"1"')]),s._v(" />")]),s._v("\n1\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"2"')]),s._v(" />")]),s._v("\n2\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"3"')]),s._v(" />")]),s._v("\n3\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"4"')]),s._v(" />")]),s._v("\n4\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"5"')]),s._v(" />")]),s._v("\n5\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"6"')]),s._v(" />")]),s._v("\n6\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"7"')]),s._v(" />")]),s._v("\n7\n"),r("span",{pre:!0,attrs:{class:"hljs-tag"}},[s._v("<"),r("span",{pre:!0,attrs:{class:"hljs-name"}},[s._v("input")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("type")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"checkbox"')]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v("="),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"7"')]),s._v(" />")]),s._v("\n8\n")])]),r("p",[s._v("接下来，给 checkbox 绑定点击事件，然后同步文件到服务器:")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" synchronousFile = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("id")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`同步文件, id为"),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${id}")]),s._v("`")]),s._v(")\n}\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" checkboxList = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("querySelectorAll")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = checkboxList."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" checkbox = checkboxList[i]\n\tcheckbox."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("checkbox")]),s._v(" === "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("synchronousFile")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v(")\n\t\t}\n\t}\n}\n")])]),r("p",[s._v("当我们一次性选了 3 个 checkbox 的时候，同时也向服务器发送了 3 次文件同步的请求。对于手速快的程序员，可能 1 秒钟可以点击 4 个 checkbox，这样频繁的网络请求会带来很大的开销。 解决方案就是通过代理 synchronousFile 方法，收集一段时间的请求，最后一次性发给服务器。比如等待两秒钟之后，然后把两秒钟内的需要同步的文件列表一起发送给服务器。实现代码如下：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" synchronousFile = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("id")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`同步文件, id为"),r("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${id}")]),s._v("`")]),s._v(")\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxySynchronousFile = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cache = [],\n\t\ttimer\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("id")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (cache."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("indexOf")]),s._v("(id) > -"),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") {\n\t\t\tcache."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("push")]),s._v("(id)\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (timer) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v("\n\t\t}\n\t\ttimers = "),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("setTimeout")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("synchronousFile")]),s._v("(cache."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("join")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("','")]),s._v("))\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("clearTimeout")]),s._v("(timer)\n\t\t\ttimer = "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("\n\t\t\tcache = []\n\t\t}, "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2000")]),s._v(")\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" checkboxList = "),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("document")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("querySelectorAll")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'input'")]),s._v(")\n"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" i = "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", len = checkboxList."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i < len; i++) {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" checkbox = checkboxList[i]\n\tcheckbox."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("onclick")]),s._v(" = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("checkbox")]),s._v(" === "),r("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(") {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("proxySynchronousFile")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),r("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v(")\n\t\t}\n\t}\n}\n")])]),r("h3",[s._v("缓存代理")]),r("p",[s._v("缓存代理可以为一些开销大的运算结果提供暂时的存储，在下次运算时，如果传递进来的参数跟之前一致，则可以直接返回结果。")]),r("h4",[s._v("计算阶乘")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" factorial = "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("n")]),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (n === "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(" || n === "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v("\n\t}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" n * "),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("factorial")]),s._v("(n - "),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(")\n}\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("factorial")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 24")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("factorial")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 24")]),s._v("\n")])]),r("p",[s._v("引入代理：")]),r("pre",{pre:!0},[r("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" proxyFactorial = ("),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" cache = {}\n\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),r("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("n")]),s._v(") {\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (cache[n]) {\n\t\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" cache[n]\n\t\t}\n\t\t"),r("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" (cache[n] = factorial."),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", n))\n\t}\n})()\n\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("proxyFactorial")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 24")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("proxyFactorial")]),s._v("("),r("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("4")]),s._v(") "),r("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 24")]),s._v("\n")])]),r("h4",[s._v("缓存 ajax 请求")]),r("p",[s._v("我们在项目中经常会遇到分页的请求，在一些场景下，同一页的数据理论上只需要去服务端获取一次，然后可以缓存起来，下次再请求同一页的时候就可以直接从缓存中获取。这种情形也可以使用缓存代理，需要注意的是从后端获取数据是一个异步操作，我们无法直接把计算结果同步的放在缓存中，而是要通过回调的方式。")]),r("h3",[s._v("其它代理模式")]),r("p",[s._v("代理模式的变体种类很多，下面做挑一些做简单的介绍。")]),r("ul",[r("li",[s._v("防火墙代理：控制网络资源的访问，保护主机不让“坏人接近”。")]),r("li",[s._v("远程代理：为一个对象在不同的地址空间提供局部代表。")]),r("li",[s._v("智能引用代理：取代了简单的指针，它在访问对象时执行一些附加操作，比如 Vue 中的对象劫持。")]),r("li",[s._v("写时复制代理：通常用于复制一个庞大的的对象的情况。这种代理模式延迟了复制的过程，当对象被真正修改时，才对它进行复制操作。")])]),r("h2",[s._v("总结")]),r("p",[s._v("通过前面的这些应用我们可以看到，"),r("strong",[s._v("代理和目标对象有一致的接口")]),s._v("。比如通过代理实现的预加载图片的功能，实现了 setSrc 方法，当我们有一天不需要图片预加载功能，也可以直接调用本体的方法，因为它们都对外提供了 setSrc 方法。在客户看来，代理和目标对象是一致的，客户并不知道代理和目标对象的区别。这样的做有两个好处：")]),r("ul",[r("li",[s._v("用户可以放心使用代理，因为他只关心是否能得到想要的结果")]),r("li",[s._v("在任何使用本体的地方都可以替换成代理，不需要代理的时候，也可以直接使用本体")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},eb77:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-16_22-25-02.c234c2b4.png"},eea3:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-12-16_22-46-28.2ec6b81d.png"},ef25:function(s,t,a){s.exports=a.p+"img/Snipaste_2022-02-28_22-34-20.04964097.png"},efaa:function(s,t,a){s.exports=a.p+"img/Snipaste_2021-11-18_16-02-07.95d68092.png"},f3e6:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h3",[s._v("不可变数据")]),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/zeping891103/article/details/83834953"}},[s._v("原文地址")])]),a("h4",[s._v("Mutable")]),a("p",[s._v("JS 中的对象一般是可变的（Mutable），因为使用了引用赋值，新的对象简单的引用了原始对象，改变新的对象将影响到原始对象。如 foo={a: 1}; bar=foo; bar.a=2 你会发现此时 foo.a 也被改成了 2。虽然这样做可以节约内存，但当应用复杂后，这就造成了非常大的隐患，突变带来的优点变得得不偿失。为了解决这个问题，一般的做法是使用 shallowCopy（浅拷贝）或 deepCopy（深拷贝）来避免被修改，但缺点是造成了 CPU 和内存的浪费。")]),a("p",[s._v("如深拷贝的代码如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" cloneDeep = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'lodash.clonedeep'")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// npm install lodash.clonedeep")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" data = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("id")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'1'")]),s._v(",\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("author")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("name")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Lee'")]),s._v("\n\t}\n}\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" dataDeepCopy = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cloneDeep")]),s._v("(data)\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(dataDeepCopy === data) "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 打印 false")]),s._v("\n\ndataDeepCopy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'2'")]),s._v("\ndataDeepCopy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("author")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("name")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Huang'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(data."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 打印 1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("(dataDeepCopy."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("id")]),s._v(") "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 打印 2")]),s._v("\n")])]),a("h4",[s._v("什么是 IMMUTABLE DATA（不可变数据）")]),a("p",[s._v("Immutable Data 就是一旦创建，就不能再被更改的数据。对 Immutable 对象的任何修改操作都会返回一个新的 Immutable 对象。")]),a("p",[s._v("Immutable 实现的原理是 Persistent Data Structure（持久化数据结构），也就是使用旧数据创建新数据时，要保证旧数据可用且没有发生变化。同时为了避免 deepCopy 把所有节点都复制一遍带来的性能损耗，Immutable 使用了 Structural Sharing（结构共享），"),a("strong",[s._v("即如果对象树中一个节点发生变化，只修改这个节点和受它影响的父节点，其它节点则进行共享")]),s._v("。")]),a("blockquote",[a("p",[s._v("react 目前最常用的是 immutable，常用的方法是 Immutable.fromJS() 和 Immutable.Record()")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},f666:function(s,t,a){var r={"./bus.js":"a70a","./index.js":"6912"};function e(s){var t=n(s);return a(t)}function n(s){if(!a.o(r,s)){var t=new Error("Cannot find module '"+s+"'");throw t.code="MODULE_NOT_FOUND",t}return r[s]}e.keys=function(){return Object.keys(r)},e.resolve=n,s.exports=e,e.id="f666"},f741:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h2",[s._v("babel 入门以及进阶")]),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844904008679686152"}},[s._v("刘小夕 不容错过的 Babel7 知识")])]),a("h2",[s._v("介绍")]),a("p",[s._v("Babel 是一个通用的多用途 JavaScript 编译器。通过 Babel 你可以使用（并创建）下一代的 JavaScript，以及下一代的 JavaScript 工具。")]),a("p",[s._v("作为一种语言，JavaScript 在不断发展，新的标准／提案和新的特性层出不穷。 在得到广泛普及之前，Babel 能够让你提前（甚至数年）使用它们。")]),a("p",[s._v("Babel 把用最新标准编写的 JavaScript 代码向下编译成可以在今天随处可用的版本。 这一过程叫做“源码到源码”编译， 也被称为转换编译（transpiling，是一个自造合成词，即转换＋编译。以下也简称为转译）。")]),a("p",[s._v("例如，Babel 能够将新的 ES2015 箭头函数语法：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("square")]),s._v(" = n => n * n\n")])]),a("p",[s._v("转译为：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" square = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("square")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("n")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" n * n\n}\n")])]),a("p",[s._v("不过 Babel 的用途并不止于此，它支持语法扩展，能支持像 React 所用的 JSX 语法，同时还支持用于静态类型检查的流式语法（Flow Syntax）。")]),a("p",[s._v("更重要的是，Babel 的一切都是简单的插件，谁都可以创建自己的插件，利用 Babel 的全部威力去做任何事情。")]),a("p",[s._v("再进一步，Babel 自身被分解成了数个核心模块，任何人都可以利用它们来创建下一代的 JavaScript 工具。")]),a("h3",[s._v("babel 作用")]),a("p",[s._v("Babel 能够做什么")]),a("ul",[a("li",[s._v("语法转换")]),a("li",[s._v("通过 Polyfill 方式在目标环境中添加缺失的特性(@babel/polyfill 模块)")]),a("li",[s._v("源码转换(codemods)")])]),a("p",[s._v("为了更清晰的了解每一步，首先创建一个新项目，例如 babelTemp(你爱取啥名取啥名)，使用 npm init -y 进行初始化，创建 src/index.js，文件内容如下（你也可以随便写点什么）:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("fn")]),s._v(" = ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") => {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v(")\n}\n")])]),a("h3",[s._v("babel 家族组成")]),a("h4",[s._v("核心库 @babel/core")]),a("p",[s._v("Babel 的核心功能包含在 @babel/core 模块中。看到 core 这个词了吧，意味着核心，没有它，在 babel 的世界里注定寸步难行。不安装 @babel/core，无法使用 babel 进行编译。")]),a("h4",[s._v("CLI 命令行工具 @babel/cli")]),a("p",[s._v("babel 提供的命令行工具，主要是提供 babel 这个命令，适合安装在项目里。")]),a("p",[s._v("@babel/node 提供了 babel-node 命令，但是 @babel/node 更适合全局安装，不适合安装在项目里。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install --save-dev @babel/core @babel/cli\n")])]),a("p",[s._v("现在你就可以在项目中使用 babel 进行编译啦（如果不安装 @babel/core，会报错噢）")]),a("p",[s._v("将命令配置在 package.json 文件的 scripts 字段中,使用 npm run compiler 来执行编译，现在我们没有配置任何插件，编译前后的代码是完全一样的。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"compiler"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"babel src --out-dir lib --watch"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("使用 npm run compiler 来执行编译，现在我们没有配置任何插件，编译前后的代码是完全一样的。")]),a("p",[s._v("因为 Babel 虽然开箱即用，但是什么动作也不做，如果想要 Babel 做一些实际的工作，就需要为其添加插件(plugin)。")]),a("blockquote",[a("p",[s._v("编译出来得文件你会发现没有任何改变，因为我们还没有配置 babel,下面会详细说到 babel 配置")])]),a("p",[s._v("通过 babel-register 也可以运行 Babel，这种方法只需要引入文件就可以运行 Babel，或许能更好地融入你的项目设置。")]),a("p",[s._v("但请注意这种方法并不适合正式产品环境使用 首先安装 babel-register")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("$ npm install --save-dev babel-register\n")])]),a("p",[s._v("接着，在项目中创建 index.js 文件并添加如下代码")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'babel-register'")]),s._v(")\n")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("node ./src/index.js\n")])]),a("p",[s._v("这样做可以把 Babel 注册到 Node 的模块系统中并开始编译其中 require 的所有文件")]),a("h4",[s._v("插件")]),a("p",[s._v("Babel 构建在插件之上，使用现有的或者自己编写的插件可以组成一个转换通道，Babel 的插件分为两种: 语法插件和转换插件。")]),a("ol",[a("li",[s._v("语法插件")])]),a("p",[s._v("这些插件只允许 Babel 解析（parse） 特定类型的语法（不是转换），可以在 AST 转换时使用，以支持解析新语法，例如：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("as")]),s._v(" babel "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/core'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" code = babel."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("transformFromAstSync")]),s._v("(ast, {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//支持可选链")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/plugin-proposal-optional-chaining'")]),s._v("],\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("babelrc")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n})."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("code")]),s._v("\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("转换插件")])]),a("p",[s._v("转换插件会启用相应的语法插件(因此不需要同时指定这两种插件)，这点很容易理解，如果不启用相应的语法插件，意味着无法解析，连解析都不能解析，又何谈转换呢？")]),a("p",[s._v("插件的使用,在项目目录下新建 .babelrc 文件 (下文会具体介绍配置文件)，配置如下：")]),a("p",[s._v("安装插件")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("yarn add @babel/plugin-transform-arrow-functions\n")])]),a("p",[s._v("插件的使用")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//.babelrc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-arrow-functions"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("也可以指定插件的相对/绝对路径")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"./node_modules/@babel/plugin-transform-arrow-functions"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("执行 npm run compiler，可以看到箭头函数已经被编译 OK， 内容如下:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fn = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("console")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("log")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'a'")]),s._v(")\n}\n")])]),a("p",[s._v("现在，我们仅支持转换箭头函数，如果想将其它的新的 JS 特性转换成低版本，需要使用其它对应的 plugin 。如果我们一个个配置的话，会非常繁琐，因为你可能需要配置几十个插件，这显然非常不便，那么有没有什么办法可以简化这个配置呢？")]),a("p",[a("strong",[s._v("有！预设！(感谢强大的 Babel)")])]),a("h4",[s._v("预设")]),a("p",[s._v("通过使用或创建一个 preset 即可轻松使用一组插件")]),a("h5",[s._v("官方 Preset")]),a("p",[s._v("babel 预设：")]),a("ul",[a("li",[s._v("babel-preset-es2015: 可以将 es6 的代码编译成 es5.")]),a("li",[s._v("babel-preset-es2016: 可以将 es7 的代码编译为 es6.")]),a("li",[s._v("babel-preset-es2017: 可以将 es8 的代码编译为 es7.")]),a("li",[s._v("babel-preset-latest: 支持现有所有 ECMAScript 版本的新特性")])]),a("p",[s._v("但是我们随着时间的推移，将来可能会有跟多的版本插件,比如 bebel-preset-es2018,.... 等等。因此 babel-preset-env 出现了，它的功能类似于 babel-preset-latest，它会根据目标环境选择不支持的新特性来转译")]),a("p",[s._v("babel 7 官方预设")]),a("ul",[a("li",[s._v("@babel/preset-env")]),a("li",[s._v("@babel/preset-flow")]),a("li",[s._v("@babel/preset-react")]),a("li",[s._v("@babel/preset-typescript")])]),a("p",[s._v("简单介绍一下 @babel/preset-env @babel/preset-env 主要作用是对我们所使用的并且目标浏览器中缺失的功能进行代码转换和加载 polyfill，在不进行任何配置的情况下，@babel/preset-env 所包含的插件将支持所有最新的 JS 特性(ES2015,ES2016 等，不包含 stage 阶段)，将其转换成 ES5 代码。例如，如果你的代码中使用了可选链(目前，仍在 stage 阶段)，那么只配置 @babel/preset-env，转换时会抛出错误，需要另外安装相应的插件。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//.babelrc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("需要说明的是，@babel/preset-env 会根据你配置的目标环境，生成插件列表来编译。对于基于浏览器或 Electron 的项目，官方推荐使用 .browserslistrc 文件来指定目标环境。默认情况下，如果你没有在 Babel 配置文件中(如 .babelrc)设置 targets 或 ignoreBrowserslistConfig，@babel/preset-env 会使用 browserslist 配置源。")]),a("p",[s._v("如果你不是要兼容所有的浏览器和环境，推荐你指定目标环境，这样你的编译代码能够保持最小。")]),a("p",[s._v("例如，.browserslistrc 仅包括浏览器市场份额超过 0.25％的用户所需的 polyfill 和代码转换（忽略没有安全更新的浏览器，如 IE10 和 BlackBerry）,配置如下: 更多配置参考"),a("a",{attrs:{href:"https://github.com/browserslist/browserslist"}},[s._v("browserslist")])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":""}},[s._v("> 0.25%\nnot dead\n")])]),a("p",[s._v(".browserslistrc 的内容配置为:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-txt"}},[s._v("last 2 Chrome versions\n")])]),a("p",[s._v("然后再执行 npm run compiler，你会发现箭头函数不会被编译成 ES5，因为 chrome 的最新 2 个版本都能够支持箭头函数。现在，我们将 .browserslistrc 仍然换成之前的配置。")]),a("blockquote",[a("p",[s._v("注: 从 Babel v7 开始，所有针对标准提案阶段的功能所编写的预设(stage preset)都已被弃用，官方已经移除了 @babel/preset-stage-x 下面简单介绍一下 babel-preset-stage-x 关于 babel-preset-stage-x JavaScript 还有一些提案，正在积极通过 TC39（ECMAScript 标准背后的技术委员会）的流程成为标准的一>部分。")]),a("p",[s._v("这个流程分为 5（0－4）个阶段。 随着提案得到越多的关注就越有可能被标准采纳，于是他们就继续通过各>个阶段，最终在阶段 4 被标准正式采纳。")]),a("p",[s._v("以下是 4 个不同阶段的（打包的）预设：")]),a("ul",[a("li",[s._v("babel-preset-stage-0")]),a("li",[s._v("babel-preset-stage-1")]),a("li",[s._v("babel-preset-stage-2")]),a("li",[s._v("babel-preset-stage-3")])]),a("p",[s._v(".babelrc 配置文")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"es2015"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"react"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"stage-2"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])])]),a("p",[s._v("我们修改下 src/index.js")]),a("p",[s._v("const isHas = [1,2,3].includes(2);")]),a("p",[s._v("const p = new Promise((resolve, reject) => { resolve(100); });")]),a("p",[s._v("编译出来的结果为:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-meta"}},[s._v("'use strict'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" isHas = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v("这个编译出来的代码在低版本浏览器中使用的话，显然是有问题的，因为低版本浏览器中数组实例上没有 includes 方法，也没有 Promise 构造函数。")]),a("p",[s._v("这是为什么呢？因为语法转换只是将高版本的语法转换成低版本的，但是新的内置函数、实例方法无法转换。这时，就需要使用 polyfill 上场了，顾名思义，polyfill 的中文意思是垫片，所谓垫片就是垫平不同浏览器或者不同环境下的差异，让新的内置函数、实例方法等在低版本浏览器中也可以使用。")]),a("h4",[s._v("Polyfill")]),a("p",[s._v("@babel-polyfill 模块包括 core-js 和一个自定义的 regenerator runtime 模块，可以模拟完整的 ES2015+ 环境（不包含第 4 阶段前的提议）。 这意味着可以使用诸如 Promise 和 WeakMap 之类的新的内置组件、 Array.from 或 Object.assign 之类的静态方法、Array.prototype.includes 之类的实例方法以及生成器函数(前提是使用了 @babel/plugin-transform-regenerator 插件)。为了添加这些功能，polyfill 将添加到全局范围和类似 String 这样的内置原型中(会对全局环境造成污染，后面我们会介绍不污染全局环境的方法)。 补充说明 (2020/01/07)：V7.4.0 版本开始，@babel/polyfill 已经被废弃(前端发展日新月异)，需单独安装 core-js 和 regenerator-runtime 模块。")]),a("p",[s._v("首先，安装 @babel/polyfill 依赖:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install --save @babel/polyfill\n")])]),a("p",[s._v("注意：不使用 --save-dev，因为这是一个需要在源码之前运行的垫片。")]),a("p",[s._v("我们需要将完整的 polyfill 在代码之前加载，修改我们的 src/index.js:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/polyfill'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" isHas = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v("@babel/polyfill 需要在其它代码之前引入，我们也可以在 webpack 中进行配置。")]),a("p",[s._v("例如:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("entry")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./polyfills'")]),s._v("), path."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./index'")]),s._v(")]\n")])]),a("p",[s._v("polyfills.js 文件内容如下:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//当然，还可能有一些其它的 polyfill，例如 stage 4之前的一些 polyfill")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/polyfill'")]),s._v("\n")])]),a("p",[s._v("现在，我们的代码不管在低版本还是高版本浏览器(或 node 环境)中都能正常运行了。不过，很多时候，"),a("strong",[s._v("我们未必需要完整的 @babel/polyfill")]),s._v("，这会导致我们最终构建出的包的体积增大，@babel/polyfill 的包大小为 89K (当前 @babel/polyfill 版本为 7.7.0)。")]),a("p",[a("strong",[s._v("我们更期望的是，如果我使用了某个新特性，再引入对应的 polyfill，避免引入无用的代码")])]),a("p",[s._v("值得庆幸的是， Babel 已经考虑到了这一点。")]),a("p",[s._v('@babel/preset-env 提供了一个 useBuiltIns 参数，设置值为 usage 时，就只会包含代码需要的 polyfill 。有一点需要注意：配置此参数的值为 usage ，必须要同时设置 corejs (如果不设置，会给出警告，默认使用的是"corejs": 2) ，注意: 这里仍然需要安装 @babel/polyfill(当前 @babel/polyfill 版本默认会安装 "corejs": 2):')]),a("p",[s._v("首先说一下使用 core-js@3 的原因，core-js@2 分支中已经不会再添加新特性，新特性都会添加到 core-js@3。例如你使用了 Array.prototype.flat()，如果你使用的是 core-js@2，那么其不包含此新特性。为了可以使用更多的新特性，建议大家使用 core-js@3")]),a("p",[s._v("安装依赖依赖：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install --save core-js@3\n")])]),a("blockquote",[a("p",[a("a",{attrs:{href:"https://github.com/zloirock/core-js"}},[s._v("core-js (点击了解更多)")]),s._v(" : JavaScript 的模块化标准库，包含 Promise、Symbol、Iterator 和许多其他的特性，它可以让你仅加载必需的功能。")])]),a("p",[s._v("现在，修改 Babel 的配置文件如下:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//.babelrc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" presets = [["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/env'")]),s._v(", { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("useBuiltIns")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'usage'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("corejs")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(" }]]\n")])]),a("p",[s._v("Babel 会检查所有代码，以便查找在目标环境中缺失的功能，然后仅仅把需要的 polyfill 包含进来。")]),a("p",[s._v("例如，src/index.js 代码不变：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" isHas = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v("我们看看编译出来的文件(lib/index):")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'use strict'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.array.includes'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.object.to-string'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.promise'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" isHas = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" p = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v("同样的代码，我们用 webpack 构建一下(production 模式)，能看到最终的代码大小仅为: 20KB。而如果我们引入整个 @babel/polyfill 的话，构建出的包大小为：89KB")]),a("p",[s._v('前面曾提到，在 useBuiltIns 参数值为 usage 时，仍然需要安装 @babel/polyfill，虽然我们上面的代码转换中看起来并没有使用到，但是，如果我们源码中使用到了 async/await，那么编译出来的代码需要 require("regenerator-runtime/runtime")，在 @babel/polyfill 的依赖中，当然啦，你也可以只安装 regenerator-runtime/runtime 取代安装 @babel/polyfill。')]),a("p",[a("strong",[s._v("下面我要说的内容，也许你已经知道，也许你还不知道，这都不重要，但是此刻起，你要知道了: Babel 会使用很小的辅助函数来实现类似 _createClass 等公共方法。默认情况下，它将被添加(inject)到需要它的每个文件中")])]),a("p",[s._v("假如，我们的 src/index.js 是这样的:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("constructor")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("x, y")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("x")]),s._v(" = x\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("y")]),s._v(" = y\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getX")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("x")]),s._v("\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" cp = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ColorPoint")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("25")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v(")\n")])]),a("p",[s._v("编译出来的 lib/index.js，如下所示:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'use strict'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.object.define-property'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_classCallCheck")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("instance, Constructor")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (!(instance "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("instanceof")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v(")) {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("TypeError")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'Cannot call a class as a function'")]),s._v(")\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_defineProperties")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("target, props")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" i = "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v("; i < props."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("length")]),s._v("; i++) {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" descriptor = props[i]\n\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("enumerable")]),s._v(" = descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("enumerable")]),s._v(" || "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n\t\tdescriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("configurable")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'value'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("in")]),s._v(" descriptor) descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("writable")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Object")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("defineProperty")]),s._v("(target, descriptor."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("key")]),s._v(", descriptor)\n\t}\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_createClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("Constructor, protoProps, staticProps")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (protoProps) "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_defineProperties")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("prototype")])]),s._v(", protoProps)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (staticProps) "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_defineProperties")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v(", staticProps)\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Constructor")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*#__PURE__*/")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Point")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("x, y")]),s._v(") {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_classCallCheck")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("x")]),s._v(" = x\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("y")]),s._v(" = y\n\t}\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_createClass")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(", [\n\t\t{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("key")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'getX'")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getX")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("x")]),s._v("\n\t\t\t}\n\t\t}\n\t])\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v("\n})()\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" cp = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ColorPoint")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("25")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v(")\n")])]),a("p",[s._v("看起来，似乎并没有什么问题，但是你想一下，如果你有 10 个文件中都使用了这个 class，是不是意味着 _classCallCheck、_defineProperties、_createClass 这些方法被 inject 了 10 次。这显然会导致包体积增大，最关键的是，我们并不需要它 inject 多次。")]),a("p",[s._v("这个时候，就是 @babel/plugin-transform-runtime 插件大显身手的时候了，使用 @babel/plugin-transform-runtime 插件，所有帮助程序都将引用模块 @babel/runtime，"),a("strong",[s._v("这样就可以避免编译后的代码中出现重复的帮助程序，有效减少包体积")])]),a("h4",[s._v("@babel/plugin-transform-runtime")]),a("ul",[a("li",[s._v("节省代码体积")]),a("li",[s._v("避免变量全局污染")])]),a("p",[s._v("@babel/plugin-transform-runtime 是一个可以重复使用 Babel 注入的帮助程序，以节省代码大小的插件")]),a("blockquote",[a("p",[s._v("注意：诸如 Array.prototype.flat() 等实例方法将不起作用，因为这需要修改现有的内置函数(可以使用 @babel/polyfill 来解决这个问题) ——> 对此需要说明的是如果你配置的是 corejs3， core-js@3 现在已经支持原型方法，同时不污染原型。")])]),a("p",[s._v("另外，@babel/plugin-transform-runtime 需要和 @babel/runtime 配合使用。")]),a("p",[s._v("首先安装依赖，@babel/plugin-transform-runtime 通常仅在开发时使用，但是运行时最终代码需要依赖 @babel/runtime，所以 @babel/runtime 必须要作为生产依赖被安装，如下 :")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install --save-dev @babel/plugin-transform-runtime\nnpm install --save @babel/runtime\n")])]),a("p",[s._v("除了前文所说的，@babel/plugin-transform-runtime 可以减少编译后代码的体积外，我们使用它还有一个好处，它可以为代码创建一个沙盒环境，如果使用 @babel/polyfill 及其提供的内置程序（例如 Promise ，Set 和 Map ），则它们将污染全局范围。虽然这对于应用程序或命令行工具可能是可以的，但是如果你的代码是要发布供他人使用的库，或者无法完全控制代码运行的环境，则将成为一个问题。")]),a("p",[s._v("@babel/plugin-transform-runtime 会将这些内置别名作为 core-js 的别名，因此您可以无缝使用它们，而无需 polyfill")]),a("p",[s._v("修改 .babelrc 的配置，如下:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//.babelrc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"useBuiltIns"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"usage"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-runtime"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("重新编译 npm run compiler , 现在，编译出来的内容为(lib/index.js):")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'use strict'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _interopRequireDefault = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/runtime/helpers/interopRequireDefault'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _classCallCheck2 = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_interopRequireDefault")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/runtime/helpers/classCallCheck'")]),s._v("))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _createClass2 = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_interopRequireDefault")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/runtime/helpers/createClass'")]),s._v("))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/*#__PURE__*/")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("Point")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("x, y")]),s._v(") {\n\t\t;("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", _classCallCheck2."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("default")]),s._v(")("),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(")\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("x")]),s._v(" = x\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("y")]),s._v(" = y\n\t}\n\t;("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", _createClass2."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("default")]),s._v(")("),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v(", [\n\t\t{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("key")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'getX'")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("value")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("getX")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("this")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("x")]),s._v("\n\t\t\t}\n\t\t}\n\t])\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Point")]),s._v("\n})()\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" cp = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("ColorPoint")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("25")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("8")]),s._v(")\n")])]),a("p",[s._v("可以看出，帮助函数现在不是直接被 inject 到代码中，而是从 @babel/runtime 中引入。前文说了使用 @babel/plugin-transform-runtime 可以避免全局污染，我们来看看是如何避免污染的。")]),a("p",[s._v("修改 src/index.js 如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" isHas = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-function"}},[s._v("("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v("编译出来的代码如下(lib/index.js):")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'use strict'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.array.includes'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.object.to-string'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'core-js/modules/es.promise'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" isHas = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("includes")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-title class_"}},[s._v("Promise")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v("Array.prototype 上新增了 includes 方法，并且新增了全局的 Promise 方法，污染了全局环境，这跟不使用 @babel/plugin-transform-runtime 没有区别嘛。")]),a("p",[a("strong",[s._v("如果我们希望 @babel/plugin-transform-runtime 不仅仅处理帮助函数，同时也能加载 polyfill 的话，我们需要给 @babel/plugin-transform-runtime 增加配置信息。")])]),a("p",[s._v("首先新增依赖 @babel/runtime-corejs3:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[s._v("npm install @babel/runtime-corejs3 --save\n")])]),a("p",[s._v("修改配置文件如下(移除了 @babel/preset-env 的 useBuiltIns 的配置，不然不就重复了嘛嘛嘛，不信的话，你用 async/await 编译下试试咯):")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-transform-runtime"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"corejs"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("然后重新编译，看一下，编译出来的结果(lib/index.js):")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'use strict'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _interopRequireDefault = "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/runtime-corejs3/helpers/interopRequireDefault'")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _promise = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_interopRequireDefault")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/runtime-corejs3/core-js-stable/promise'")]),s._v("))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _includes = "),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("_interopRequireDefault")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/runtime-corejs3/core-js-stable/instance/includes'")]),s._v("))\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" _context\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("var")]),s._v(" isHas = ("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", _includes."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("default")]),s._v(")((_context = ["),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("1")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("3")]),s._v("]))."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("call")]),s._v("(_context, "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(")\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" _promise."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("default")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("resolve")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("100")]),s._v(")\n})\n")])]),a("p",[s._v('可以看出，没有直接去修改 Array.prototype，或者是新增 Promise 方法，避免了全局污染。如果上面 @babel/plugin-transform-runtime 配置的 core-js 是 "2"，其中不包含实例的 polyfill 需要单独引入。')]),a("blockquote",[a("p",[s._v("划重点：如果我们配置的 corejs 是 3 版本，那么不管是实例方法还是全局方法，都不会再污染全局环境。")])]),a("p",[s._v("看到这里，不知道大家有没有这样一个疑问？给 @babel/plugin-transform-runtime 配置 corejs 是如此的完美，既可以将帮助函数变成引用的形式，又可以动态引入 polyfill，并且不会污染全局环境。何必要给 @babel/preset-env 提供 useBuiltIns 功能呢，看起来似乎不需要呀。")]),a("p",[s._v("带着这样的疑问，我新建了几个文件(内容简单且基本一致，使用了些新特性)，然后使用 webpack 构建，以下是我对比的数据:")]),a("table",[a("thead",[a("tr",[a("th",[s._v("序号")]),a("th",[s._v(".babelrc 配置")]),a("th",[s._v("webpack mode production")])])]),a("tbody",[a("tr",[a("td",[s._v("0")]),a("td",[s._v("不使用 @babel/plugin-transform-runtime")]),a("td",[s._v("36KB")])]),a("tr",[a("td",[s._v("1")]),a("td",[s._v("使用@babel/plugin-transform-runtime，并配置参数 corejs: 3。不会污染全局环境")]),a("td",[s._v("37KB")])]),a("tr",[a("td",[s._v("2")]),a("td",[s._v("使用@babel/plugin-transform-runtime，不配置 corejs")]),a("td",[s._v("22KB")])])])]),a("h3",[s._v("插件/预设补充知识")]),a("h4",[s._v("插件执行顺序")]),a("p",[a("strong",[s._v("插件的排列顺序很重要！！！")]),s._v(" 如果两个转换插件都将处理“程序（Program）”的某个代码片段，则将根据转换插件或 preset 的排列顺序依次执行。")]),a("ul",[a("li",[s._v("插件在 Presets 前运行。")]),a("li",[s._v("插件顺序从前往后排列。")]),a("li",[s._v("Preset 顺序是颠倒的（从后往前）")])]),a("p",[s._v("例如:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-proposal-class-properties"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/plugin-syntax-dynamic-import"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("先执行 @babel/plugin-proposal-class-properties，后执行 @babel/plugin-syntax-dynamic-import")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-react"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("preset 的执行顺序是颠倒的，先执行 @babel/preset-react， 后执行 @babel/preset-env")]),a("h4",[s._v("插件的短名称")]),a("p",[s._v("如果插件名称为 @babel/plugin-XXX，可以使用短名称@babel/XXX :")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/transform-arrow-functions"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//同 "@babel/plugin-transform-arrow-functions"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("如果插件名称为 babel-plugin-XXX，可以使用短名称 XXX，该规则同样适用于带有 scope 的插件:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"newPlugin"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//同 "babel-plugin-newPlugin"')]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@scp/myPlugin"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('//同 "@scp/babel-plugin-myPlugin"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("h4",[s._v("创建 Preset")]),a("p",[s._v("可以简单的返回一个插件数组")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'A'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'B'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'C'")]),s._v("]\n\t}\n}\n")])]),a("p",[s._v("preset 中也可以包含其他的 preset，以及带有参数的插件。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}}),s._v(") {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("presets")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/preset-env'")]),s._v(")],\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": [\n\t\t\t["),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/plugin-proposal-class-properties'")]),s._v("), { "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("loose")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(" }],\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'@babel/plugin-proposal-object-rest-spread'")]),s._v(")\n\t\t]\n\t}\n}\n")])]),a("h3",[s._v("配置文件")]),a("p",[s._v("Babel 支持多种格式的配置文件。这部分内容补充了解下即可，谁管你用哪种配置文件，只要你的配置是 OK 的就可以了(敷衍)~")]),a("p",[s._v("所有的 Babel API 参数都可以被配置，但是如果该参数需要使用的 JS 代码，那么可能需要使用 JS 代码版的配置文件。")]),a("p",[a("strong",[s._v("根据使用场景可以选择不同的配置文件:")])]),a("p",[s._v("如果希望以编程的方式创建配置文件或者希望编译 node_modules 目录下的模块：那么 babel.config.js 可以满足你的需求。")]),a("p",[s._v("如果只是需要一个简单的并且中用于单个软件包的配置：那么 .babelrc 即可满足你的需求。")]),a("h4",[s._v("babel.config.js")]),a("p",[s._v("在项目根目录下创建一个名为 babel.config.js 的文件。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("api")]),s._v(") {\n\tapi."),a("span",{pre:!0,attrs:{class:"hljs-title function_"}},[s._v("cache")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(")\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" presets = []\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" plugins = []\n\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" { presets, plugins }\n}\n")])]),a("p",[s._v("具体的配置可以查看："),a("a",{attrs:{href:"https://www.babeljs.cn/docs/config-files#project-wide-configuration"}},[s._v("babel.config.js 文档")])]),a("h4",[s._v(".babelrc")]),a("p",[s._v("在项目根目录下创建一个名为 .babelrc 的文件：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("具体的配置可以参考 "),a("a",{attrs:{href:"https://www.babeljs.cn/docs/config-files#file-relative-configuration"}},[s._v(".babelrc 文档")])]),a("h4",[s._v("package.json")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"my-package"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"babel"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("h4",[s._v(".babelrc.js")]),a("p",[s._v("与 .babelrc 配置相同，但是可以使用 JS 编写。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//可以在其中调用 Node.js 的API")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" presets = []\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" plugins = []\n\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = { presets, plugins }\n")])]),a("h3",[s._v("babel-upgrade")]),a("p",[a("a",{attrs:{href:"https://github.com/babel/babel-upgrade"}},[s._v("升级 6->7")]),s._v(" 在提到删除 stage-x 时候提过这个工具，它的目的是帮助用户自动化地从 babel 6 升级到 7。")]),a("p",[s._v("这款升级工具的功能包括：(这里并不列出完整列表，只列出比较重要和常用的内容)")]),a("ol",[a("li",[s._v("package.json")])]),a("ul",[a("li",[s._v("把依赖(和开发依赖)中所有的 babel-_ 替换为 _"),a("em",[s._v("at__babel/")])]),a("li",[s._v("把这些 @babel/* 依赖的版本更新为最新版 (例如 ^7.0.0)")]),a("li",[s._v("如果 scripts 中有使用 babel-node，自动添加 @babel/node 为开发依赖")]),a("li",[s._v("如果有 babel 配置项，检查其中的 plugins 和 presets，把短名 (env) 替换为完整的名字 (@babel/preset-env)")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v(".babelrc")])]),a("ul",[a("li",[s._v("检查其中的 plugins 和 presets，把短名 (env) 替换为完整的名字 (@babel/preset-env)")]),a("li",[s._v("检查是否包含 preset-stage-x，如有替换为对应的插件并添加到 plugins")])]),a("p",[s._v("使用方式如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-bash"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# 不安装到本地而是直接运行命令，npm 的新功能")]),s._v("\nnpx babel-upgrade --write\n\n"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("# 或者常规方式")]),s._v("\nnpm i babel-upgrade -g\nbabel-upgrade --write\n")])]),a("h3",[s._v("babel-loader")]),a("p",[s._v("已经介绍过了 babel-cli。但一些大型的项目都会有构建工具 (如 webpack 或 rollup) 来进行代码构建和压缩 (uglify)。理论上来说，我们也可以对压缩后的代码进行 babel 处理，但那会非常慢。因此如果在 uglify 之前就加入 babel 处理，岂不完美？")]),a("p",[s._v("所以就有了 babel 插入到构建工具内部这样的需求。以(我还算熟悉的) webpack 为例，webpack 有 loader 的概念，因此就出现了 babel-loader。")]),a("p",[s._v("和 babel-cli 一样，babel-loader 也会读取 .babelrc 或者 package.json 中的 babel 段作为自己的配置，之后的内核处理也是相同。唯一比 babel-cli 复杂的是，它需要和 webpack 交互，因此需要在 webpack 这边进行配置。比较常见的如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("module")]),s._v(": {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": [\n\t\t{\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("test")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/\\.js$/")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("exclude")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-regexp"}},[s._v("/(node_modules|bower_components)/")]),s._v(",\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("loader")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'babel-loader'")]),s._v("\n\t\t}\n\t]\n}\n")])]),a("p",[s._v("如果想在这里传入 babel 的配置项，也可以把改成：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// loader: 'babel-loader' 改成如下：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("use")]),s._v(": {\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("loader")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'babel-loader'")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("options")]),s._v(": {\n    "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 配置项在这里")]),s._v("\n  }\n}\n")])]),a("h3",[s._v("Babel 7.x")]),a("p",[s._v("最近 babel 发布了 7.0。因为上面部分都是针对 6.x 编写的，所以我们关注一下 7.0 带来的变化(核心机制方面没有变化，插件，preset，解析转译生成这些都没有变化)")]),a("p",[s._v("我只挑选一些和开发者关系比较大的列在这里，省略的多数是针对某一个 plugin 的改动。完整的列表可以参考官网。")]),a("h4",[s._v("preset 的变更：淘汰 es201x，删除 stage-x，强推 env (重点)")]),a("p",[s._v("淘汰 es201x 的目的是把选择环境的工作交给 env 自动进行，而不需要开发者投入精力。凡是使用 es201x 的开发者，都应当使用 env 进行替换。但这里的淘汰 (原文 deprecated) 并不是删除，只是不推荐使用了，不好说 babel 8 就真的删了。")]),a("p",[s._v("与之相比，stage-x 就没那么好运了，它们直接被删了。这是因为 babel 团队认为为这些 “不稳定的草案” 花费精力去更新 preset 相当浪费。stage-x 虽然删除了，但它包含的插件并没有删除(只是被更名了，可以看下面一节)，我们依然可以显式地声明这些插件来获得等价的效果。"),a("a",{attrs:{href:"https://github.com/babel/babel/tree/master/packages/babel-preset-stage-0#babelpreset-stage-0"}},[s._v("完整列表")])]),a("p",[s._v("为了减少开发者替换配置文件的机械工作，babel 开发了一款 babel-upgrade 的"),a("a",{attrs:{href:"https://github.com/babel/babel-upgrade"}},[s._v("工具")]),s._v("，它会检测 babel 配置中的 stage-x 并且替换成对应的 plugins。除此之外它还有其他功能，我们一会儿再详细看。(总之目的就是让你更加平滑地迁移到 babel 7)")]),a("p",[s._v("npm package 名称的变化 (重点) 这是 babel 7 的一个重大变化，把所有 babel-_ 重命名为 @babel/_，例如：")]),a("ol",[a("li",[s._v("babel-cli 变成了 @babel/cli。")]),a("li",[s._v("babel-preset-env 变成了 @babel/preset-env。进一步，还可以省略 preset 而简写为 @babel/env。")]),a("li",[s._v("babel-plugin-transform-arrow-functions 变成了 @babel/plugin-transform-arrow-functions。和 preset 一样，plugin 也可以省略，于是简写为 @babel/transform-arrow-functions")])]),a("p",[s._v("这个变化不单单应用于 package.json 的依赖中，包括 .babelrc 的配置 (plugins, presets) 也要这么写，为了保持一致。例如")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("[")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v('// "env" 变成 "@babel/preset-env"')]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"@babel/preset-env"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("顺带提一句，上面提过的 babel 解析语法的内核 babylon 现在重命名为 @babel/parser，看起来是被收编了")]),a("p",[s._v("上文提过的 stage-x 被删除了，它包含的插件虽然保留，但也被重命名了。babel 团队希望更明显地区分已经位于规范中的插件 (如 es2015 的 babel-plugin-transform-arrow-functions) 和仅仅位于草案中的插件 (如 stage-0 的 @babel/plugin-proposal-function-bind)。方式就是在名字中增加 proposal，所有包含在 stage-x 的转译插件都使用了这个前缀，语法插件不在其列")]),a("p",[s._v("最后，如果插件名称中包含了规范名称 (-es2015-, -es3- 之类的)，一律删除。例如 babel-plugin-transform-es2015-classes 变成了 @babel/plugin-transform-classes。(这个插件我自己没有单独用过，惭愧)")]),a("p",[s._v("参考链接")]),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/tugenhua0707/p/9452471.html"}},[s._v("龙恩0707 深入浅出的webpack构建工具---babel之配置文件.babelrc")]),a("a",{attrs:{href:"https://www.babeljs.cn/docs/"}},[s._v("babel 文档")])]),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/cbd48919a0cc"}},[s._v("babel 7 的使用的个人理解")])]),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6844903743121522701"}},[s._v("一口(很长的)气了解 babel")])]),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/sefaultment/p/11631314.html"}},[s._v("core-js@3 带来的惊喜")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},f7f2:function(s,t,a){"use strict";a.r(t);var r={product:{hello:"hello英文"}};t["default"]=r},f82e:function(s,t,a){s.exports=a.p+"img/bbbdcab.a883218f.png"},fa7b:function(s,t,a){s.exports=a.p+"img/5fcacbb5e77.6f0b26cb.png"},fbb4:function(s,t,a){"use strict";a.r(t),t["default"]=[]},fc0e:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,r=s._self._c||t;return r("section",[r("html",[r("head"),r("body",[r("h1",[s._v("DNS 协议解析")]),r("h2",[s._v("什么是 DNS 协议")]),r("p",[s._v("在学习 DNS 协议之前，我们先区分一下域名和 IP 地址这个两个概念：")]),r("ul",[r("li",[s._v("IP 地址：一长串能够唯一地标记网络上的计算机的数字")]),r("li",[s._v("域名：又称网域，是由一串用点分隔的名字组成的 Internet 上某一台计算机或计算机组的名称，用于在数据传输时对计算机的定位标识（有时也指地理位置）比如 www.baidu.com")])]),r("blockquote",[r("p",[s._v("不知道有没有同学会混淆域名和网址的概念，可以这样理解，网址里面含有域名。举个例子：www.gitee.com/veal98 就是一个网址，而 www.gitee.com 就是域名")])]),r("p",[s._v("由于 IP 地址具有不方便记忆并且不能显示地址组织的名称和性质等缺点，人们设计出了域名，并通过域名解析协议（DNS，Domain Name System）来将域名和 IP 地址相互映射，使人更方便地访问互联网，而不用去记住能够被机器直接读取的 IP 地址数串。将域名映射成 IP 地址称为正向解析，将 IP 地址映射成域名称为反向解析。")]),r("p",[s._v("DNS 协议可以使用 UDP 或者 TCP 进行传输，使用的端口号都为 53。但大多数情况下 DNS 都使用 UDP 进行传输。")]),r("h2",[s._v("域名详解")]),r("p",[s._v("全世界域名的最高管理机构，是一个叫做 ICANN （Internet Corporation for Assigned Names and Numbers）的组织，总部在美国加州。ICANN 负责管理全世界域名系统的运作。")]),r("p",[s._v("域名其实是具有一定的层次结构的，从上到下依次为：根域名、顶级域名（top level domain，TLD）、二级域名、（三级域名）")]),r("p",[r("img",{attrs:{src:a("9a5b"),alt:"域名"}})]),r("h3",[s._v("顶级域名")]),r("p",[s._v("即最高层级的域名。简单说，就是网址的最后一个部分。比如，网址www.baidu.com 的顶级域名就是 .com。ICANN 的一项主要工作，就是规定哪些字符串可以当作顶级域名。截至 2015 年 7 月，顶级域名共有 1058 个，它们大致可以分成两类：")]),r("ul",[r("li",[s._v("一类是通用顶级域名（gTLD），比如.com、.net、.edu、.org、.xxx 等等，共有 700 多个。")]),r("li",[s._v("另一类是国家顶级域名（ccTLD），代表不同的国家和地区，比如.cn（中国）、.io（英属印度洋领地）、.cc（ 科科斯群岛）、.tv（图瓦卢）等，共有 300 多个。")])]),r("p",[s._v("当然，ICANN 自己不会去管理这些顶级域名，因为根本管不过来。想想看，顶级域名有 1000 多个，每个顶级域名下面都有许多批发商，如果每个都要管，就太麻烦了。ICANN 的政策是，每个顶级域名都找一个托管商，该域名的所有事项都由托管商负责。ICANN 只与托管商联系，这样管理起来就容易多了。举例来说，.cn 国家顶级域名的托管商就是中国互联网络信息中心（CNNIC），它决定了 .cn 域名的各种政策。")]),r("h3",[s._v("二级域名")]),r("p",[s._v("而二级域名(Second Level Domain,SLD) 在通用顶级域名或国家顶级域名之下具有不同的意义：")]),r("ul",[r("li",[s._v("通用顶级域名下的二级域名：一般是指域名注册人选择使用的网上名称，如 yahoo.com（商业组织通常使用自己的商标、商号或其他商业标志作为自己的网上名称，如 baidu.com）")]),r("li",[s._v("国家顶级域名下的二级域名：一般是指类似于通用顶级域名的表示注册人类别和功能的标志。例如，在 .com.cn 域名结构中，.com 此时是置于国家顶级域名 .cn 下的二级域名，表示中国的商业性组织，以此类推")])]),r("h3",[s._v("三级域名")]),r("p",[s._v("形如 www.baidu.com 的域名，可以当做是二级域名的子域名，特征为域名包含两个 .。对于域名所有者/使用者而言，三级域名都是二级域名的附属物而无需单独费用。三级域名甚至不能称为域名，一般称之为域名下的 “二级目录”。")]),r("h3",[s._v("根域名")]),r("p",[s._v("那么根域名在哪里呢？在层次结构中根域名不是最顶级的吗？域名中怎么没有看见它？")]),r("p",[s._v("由于 ICANN 管理着所有的顶级域名，所以它是最高一级的域名节点，被称为根域名（root domain）。在有些场合，www.xxx.com 被写成 www.xxx.com.，即最后还会多出一个点。这个点就是根域名。")]),r("p",[r("img",{attrs:{src:a("a697"),alt:"根域名"}})]),r("p",[s._v("理论上，所有域名的查询都必须先查询根域名，因为只有根域名才能告诉你，某个顶级域名由哪台服务器管理。事实上也确实如此，ICANN 维护着一张列表（根域名列表），里面记载着顶级域名和对应的托管商。")]),r("p",[r("img",{attrs:{src:a("ca0a"),alt:"根域名列表"}})]),r("p",[s._v("比如，我要访问 abc.xyz，也必须先去询问根域名列表，它会告诉我 .xyz 域名由 CentralNic 公司托管。根域名列表还记载，.google 由谷歌公司托管，.apple 由苹果公司托管等等。")]),r("p",[s._v("由于根域名列表很少变化，大多数 DNS 服务商都会提供它的缓存，所以根域名的查询事实上不是那么频繁。")]),r("h2",[s._v("域名服务器详解")]),r("p",[s._v("域名服务器是指管理域名的主机和相应的软件，它可以管理所在分层的域的相关信息。一个域名服务器所负责管里的分层叫作 区 (ZONE)。域名的每层都设有一个域名服务器：")]),r("ul",[r("li",[s._v("根域名服务器")]),r("li",[s._v("顶级域名服务器")]),r("li",[s._v("权限域名服务器")])]),r("p",[r("img",{attrs:{src:a("ef25"),alt:"域名服务器"}})]),r("p",[s._v("除了上面三种 DNS 服务器，还有一种不在 DNS 层次结构之中，但是很重要的 DNS 服务器，即本地域名服务器。下面我们分别讲解这四种服务器都是用来干什么的")]),r("h3",[s._v("根域名服务器")]),r("p",[s._v("上面我们提到，ICANN 维护着一张根域名列表，里面记载着顶级域名和对应的托管商，其实根域名列表的正式名称是 DNS 根区（DNS root zone），保存 DNS 根区文件的服务器，就叫做 DNS 根域名服务器（root name server）。根域名服务器保存所有的顶级域名服务器的地址")]),r("p",[s._v("由于早期的 DNS 查询结果是一个 512 字节的 UDP 数据包。这个包最多可以容纳 13 个服务器的地址，因此就规定全世界有 13 个根域名服务器，编号从 a.root-servers.net 一直到 m.root-servers.net。其中 10 台设置在美国，另外各有一台设置于荷兰、瑞典和日本。")]),r("p",[s._v("前面我们说过，理论上所有域名的查询都必须先查询根域名，所以一般来说所有的域名服务器都会注册一份根域名服务器的 IP 地址的缓存，用于在必要的时候向其发送请求。")]),r("h3",[s._v("顶级域名服务器")]),r("p",[s._v("按照根域名服务器管理顶级域名的逻辑，顶级域名服务器显然就是用来管理注册在该顶级域名下的所有二级域名的，记录这些二级域名的 IP 地址。")]),r("h3",[s._v("权限域名服务器")]),r("p",[s._v("按照上面的逻辑，权限域名服务器应该是管理注册在二级域名下的所有三/四级域名的，但其实不是这样，如果一个二级域名或者一个三/四级域名对应一个域名服务器，则域名服务器数量会很多，我们需要使用划分区的办法来解决这个问题。那么权限域名服务器就是负责管理一个“区”的域名服务器。")]),r("p",[s._v("什么是区？怎样划分区呢？")]),r("p",[s._v("区和域其实是不同的，区可以有多种不同的划分方法。以百度为例，我们假设有 fanyi.baidu.com、ai.baidu.com、tieba.baidu.com 这三个三级域名。我们可以这样分区，fanyi.baidu.com 和 tieba.baidu.com 放在 baidu.com 权限域名服务器，ai.baidu.com 放在 ai.baidu.com 权限域名服务器中。并且 baidu.com 权限域名服务器和 ai.baidu.com 权限域名服务器是同等地位的，而具体怎么分区是百度公司根据域名多少、访问多少等情况去自己规定的。")]),r("p",[r("img",{attrs:{src:a("0012"),alt:"区域"}})]),r("h3",[s._v("本地域名服务器")]),r("p",[s._v("除了上面三种 DNS 服务器，还有一种不在 DNS 层次结构之中，但是很重要的 DNS 服务器，就是本地域名服务器（也被称为权威域名服务器）。本地域名服务器是电脑解析时的默认域名服务器，即电脑中设置的首选 DNS 服务器和备选 DNS 服务器。常见的有电信、联通、谷歌、阿里等的本地 DNS 服务。")]),r("p",[r("img",{attrs:{src:a("ab3c"),alt:"本地域名服务器"}})]),r("p",[s._v("每个因特网服务提供者或一所大学，甚至一所大学中的各个系，都可以拥有一个本地域名服务器。当一台主机发出 DNS 查询请求时，这个查询请求报文就发送给该主机的本地域名服务器。本地域名服务器管理本地域名的解析和映射，并且能够向上级域名服务器进行查询。")]),r("h2",[s._v("DNS 查询方式")]),r("p",[s._v("具体 DNS 查询的方式有两种：")]),r("ul",[r("li",[s._v("递归查询")]),r("li",[s._v("迭代查询")])]),r("p",[s._v("所谓递归就是，如果请求的接收者不知道所请求的内容，那么接收者将扮演请求者，发出有关请求，直到获得所需要的内容，然后将内容返回给最初的请求者。")]),r("p",[s._v("通俗点来说，在递归查询中，如果 A 请求 B，那么 B 作为请求的接收者一定要给 A 想要的答案；而迭代查询则是指，如果接收者 B 没有请求者 A 所需要的准确内容，接收者 B 将告诉请求者 A，如何去获得这个内容，但是自己并不去发出请求。")]),r("p",[s._v("一般来说，域名服务器之间的查询使用迭代查询方式，以免根域名服务器的压力过大。通过下面这两个图就能很好的理解了")]),r("h3",[s._v("递归查询")]),r("p",[r("img",{attrs:{src:a("32aa"),alt:"递归查询"}})]),r("h3",[s._v("迭代查询")]),r("p",[r("img",{attrs:{src:a("8a14"),alt:"迭代查询"}})]),r("h2",[s._v("域名缓存")]),r("p",[s._v("上面讲解的是域名服务器之间的 DNS 查询请求过程，但实际上，每个时刻都有无数网民要上网，那每次都去访问本地域名服务器去获取 IP 地址显然是不实际的。解决方法就是使用缓存保存域名和 IP 地址的映射。")]),r("p",[s._v("计算机中 DNS 记录在本地有两种缓存方式：浏览器缓存和操作系统缓存。")]),r("p",[s._v("1）浏览器缓存：浏览器在获取网站域名的实际 IP 地址后会对其进行缓存，减少网络请求的损耗。每种浏览器都有一个固定的 DNS 缓存时间，如 Chrome 的过期时间是 1 分钟，在这个期限内不会重新请求 DNS")]),r("p",[s._v("2）操作系统缓存：操作系统的缓存其实是用户自己配置的 hosts 文件。比如 Windows10 下的 hosts 文件存放在 C:\\Windows\\System32\\drivers\\etc\\hosts")]),r("p",[r("img",{attrs:{src:a("569f"),alt:"操作系统缓存"}})]),r("p",[s._v("Windows 系统默认开启 DNS 缓存服务，服务名是 DNSClient，可以缓存一些常用的域名")]),r("p",[r("img",{attrs:{src:a("6a6a"),alt:"DNS 缓存服务"}})]),r("p",[s._v("使用命令 ipconfig -displaydns 可以查看电脑中缓存的域名")]),r("p",[r("img",{attrs:{src:a("8a22"),alt:"电脑中缓存的域名"}})]),r("p",[s._v("在浏览器中进行访问的时候，会优先查询浏览器缓存，如果未命中则继续查询操作系统缓存，最后再查询本地域名服务器，然后本地域名服务器会递归的查找域名记录，最后返回结果。主机和本地域名服务器之间的查询方式是递归查询，也就是说主机请求本地域名服务器，那么本地域名服务器作为请求的接收者一定要给主机想要的答案。")]),r("h2",[s._v("完整域名解析过程")]),r("p",[s._v("将我们上面所说的域名服务器之间的 DNS 查询请求过程和域名缓存结合起来，就是一个完整的 DNS 协议进行域名解析的过程。这里我们以正向解析为例（域名解析成 IP 地址）：")]),r("p",[s._v("1）首先搜索浏览器的 DNS 缓存，缓存中维护一张域名与 IP 地址的对应表；")]),r("p",[s._v("2）若没有命中，则继续搜索操作系统的 DNS 缓存；")]),r("p",[s._v("3）若仍然没有命中，则操作系统将域名发送至本地域名服务器，本地域名服务器查询自己的 DNS 缓存，查找成功则返回结果（注意：主机和本地域名服务器之间的查询方式是递归查询）")]),r("p",[s._v("4）若本地域名服务器的 DNS 缓存没有命中，则本地域名服务器向上级域名服务器进行查询，通过以下方式进行迭代查询（注意：本地域名服务器和其他域名服务器之间的查询方式是迭代查询，防止根域名服务器压力过大）：")]),r("ul",[r("li",[s._v("首先本地域名服务器向根域名服务器发起请求，根域名服务器是最高层次的，它并不会直接指明这个域名对应的 IP 地址，而是返回顶级域名服务器的地址，也就是说给本地域名服务器指明一条道路，让他去这里寻找答案")]),r("li",[s._v("本地域名服务器拿到这个顶级域名服务器的地址后，就向其发起请求，获取权限域名服务器的地址")]),r("li",[s._v("本地域名服务器根据权限域名服务器的地址向其发起请求，最终得到该域名对应的 IP 地址")])]),r("p",[s._v("4）本地域名服务器将得到的 IP 地址返回给操作系统，同时自己将 IP 地址缓存起来")]),r("p",[s._v("5）操作系统将 IP 地址返回给浏览器，同时自己也将 IP 地址缓存起来")]),r("p",[s._v("6）至此，浏览器就得到了域名对应的 IP 地址，并将 IP 地址缓存起来")]),r("p",[r("img",{attrs:{src:a("d36b"),alt:"域名解析过程"}})])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},fc29:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement;s._self._c;return s._m(0)},e=[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("section",[a("html",[a("head"),a("body",[a("h1",[s._v("配置 eslint")]),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/kingsm/p/14129035.html"}},[s._v("从零开始 eslint")])]),a("p",[a("a",{attrs:{href:"https://juejin.cn/post/6859291468138774535"}},[s._v("Eslint 中 plugins 和 extends 的区别")])]),a("p",[a("a",{attrs:{href:"https://github.com/yannickcr/eslint-plugin-react/blob/master/index.js"}},[s._v("eslint-plugin-react")])]),a("p",[s._v("它的目标是提供一个插件化的 javascript"),a("strong",[s._v("代码检测工具")])]),a("p",[s._v("使用方法：")]),a("ol",[a("li",[s._v("Configuration Comments(注释配置) - 使用 JavaScript 注释把配置信息直接嵌入到一个代码源文件中。")]),a("li",[s._v("Configuration Files(文件配置) - 使用 JavaScript、JSON 或者 YAML 文件为整个目录（处理你的主目录）和它的子目录指定配置信息。可以配置一个独立的，可以配置一个独立的 .eslintrc.* 文件，或者直接在 package.json 文件里的 eslintConfig 字段指定配置，ESLint 会查找和自动读取它们，再者，你可以在命令行运行时指定一个任意的配置文件。")])]),a("p",[s._v("如果项目目录下有多个配置文件，ESLint 只会使用一个，优先级为：.eslintrc.js > .eslintrc > package.json，一般我们都是在 .eslintrc.js 配置。")]),a("p",[s._v('同时，如果配置文件里没有"root": true 这个属性，ESLint 就会继续向外寻找配置文件，直到找到有"root": true 的为止，所有这些配置文件的规则都会被层叠应用。若有重复的属性配置，则离文件更近的配置文件具有更高的优先级。')]),a("p",[s._v("当想要所有项目都遵循一个特定的约定时会很有用，但还是建议给项目根目录的.eslintrc.js 加上 root: true")]),a("blockquote",[a("p",[s._v("在 vscode 扩展程序中安装 eslint 扩展，并且启用扩展")])]),a("h2",[s._v("Specifying Parser Options（指定解释器选项）")]),a("p",[s._v("ESLint 允许你指定你想要支持的 JavaScript "),a("strong",[s._v("语言选项")]),s._v("。默认情况下，ESLint 支持 ECMAScript 5 语法。你可以覆盖该设置，以启用对 ECMAScript 其它版本和 JSX 的支持。")]),a("p",[s._v("请注意，支持 JSX 语法并不等同于支持 React。React 对 ESLint 无法识别的 JSX 语法应用特定的语义。如果你正在使用 React 并且想要 React 语义支持，我们建议你使用 eslint-plugin-react。")]),a("p",[s._v('同样的，支持 ES6 语法并不意味着同时支持新的 ES6 全局变量或类型（比如 Set 等新类型）。对于 ES6 语法，使用 { "parserOptions": { "ecmaVersion": 6 } }；对于新的 ES6 全局变量，使用 { "env":{ "es6": true } }. { "env": { "es6": true } } 自动启用 es6 语法，但 { "parserOptions": { "ecmaVersion": 6 } } 不自动启用 es6 全局变量。')]),a("p",[s._v("解析器选项可以在 .eslintrc.* 文件使用 parserOptions 属性设置。可用的选项有：")]),a("ul",[a("li",[a("p",[s._v("ecmaVersion - 默认设置为 3，5（默认）， 你可以使用 6、7、8、9 或 10 来指定你想要使用的 ECMAScript 版本。你也可以用使用年份命名的版本号指定为 2015（同 6），2016（同 7），或 2017（同 8）或 2018（同 9）或 2019 (same as 10)")])]),a("li",[a("p",[s._v('sourceType - 设置为 "script" (默认) 或 "module"（如果你的代码是 ECMAScript 模块)。')])]),a("li",[a("p",[s._v("ecmaFeatures - 这是个对象，表示你想使用的额外的语言特性:")]),a("ul",[a("li",[s._v("globalReturn - 允许在全局作用域下使用 return 语句")]),a("li",[s._v("impliedStrict - 启用全局 strict mode (如果 ecmaVersion 是 5 或更高)")]),a("li",[s._v("jsx - 启用 JSX")]),a("li",[s._v("experimentalObjectRestSpread - 启用实验性的 object rest/spread properties 支持。(重要：这是一个实验性的功能,在未来可能会有明显改变。 建议你写的规则 不要 依赖该功能，除非当它发生改变时你愿意承担维护成本。)")])]),a("p",[s._v(".eslintrc.json 文件示例：")])])]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"parserOptions"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"ecmaVersion"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"sourceType"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"module"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"ecmaFeatures"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"jsx"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("true")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"rules"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"semi"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("h2",[s._v("Specifying Parser （指定解释器）")]),a("p",[s._v("ESLint 默认使用 Espree 作为其解析器，你可以在配置文件中指定一个不同的解析器，只要该解析器符合下列要求：")]),a("ul",[a("li",[s._v("它必须是一个 Node 模块，可以从它出现的配置文件中加载。通常，这意味着应该使用 npm 单独安装解析器包。")]),a("li",[s._v("它必须符合 parser interface。 注意，即使满足这些兼容性要求，也不能保证一个外部解析器可以与 ESLint 正常配合工作，ESLint 也不会修复与其它解析器不兼容的相关 bug。")])]),a("p",[s._v("为了表明使用该 npm 模块作为你的解析器，你需要在你的 .eslintrc 文件里指定 parser 选项。例如，下面的配置指定了 Esprima 作为解析器：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"parser"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"esprima"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"rules"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"semi"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v('"error"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("p",[s._v("以下解析器与 ESLint 兼容：")]),a("ul",[a("li",[s._v("Esprima")]),a("li",[s._v("Babel-ESLint - 一个对 Babel 解析器的包装，使其能够与 ESLint 兼容。")]),a("li",[s._v("@typescript-eslint/parser - 将 TypeScript 转换成与 estree 兼容的形式，以便在 ESLint 中使用。")])]),a("blockquote",[a("p",[s._v("注意，在使用自定义解析器时，为了让 ESLint 在处理非 ECMAScript 5 特性时正常工作，配置属性 parserOptions 仍然是必须的。解析器会被传入 parserOptions，但是不一定会使用它们来决定功能特性的开关。")])]),a("h2",[s._v("Specifying Processor (指定处理器)")]),a("p",[s._v("插件可以提供处理器。处理器可以从另一种文件中提取 JavaScript 代码，然后让 ESLint 检测 JavaScript 代码。或者处理器可以在预处理中转换 JavaScript 代码。")]),a("p",[s._v("当我们需要为一些非 js 文件类型执行 eslint 规则的检查时，需要为这些文件类型指定一个解析器，解析器可以用来将非 js 类型的文件转换成为可以被 eslint parser 所识别的语法，但是 processor 不能作为独立的配置项在使用，必须放在 plugins 中。例如想要对 json 文件像 js 文件一样使用 eslint 规则检查，需要使用一个 plugin，plugin 中需要导出固定的内容。看一下 eslint-plugin-json-processor 的实现。")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("processors")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'.json'")]),s._v(": {\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("preprocess")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),a("span",{pre:!0,attrs:{class:"hljs-params"}},[s._v("text, filename")]),s._v(") {\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" [{ "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("text")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("`("),a("span",{pre:!0,attrs:{class:"hljs-subst"}},[s._v("${text}")]),s._v(")`")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("filename")]),s._v(": filename }]\n\t\t\t},\n\n\t\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("supportsAutofix")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("false")]),s._v("\n\t\t}\n\t}\n}\n")])]),a("p",[s._v("eslint 在执行的过程中会根据 processors 的 key 进行匹配，如果跟所要检查的文件后缀相同，则会执行对应的解析器。")]),a("p",[s._v("如果需要使用 eslint-plugin-json-processor 需要按照如下的方式:")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-json-processor'")]),s._v("],\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("quotes")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'error'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'single'")]),s._v("]\n\t}\n}\n")])]),a("p",[s._v("这样就会对 json 文件中的引号起到检查作用。")]),a("h2",[s._v("Specifying Globals (指定全局变量)")]),a("p",[s._v("当访问当前源文件内未定义的变量时（例如 window），no-undef 规则将发出警告。如果你想在一个源文件里使用全局变量，推荐你在 ESLint 中定义这些全局变量，这样 ESLint 就不会发出警告了。你可以使用注释或在配置文件中定义全局变量。如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 如果我们在文件中使用了 window")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("window")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("appName")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'myApp'")]),s._v("\n")])]),a("p",[s._v("此时 eslint 会报出如下错误 "),a("code",{pre:!0},[s._v("error 'window' is not defined no-undef")]),s._v(" 如果在这种场景下需要绕过 eslint 检查，可以在 globals 配置中允许使用 window")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// .eslintrc.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("globals")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("window")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v("\n\t}\n}\n")])]),a("p",[s._v("这样就可以绕过对 window 的检查")]),a("h2",[s._v("Specifying Environments (指定环境 env)")]),a("p",[s._v("有时候在文件中可能需要针对某一类的全局变量绕过检查，例如我们编写的代码时运行在浏览器环境中，常常会使用 window、document 这一类的全局变量，除了可以一个一个在 globals 中进行允许之外，还可以在 env 配置中设置某一个或某几个环境变量。下面列出一些常用的的环境类型，更多完整的可以在官方文档中查看，常用的有如下：")]),a("table",[a("thead",[a("tr",[a("th",[s._v("env")]),a("th",[s._v("说明")])])]),a("tbody",[a("tr",[a("td",[s._v("browser")]),a("td",[s._v("允许使用浏览器环境中的全局变量，如：window、document")])]),a("tr",[a("td",[s._v("node")]),a("td",[s._v("允许使用 node 环境中的全局变量，如：global、module")])]),a("tr",[a("td",[s._v("jquery")]),a("td",[s._v("允许使用 jquery 全局变量，如：$、jQuery")])])])]),a("p",[s._v("可以在源文件里、在配置文件中或使用 命令行 的 --env 选项来指定环境。")]),a("p",[s._v("要在你的 JavaScript 文件中使用注释来指定环境，格式如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("/* eslint-env node, mocha */")]),s._v("\n")])]),a("p",[s._v("该设置启用了 Node.js 和 Mocha 环境。")]),a("p",[s._v("在配置文件里指定环境")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-json"}},[a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"env"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"browser"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(",")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v('"node"')]),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("true")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-punctuation"}},[s._v("}")]),s._v("\n")])]),a("h2",[s._v("rules")]),a("p",[s._v("通过 rules 可以灵活地控制 eslint 的检查内容，在完成 eslint 安装之后，eslint 已经提供了很多内置的规则，可以根据实际项目的需要自定义是否选用这些规则。规则的设置有三个级别：")]),a("ul",[a("li",[s._v("error or 2: 开启指定规则，检查会抛出错误，并且会打断检查进程的继续执行")]),a("li",[s._v("warn or 1: 开启指定规则，检查会抛出警告，不会打断检查进程的继续执行")]),a("li",[s._v("off or 0: 关闭指定规则")])]),a("p",[s._v("对于规则除了可以设置错误级别之外，还能通过一些额外配置对规则进行自定义的控制")]),a("p",[s._v("例如 eslint 内置对引号检查的规则可以设置不同的值：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// .eslintrc.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// quotes: ['error', 'signle', {avoidEscape: true}]")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("quotes")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'error'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'signle'")]),s._v("]\n\t}\n}\n")])]),a("p",[s._v("从上面的实例中可以看到 quotes 这个规则可以除了设置错误级别 error 之外，还有两个配置项，第一个配置项是一个 string，可选值如下：")]),a("ul",[a("li",[s._v("single: 单引号 'single'")]),a("li",[s._v('double: 双引号 "double"')]),a("li",[s._v("backtick: 反引号 `backtick`")])]),a("p",[s._v("第二个配置项是一个对象，一共有两个属性:")]),a("ul",[a("li",[s._v("avoidEscape：布尔值，true 表示如果存在字符串嵌套的情况下最外层的引号允许使用单引号或者双引号，默认值为 false")]),a("li",[s._v("allowTemplateLiterals：布尔值，true 表示允许使用反引号")])]),a("p",[a("a",{attrs:{href:"https://eslint.org/docs/rules/"}},[s._v("在这里你可以查找到所有的 eslint 内置规则")])]),a("h2",[s._v("plugins")]),a("p",[s._v("plugin 插件主要是为 eslint 新增一些检查规则，包含一组 rules 规则，plugin内部可能包含 config 配置，config 配置主要是用来配置 extends 例如")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("export")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react/recommended'")]),s._v("]\n}\n")])]),a("p",[s._v("eslint-plugin-react "),a("a",{attrs:{href:"https://github.com/yannickcr/eslint-plugin-react/blob/master/index.js"}},[s._v("源文件")]),s._v("大概如下，可以看到其中就包括了 rules:allRules 和 configs")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// eslint-plugin-react")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" allRules = {\n  "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'boolean-prop-naming'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./lib/rules/boolean-prop-naming'")]),s._v("),\n  "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'button-has-type'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-built_in"}},[s._v("require")]),s._v("("),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'./lib/rules/button-has-type'")]),s._v("),\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 等等")]),s._v("\n}\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n  deprecatedRules,\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// rules 规则")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": allRules,\n  "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// config 配置")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("configs")]),s._v(": {\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("recommended")]),s._v(": {\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": [\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v(",\n      ],\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("parserOptions")]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("ecmaFeatures")]),s._v(": {\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jsx")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n        },\n      },\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react/display-name'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react/jsx-key'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react/jsx-no-comment-textnodes'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 等等")]),s._v("\n      },\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("all")]),s._v(": {\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": [\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v(",\n      ],\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("parserOptions")]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("ecmaFeatures")]),s._v(": {\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jsx")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n        },\n      },\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": activeRulesConfig,\n    },\n    "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'jsx-runtime'")]),s._v(": {\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": [\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react'")]),s._v(",\n      ],\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("parserOptions")]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("ecmaFeatures")]),s._v(": {\n          "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jsx")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n        },\n        "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("jsxPragma")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", "),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// for @typescript/eslint-parser")]),s._v("\n      },\n      "),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react/react-in-jsx-scope'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'react/jsx-uses-react'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("0")]),s._v(",\n      },\n    },\n  },\n};\n")])]),a("p",[s._v("若要选择 eslint-plugin-react 中的一条配置到.eslintrc.js 的 rules 中则可以如下处理才生效")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("//\t.eslintrc.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("exports")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react'")]),s._v("],\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// eslint-plugin-react/boolean-prop-naming 加载的是module.exports对象下面的rules")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 跟config里面rules没有任何关系")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react/boolean-prop-naming'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("\n\t}\n}\n")])]),a("h2",[s._v("extends")]),a("p",[s._v("extends 主要是一个配置对象，相当于一个已经配置好的.eslintrc.js 例如使用 eslint-plugin-react 中config下面的 recommended 配置下，写法如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("export")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react/recommended'")]),s._v("]\n}\n")])]),a("p",[s._v("可以同时使用 eslint-plugin-react 中的 config 和 module.exports 对象下面的 rules， 如下：")]),a("pre",{pre:!0},[a("code",{pre:!0,attrs:{"v-pre":"",class:"language-js"}},[a("span",{pre:!0,attrs:{class:"hljs-variable language_"}},[s._v("module")]),s._v("."),a("span",{pre:!0,attrs:{class:"hljs-property"}},[s._v("export")]),s._v(" = {\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 配置插件")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("plugins")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react'")]),s._v("],\n\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用插件eslint-plugin-react中的recommended 配置")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("extends")]),s._v(": ["),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react/recommended'")]),s._v("],\n\t"),a("span",{pre:!0,attrs:{class:"hljs-attr"}},[s._v("rules")]),s._v(": {\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-comment"}},[s._v("// 使用插件eslint-plugin-react中的一条规则")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"hljs-string"}},[s._v("'eslint-plugin-react/boolean-prop-naming'")]),s._v(": "),a("span",{pre:!0,attrs:{class:"hljs-number"}},[s._v("2")]),s._v("\n\t}\n}\n")])])])])])}],n=a("2877"),l={},p=Object(n["a"])(l,r,e,!1,null,null,null);t["default"]=p.exports},fdab:function(s,t,a){"use strict";a.r(t);var r=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"hello"},[a("el-button",{attrs:{type:"primary"},on:{click:s.dom}},[s._v("xiazai")])],1)},e=[],n=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),{name:"HelloWorld",methods:{dom:function(){var s="http://www.perfect99.com/upload_2015/Default_FocusPhoto/2021-1-11-6da99ec8-e236-44e5-a975-48cf030126de.jpg",t="测试图片";function a(s,t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var s=document.createElement("canvas");s.width=a.width,s.height=a.height;var r=s.getContext("2d");r.drawImage(a,0,0,a.width,a.height),s.toBlob((function(s){var a=URL.createObjectURL(s),r=document.createElement("a");r.download=t||"photo",r.href=a,r.click(),r.remove(),URL.revokeObjectURL(a)}))},a.src=s}a(s,t)}}}),l=n,p=a("2877"),_=Object(p["a"])(l,r,e,!1,null,"1e93c00a",null);t["default"]=_.exports}},[[0,"runtime","chunk-elementUI","chunk-libs"]]]);